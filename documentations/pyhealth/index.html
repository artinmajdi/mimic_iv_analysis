<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

<meta property="og:title" content="PyHealth" />
  
<meta property="og:type" content="website" />
  
<meta property="og:url" content="https://pyhealth.readthedocs.io/en/latest/index.html" />
  
<meta property="og:description" content="Welcome to PyHealth!: PyPI version Documentation status GitHub stars GitHub forks Downloads Tutorials YouTube PyHealth is designed for both ML researchers and medical practitioners. We can make you..." />
  
<meta property="og:image" content="https://pyhealth.readthedocs.io/en/latest/pyhealth_logos/_static/pyhealth-logo.png" />
  
<meta property="og:image:alt" content="PyHealth" />
  <link rel="author" title="About these documents" href="#" /><link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" />

    <!-- Generated with Sphinx 5.2.3 and Furo 2023.03.27 -->
        <title>PyHealth</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="_static/css/override.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/sphinx_gallery.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-brand-primary: #003262;
  --color-brand-content: #003262;
  --admonition-font-size: var(--font-size-normal);
  --admonition-title-font-size: var(--font-size-normal);
  --code-font-size: var(--font-size--small);
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="#"><div class="brand">PyHealth</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="#">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="_static/pyhealth-logo.png" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-install">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-tutorials">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-advance_tutorials">Advanced Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="index.html#document-api/data">Data</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/data/pyhealth.data.Event">pyhealth.data.Event</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/data/pyhealth.data.Patient">pyhealth.data.Patient</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="index.html#document-api/datasets">Datasets</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/datasets/pyhealth.datasets.BaseDataset">pyhealth.datasets.BaseDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/datasets/pyhealth.datasets.SampleDataset">pyhealth.datasets.SampleDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/datasets/pyhealth.datasets.MIMIC3Dataset">pyhealth.datasets.MIMIC3Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/datasets/pyhealth.datasets.MIMIC4Dataset">pyhealth.datasets.MIMIC4Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/datasets/pyhealth.datasets.MedicalTranscriptionsDataset">pyhealth.datasets.MedicalTranscriptionsDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/datasets/pyhealth.datasets.CardiologyDataset">pyhealth.datasets.CardiologyDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/datasets/pyhealth.datasets.eICUDataset">pyhealth.datasets.eICUDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/datasets/pyhealth.datasets.ISRUCDataset">pyhealth.datasets.ISRUCDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/datasets/pyhealth.datasets.MIMICExtractDataset">pyhealth.datasets.MIMICExtractDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/datasets/pyhealth.datasets.OMOPDataset">pyhealth.datasets.OMOPDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/datasets/pyhealth.datasets.SHHSDataset">pyhealth.datasets.SHHSDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/datasets/pyhealth.datasets.SleepEDFDataset">pyhealth.datasets.SleepEDFDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/datasets/pyhealth.datasets.TUABDataset">pyhealth.datasets.TUABDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/datasets/pyhealth.datasets.TUEVDataset">pyhealth.datasets.TUEVDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/datasets/pyhealth.datasets.splitter">pyhealth.datasets.splitter</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/datasets/pyhealth.datasets.utils">pyhealth.datasets.utils</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="index.html#document-api/tasks">Tasks</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.BaseTask">pyhealth.tasks.BaseTask</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.Readmission30DaysMIMIC4">pyhealth.tasks.Readmission30DaysMIMIC4</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.InHospitalMortalityMIMIC4">pyhealth.tasks.EEG_evInHospitalMortalityMIMIC4ents</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.MIMIC3ICD9Coding">pyhealth.tasks.MIMIC3ICD9Coding</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.cardiology_detect">pyhealth.tasks.cardiology_detect</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.COVID19CXRClassification">pyhealth.tasks.COVID19CXRClassification</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.drug_recommendation">pyhealth.tasks.drug_recommendation</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.EEG_abnormal">pyhealth.tasks.EEG_abnormal</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.EEG_events">pyhealth.tasks.EEG_events</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.length_of_stay_prediction">pyhealth.tasks.length_of_stay_prediction</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.MedicalTranscriptionsClassification">pyhealth.tasks.MedicalTranscriptionsClassification</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.mortality_prediction">pyhealth.tasks.mortality_prediction</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.patient_linkage_mimic3_fn">pyhealth.tasks.patient_linkage_mimic3_fn</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.readmission_prediction">pyhealth.tasks.readmission_prediction</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.sleep_staging">pyhealth.tasks.sleep_staging</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.SleepStagingSleepEDF">pyhealth.tasks.SleepStagingSleepEDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.temple_university_EEG_tasks">pyhealth.tasks.temple_university_EEG_tasks</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="index.html#document-api/models">Models</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.BaseModel">pyhealth.models.BaseModel</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.MLP">pyhealth.models.MLP</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.CNN">pyhealth.models.CNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.RNN">pyhealth.models.RNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.GNN">pyhealth.models.GNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.Transformer">pyhealth.models.Transformer</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.TransformersModel">pyhealth.models.TransformersModel</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.RETAIN">pyhealth.models.RETAIN</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.GAMENet">pyhealth.models.GAMENet</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.MICRON">pyhealth.models.MICRON</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.SafeDrug">pyhealth.models.SafeDrug</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.MoleRec">pyhealth.models.MoleRec</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.Deepr">pyhealth.models.Deepr</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.ContraWR">pyhealth.models.ContraWR</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.SparcNet">pyhealth.models.SparcNet</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.StageNet">pyhealth.models.StageNet</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.AdaCare">pyhealth.models.AdaCare</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.ConCare">pyhealth.models.ConCare</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.Agent">pyhealth.models.Agent</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.GRASP">pyhealth.models.GRASP</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.MedLink">pyhealth.models.MedLink</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.TCN">pyhealth.models.TCN</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.GAN">pyhealth.models.GAN</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.VAE">pyhealth.models.VAE</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-api/trainer">Trainer</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-api/tokenizer">Tokenizer</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="index.html#document-api/metrics">Metrics</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/metrics/pyhealth.metrics.multiclass">pyhealth.metrics.multiclass</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/metrics/pyhealth.metrics.multilabel">pyhealth.metrics.multilabel</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/metrics/pyhealth.metrics.binary">pyhealth.metrics.binary</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/metrics/pyhealth.metrics.calibration">[core] calibration</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/metrics/pyhealth.metrics.prediction_set">[core] prediction_set</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/metrics/pyhealth.metrics.fairness">pyhealth.metrics.fairness</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-api/medcode">MedCode</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="index.html#document-api/calib">Calibration and Uncertainty Quantification</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/calib/pyhealth.calib.calibration">pyhealth.calib.calibration</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/calib/pyhealth.calib.predictionset">pyhealth.calib.predictionset</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Additional Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-live">PyHealth Webinar 4/9/25</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-log">Development logs</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-about">About us</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="welcome-to-pyhealth">
<h1>Welcome to PyHealth!<a class="headerlink" href="#welcome-to-pyhealth" title="Permalink to this heading">#</a></h1>
<div class="admonition important">
<p class="admonition-title">Important</p>
<ul class="simple">
<li><p><strong>Join our PyHealth Discord Community!</strong> We are actively looking for contributors and want to get to know our users better! <a class="reference external" href="https://discord.gg/mpb835EHaX">Click here to join Discord</a></p></li>
<li><p><strong>Signup for our mailing list!</strong> We will email any significant PyHealth changes that are soon to come! <a class="reference external" href="https://docs.google.com/forms/d/e/1FAIpQLSfpJB5tdkI7BccTCReoszV9cyyX2rF99SgznzwlOepi5v-xLw/viewform?usp=header">Click here to subscribe</a></p></li>
</ul>
</div>
<a class="reference external image-reference" href="https://pypi.org/project/pyhealth/"><img alt="PyPI version" src="https://img.shields.io/pypi/v/pyhealth.svg?color=brightgreen" /></a>
<a class="reference external image-reference" href="https://pyhealth.readthedocs.io/en/latest/"><img alt="Documentation status" src="https://readthedocs.org/projects/pyhealth/badge/?version=latest" /></a>
<a class="reference external image-reference" href="https://github.com/sunlabuiuc/pyhealth/stargazers"><img alt="GitHub stars" src="https://img.shields.io/github/stars/yzhao062/pyhealth.svg" /></a>
<a class="reference external image-reference" href="https://github.com/sunlabuiuc/pyhealth/network"><img alt="GitHub forks" src="https://img.shields.io/github/forks/yzhao062/pyhealth.svg?color=blue" /></a>
<a class="reference external image-reference" href="https://pepy.tech/project/pyhealth"><img alt="Downloads" src="https://static.pepy.tech/badge/pyhealth" /></a>
<a class="reference external image-reference" href="https://pyhealth.readthedocs.io/en/latest/tutorials.html"><img alt="Tutorials" src="https://img.shields.io/badge/Tutorials-Google%20Colab-red" /></a>
<a class="reference external image-reference" href="https://www.youtube.com/playlist?list=PLR3CNIF8DDHJUl8RLhyOVpX_kT4bxulEV"><img alt="YouTube" src="https://img.shields.io/badge/YouTube-16%20Videos-red" /></a>
<hr class="docutils" />
<p>PyHealth is designed for both <strong>ML researchers and medical practitioners</strong>. We can make your <strong>healthcare AI applications</strong> easier to develop, test and validate. Your development process becomes more flexible and more customizable. <a class="reference external" href="https://github.com/sunlabuiuc/PyHealth">[GitHub]</a></p>
<hr class="docutils" />
<blockquote>
<div><p><strong>[News!]</strong> We are continueously implemeting good papers and benchmarks into PyHealth, checkout the <a class="reference external" href="https://docs.google.com/spreadsheets/d/1PNMgDe-llOm1SM5ZyGLkmPysjC4wwaVblPLAHLxejTw/edit#gid=159213380">[Planned List]</a>. Welcome to pick one from the list and send us a PR or add more influential and new papers into the plan list.</p>
</div></blockquote>
<section id="introduction-video">
<h2>Introduction <a class="reference external" href="https://www.youtube.com/watch?v=1Ir6hzU4Nro&amp;list=PLR3CNIF8DDHJUl8RLhyOVpX_kT4bxulEV&amp;index=1">[Video]</a><a class="headerlink" href="#introduction-video" title="Permalink to this heading">#</a></h2>
<p>PyHealth can support <strong>diverse electronic health records (EHRs)</strong> such as MIMIC and eICU and all OMOP-CDM based databases and provide <strong>various advanced deep learning algorithms</strong> for handling <strong>important healthcare tasks</strong> such as diagnosis-based drug recommendation, patient hospitalization and mortality prediction, and ICU length stay forecasting, etc.</p>
<p><em>Build a healthcare AI pipeline can be as short as 10 lines of code in PyHealth</em>.</p>
</section>
<section id="modules">
<h2>Modules<a class="headerlink" href="#modules" title="Permalink to this heading">#</a></h2>
<p>All healthcare tasks in our package follow a <strong>five-stage pipeline</strong>:</p>
<blockquote>
<div><p>load dataset -&gt; define task function -&gt; build ML/DL model -&gt; model training -&gt; inference</p>
</div></blockquote>
<p>! We try hard to make sure each stage is as separate as possibe, so that people can customize their own pipeline by only using our data processing steps or the ML models. Each step will call one module and we introduce them using an example.</p>
<section id="an-ml-pipeline-example">
<h3>An ML Pipeline Example<a class="headerlink" href="#an-ml-pipeline-example" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>STEP 1: &lt;pyhealth.datasets&gt;</strong> provides a clean structure for the dataset, independent from the tasks. We support <code class="docutils literal notranslate"><span class="pre">MIMIC-III</span></code>, <code class="docutils literal notranslate"><span class="pre">MIMIC-IV</span></code> and <code class="docutils literal notranslate"><span class="pre">eICU</span></code>, as well as the standard <code class="docutils literal notranslate"><span class="pre">OMOP-formatted</span> <span class="pre">data</span></code>. The dataset is stored in a unified <code class="docutils literal notranslate"><span class="pre">Patient-Visit-Event</span></code> structure.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">MIMIC3Dataset</span>
<span class="n">mimic3base</span> <span class="o">=</span> <span class="n">MIMIC3Dataset</span><span class="p">(</span>
    <span class="n">root</span><span class="o">=</span><span class="s2">&quot;https://storage.googleapis.com/pyhealth/Synthetic_MIMIC-III/&quot;</span><span class="p">,</span>
    <span class="n">tables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;DIAGNOSES_ICD&quot;</span><span class="p">,</span> <span class="s2">&quot;PROCEDURES_ICD&quot;</span><span class="p">,</span> <span class="s2">&quot;PRESCRIPTIONS&quot;</span><span class="p">],</span>
    <span class="c1"># map all NDC codes to ATC 3-rd level codes in these tables</span>
    <span class="n">code_mapping</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;NDC&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;ATC&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;target_kwargs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;level&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}})},</span>
<span class="p">)</span>
</pre></div>
</div>
<p>User could also store their own dataset into our <code class="docutils literal notranslate"><span class="pre">&lt;pyhealth.datasets.SampleBaseDataset&gt;</span></code> structure and then follow the same pipeline below, see <a class="reference external" href="https://colab.research.google.com/drive/1UurxwAAov1bL_5OO3gQJ4gAa_paeJwJp?usp=sharing">Tutorial</a></p>
<ul class="simple">
<li><p><strong>STEP 2: &lt;pyhealth.tasks&gt;</strong> inputs the <code class="docutils literal notranslate"><span class="pre">&lt;pyhealth.datasets&gt;</span></code> object and defines how to process each patientâ€™s data into a set of samples for the tasks. In the package, we provide several task examples, such as <code class="docutils literal notranslate"><span class="pre">drug</span> <span class="pre">recommendation</span></code> and <code class="docutils literal notranslate"><span class="pre">length</span> <span class="pre">of</span> <span class="pre">stay</span> <span class="pre">prediction</span></code>.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">drug_recommendation_mimic3_fn</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">split_by_patient</span><span class="p">,</span> <span class="n">get_dataloader</span>

<span class="n">mimic3sample</span> <span class="o">=</span> <span class="n">mimic3base</span><span class="o">.</span><span class="n">set_task</span><span class="p">(</span><span class="n">task_fn</span><span class="o">=</span><span class="n">drug_recommendation_mimic3_fn</span><span class="p">)</span> <span class="c1"># use default task</span>
<span class="n">train_ds</span><span class="p">,</span> <span class="n">val_ds</span><span class="p">,</span> <span class="n">test_ds</span> <span class="o">=</span> <span class="n">split_by_patient</span><span class="p">(</span><span class="n">mimic3sample</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>

<span class="c1"># create dataloaders (torch.data.DataLoader)</span>
<span class="n">train_loader</span> <span class="o">=</span> <span class="n">get_dataloader</span><span class="p">(</span><span class="n">train_ds</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">val_loader</span> <span class="o">=</span> <span class="n">get_dataloader</span><span class="p">(</span><span class="n">val_ds</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">test_loader</span> <span class="o">=</span> <span class="n">get_dataloader</span><span class="p">(</span><span class="n">test_ds</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>STEP 3: &lt;pyhealth.models&gt;</strong> provides the healthcare ML models using <code class="docutils literal notranslate"><span class="pre">&lt;pyhealth.models&gt;</span></code>. This module also provides model layers, such as <code class="docutils literal notranslate"><span class="pre">pyhealth.models.RETAINLayer</span></code> for building customized ML architectures. Our model layers can used as easily as <code class="docutils literal notranslate"><span class="pre">torch.nn.Linear</span></code>.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Transformer</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Transformer</span><span class="p">(</span>
    <span class="n">dataset</span><span class="o">=</span><span class="n">mimic3sample</span><span class="p">,</span>
    <span class="n">feature_keys</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;conditions&quot;</span><span class="p">,</span> <span class="s2">&quot;procedures&quot;</span><span class="p">],</span>
    <span class="n">label_key</span><span class="o">=</span><span class="s2">&quot;drugs&quot;</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;multilabel&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>STEP 4: &lt;pyhealth.trainer&gt;</strong> is the training manager with <code class="docutils literal notranslate"><span class="pre">train_loader</span></code>, the <code class="docutils literal notranslate"><span class="pre">val_loader</span></code>, <code class="docutils literal notranslate"><span class="pre">val_metric</span></code>, and specify other arguemnts, such as epochs, optimizer, learning rate, etc. The trainer will automatically save the best model and output the path in the end.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.trainer</span><span class="w"> </span><span class="kn">import</span> <span class="n">Trainer</span>

<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">)</span>
<span class="n">trainer</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="n">train_dataloader</span><span class="o">=</span><span class="n">train_loader</span><span class="p">,</span>
    <span class="n">val_dataloader</span><span class="o">=</span><span class="n">val_loader</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">monitor</span><span class="o">=</span><span class="s2">&quot;pr_auc_samples&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>STEP 5: &lt;pyhealth.metrics&gt;</strong> provides several <strong>common evaluation metrics</strong> (refer to <a class="reference external" href="https://pyhealth.readthedocs.io/en/latest/api/metrics.html">Doc</a> and see what are available) and <strong>special metrics</strong> in healthcare, such as drug-drug interaction (DDI) rate.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">trainer</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_loader</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="medical-code-map">
<h3>Medical Code Map<a class="headerlink" href="#medical-code-map" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>&lt;pyhealth.codemap&gt;</strong> provides two core functionalities: (i) looking up information for a given medical code (e.g., name, category, sub-concept); (ii) mapping codes across coding systems (e.g., ICD9CM to CCSCM). <strong>This module can be independently applied to your research.</strong></p></li>
<li><p>For code mapping between two coding systems</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.medcode</span><span class="w"> </span><span class="kn">import</span> <span class="n">CrossMap</span>

<span class="n">codemap</span> <span class="o">=</span> <span class="n">CrossMap</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;ICD9CM&quot;</span><span class="p">,</span> <span class="s2">&quot;CCSCM&quot;</span><span class="p">)</span>
<span class="n">codemap</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="s2">&quot;82101&quot;</span><span class="p">)</span> <span class="c1"># use it like a dict</span>

<span class="n">codemap</span> <span class="o">=</span> <span class="n">CrossMap</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;NDC&quot;</span><span class="p">,</span> <span class="s2">&quot;ATC&quot;</span><span class="p">)</span>
<span class="n">codemap</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="s2">&quot;00527051210&quot;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>For code ontology lookup within one system</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.medcode</span><span class="w"> </span><span class="kn">import</span> <span class="n">InnerMap</span>

<span class="n">icd9cm</span> <span class="o">=</span> <span class="n">InnerMap</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;ICD9CM&quot;</span><span class="p">)</span>
<span class="n">icd9cm</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="s2">&quot;428.0&quot;</span><span class="p">)</span> <span class="c1"># get detailed info</span>
<span class="n">icd9cm</span><span class="o">.</span><span class="n">get_ancestors</span><span class="p">(</span><span class="s2">&quot;428.0&quot;</span><span class="p">)</span> <span class="c1"># get parents</span>
</pre></div>
</div>
</section>
<section id="medical-code-tokenizer">
<h3>Medical Code Tokenizer<a class="headerlink" href="#medical-code-tokenizer" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>&lt;pyhealth.tokenizer&gt;</strong> is used for transformations between string-based tokens and integer-based indices, based on the overall token space. We provide flexible functions to tokenize 1D, 2D and 3D lists. <strong>This module can be independently applied to your research.</strong></p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tokenizer</span><span class="w"> </span><span class="kn">import</span> <span class="n">Tokenizer</span>

<span class="c1"># Example: we use a list of ATC3 code as the token</span>
<span class="n">token_space</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A01A&#39;</span><span class="p">,</span> <span class="s1">&#39;A02A&#39;</span><span class="p">,</span> <span class="s1">&#39;A02B&#39;</span><span class="p">,</span> <span class="s1">&#39;A02X&#39;</span><span class="p">,</span> <span class="s1">&#39;A03A&#39;</span><span class="p">,</span> <span class="s1">&#39;A03B&#39;</span><span class="p">,</span> <span class="s1">&#39;A03C&#39;</span><span class="p">,</span> <span class="s1">&#39;A03D&#39;</span><span class="p">,</span> \
        <span class="s1">&#39;A03F&#39;</span><span class="p">,</span> <span class="s1">&#39;A04A&#39;</span><span class="p">,</span> <span class="s1">&#39;A05A&#39;</span><span class="p">,</span> <span class="s1">&#39;A05B&#39;</span><span class="p">,</span> <span class="s1">&#39;A05C&#39;</span><span class="p">,</span> <span class="s1">&#39;A06A&#39;</span><span class="p">,</span> <span class="s1">&#39;A07A&#39;</span><span class="p">,</span> <span class="s1">&#39;A07B&#39;</span><span class="p">,</span> <span class="s1">&#39;A07C&#39;</span><span class="p">,</span> \
        <span class="s1">&#39;A12B&#39;</span><span class="p">,</span> <span class="s1">&#39;A12C&#39;</span><span class="p">,</span> <span class="s1">&#39;A13A&#39;</span><span class="p">,</span> <span class="s1">&#39;A14A&#39;</span><span class="p">,</span> <span class="s1">&#39;A14B&#39;</span><span class="p">,</span> <span class="s1">&#39;A16A&#39;</span><span class="p">]</span>
<span class="n">tokenizer</span> <span class="o">=</span> <span class="n">Tokenizer</span><span class="p">(</span><span class="n">tokens</span><span class="o">=</span><span class="n">token_space</span><span class="p">,</span> <span class="n">special_tokens</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;&lt;pad&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;unk&gt;&quot;</span><span class="p">])</span>

<span class="c1"># 2d encode</span>
<span class="n">tokens</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;A03C&#39;</span><span class="p">,</span> <span class="s1">&#39;A03D&#39;</span><span class="p">,</span> <span class="s1">&#39;A03E&#39;</span><span class="p">,</span> <span class="s1">&#39;A03F&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;A04A&#39;</span><span class="p">,</span> <span class="s1">&#39;B035&#39;</span><span class="p">,</span> <span class="s1">&#39;C129&#39;</span><span class="p">]]</span>
<span class="n">indices</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">batch_encode_2d</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span> <span class="c1"># [[8, 9, 10, 11], [12, 1, 1, 0]]</span>

<span class="c1"># 2d decode</span>
<span class="n">indices</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="n">tokens</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">batch_decode_2d</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span> <span class="c1"># [[&#39;A03C&#39;, &#39;A03D&#39;, &#39;A03E&#39;, &#39;A03F&#39;], [&#39;A04A&#39;, &#39;&lt;unk&gt;&#39;, &#39;&lt;unk&gt;&#39;]]</span>
</pre></div>
</div>
<hr class="docutils" />
<p>Users can <strong>customize their healthcare AI pipeline</strong> as simply as calling one module</p>
<ul class="simple">
<li><p>process your OMOP data via <code class="docutils literal notranslate"><span class="pre">pyhealth.datasets</span></code></p></li>
<li><p>process the open eICU (e.g., MIMIC) data via <code class="docutils literal notranslate"><span class="pre">pyhealth.datasets</span></code></p></li>
<li><p>define your own task on existing databases via <code class="docutils literal notranslate"><span class="pre">pyhealth.tasks</span></code></p></li>
<li><p>use existing healthcare models or build upon it (e.g., RETAIN) via <code class="docutils literal notranslate"><span class="pre">pyhealth.models</span></code>.</p></li>
<li><p>code map between for conditions and medicaitons via <code class="docutils literal notranslate"><span class="pre">pyhealth.codemap</span></code>.</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="datasets">
<h2>Datasets<a class="headerlink" href="#datasets" title="Permalink to this heading">#</a></h2>
<p>We provide the following datasets for general purpose healthcare AI research:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Dataset</p></th>
<th class="head"><p>Module</p></th>
<th class="head"><p>Year</p></th>
<th class="head"><p>Information</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>MIMIC-III</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pyhealth.datasets.MIMIC3Dataset</span></code></p></td>
<td><p>2016</p></td>
<td><p><a class="reference external" href="https://physionet.org/content/mimiciii/1.4//">MIMIC-III Clinical Database</a></p></td>
</tr>
<tr class="row-odd"><td><p>MIMIC-IV</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pyhealth.datasets.MIMIC4Dataset</span></code></p></td>
<td><p>2020</p></td>
<td><p><a class="reference external" href="https://physionet.org/content/mimiciv/0.4/">MIMIC-IV Clinical Database</a></p></td>
</tr>
<tr class="row-even"><td><p>eICU</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pyhealth.datasets.eICUDataset</span></code></p></td>
<td><p>2018</p></td>
<td><p><a class="reference external" href="https://eicu-crd.mit.edu//">eICU Collaborative Research Database</a></p></td>
</tr>
<tr class="row-odd"><td><p>OMOP</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pyhealth.datasets.OMOPDataset</span></code></p></td>
<td></td>
<td><p><a class="reference external" href="https://www.ohdsi.org/data-standardization/the-common-data-model/">OMOP-CDM schema based dataset</a></p></td>
</tr>
<tr class="row-even"><td><p>SleepEDF</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pyhealth.datasets.SleepEDFDataset</span></code></p></td>
<td><p>2018</p></td>
<td><p><a class="reference external" href="https://physionet.org/content/sleep-edfx/1.0.0/">Sleep-EDF dataset</a></p></td>
</tr>
<tr class="row-odd"><td><p>SHHS</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pyhealth.datasets.SHHSDataset</span></code></p></td>
<td><p>2016</p></td>
<td><p><a class="reference external" href="https://sleepdata.org/datasets/shhs">Sleep Heart Health Study dataset</a></p></td>
</tr>
<tr class="row-even"><td><p>ISRUC</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pyhealth.datasets.ISRUCDataset</span></code></p></td>
<td><p>2016</p></td>
<td><p><a class="reference external" href="https://sleeptight.isr.uc.pt/?page_id=48">ISRUC-SLEEP dataset</a></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="machine-deep-learning-models">
<h2>Machine/Deep Learning Models<a class="headerlink" href="#machine-deep-learning-models" title="Permalink to this heading">#</a></h2>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Model Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Module</p></th>
<th class="head"><p>Year</p></th>
<th class="head"><p>Summary</p></th>
<th class="head"><p>Reference</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Multi-layer Perceptron</p></td>
<td><p>deep learning</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pyhealth.models.MLP</span></code></p></td>
<td><p>1986</p></td>
<td><p>MLP treats each feature as static</p></td>
<td><p><a class="reference external" href="https://www.taylorfrancis.com/books/mono/10.4324/9780203763247/backpropagation-yves-chauvin-david-rumelhart">Backpropagation: theory, architectures, and applications</a></p></td>
</tr>
<tr class="row-odd"><td><p>Convolutional Neural Network (CNN)</p></td>
<td><p>deep learning</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pyhealth.models.CNN</span></code></p></td>
<td><p>1989</p></td>
<td><p>CNN runs on the conceptual patient-by-visit grids</p></td>
<td><p><a class="reference external" href="https://proceedings.neurips.cc/paper/1989/file/53c3bce66e43be4f209556518c2fcb54-Paper.pdf">Handwritten Digit Recognition with a Back-Propagation Network</a></p></td>
</tr>
<tr class="row-even"><td><p>Recurrent Neural Nets (RNN)</p></td>
<td><p>deep Learning</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pyhealth.models.RNN</span></code></p></td>
<td><p>2011</p></td>
<td><p>RNN (includes LSTM and GRU) can run on any sequential level (e.g., visit by visit sequences)</p></td>
<td><p><a class="reference external" href="http://www.fit.vutbr.cz/research/groups/speech/servite/2010/rnnlm_mikolov.pdf">Recurrent neural network based language model</a></p></td>
</tr>
<tr class="row-odd"><td><p>Transformer</p></td>
<td><p>deep Learning</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pyhealth.models.Transformer</span></code></p></td>
<td><p>2017</p></td>
<td><p>Transformer can run on any sequential level (e.g., visit by visit sequences)</p></td>
<td><p><a class="reference external" href="https://arxiv.org/abs/1706.03762">Atention is All you Need</a></p></td>
</tr>
<tr class="row-even"><td><p>RETAIN</p></td>
<td><p>deep Learning</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pyhealth.models.RETAIN</span></code></p></td>
<td><p>2016</p></td>
<td><p>RETAIN uses two RNN to learn patient embeddings while providing feature-level and visit-level importance.</p></td>
<td><p><a class="reference external" href="https://arxiv.org/abs/1608.05745">RETAIN: An Interpretable Predictive Model for Healthcare using Reverse Time Attention Mechanism</a></p></td>
</tr>
<tr class="row-odd"><td><p>GAMENet</p></td>
<td><p>deep Learning</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pyhealth.models.GAMENet</span></code></p></td>
<td><p>2019</p></td>
<td><p>GAMENet uses memory networks, used only for drug recommendation task</p></td>
<td><p><a class="reference external" href="https://arxiv.org/abs/1809.01852">GAMENet: Graph Attention Mechanism for Explainable Electronic Health Record Prediction</a></p></td>
</tr>
<tr class="row-even"><td><p>MICRON</p></td>
<td><p>deep Learning</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pyhealth.models.MICRON</span></code></p></td>
<td><p>2021</p></td>
<td><p>MICRON predicts the future drug combination by instead predicting the changes w.r.t. the current combination, used only for drug recommendation task</p></td>
<td><p><a class="reference external" href="https://www.ijcai.org/proceedings/2021/0513">Change Matters: Medication Change Prediction with Recurrent Residual Networks</a></p></td>
</tr>
<tr class="row-odd"><td><p>SafeDrug</p></td>
<td><p>deep Learning</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pyhealth.models.SafeDrug</span></code></p></td>
<td><p>2021</p></td>
<td><p>SafeDrug encodes drug molecule structures by graph neural networks, used only for drug recommendation task</p></td>
<td><p><a class="reference external" href="https://arxiv.org/abs/2105.02711">SafeDrug: Dual Molecular Graph Encoders for Recommending Effective and Safe Drug Combinations</a></p></td>
</tr>
<tr class="row-even"><td><p>MoleRec</p></td>
<td><p>deep Learning</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pyhealth.models.MoleRec</span></code></p></td>
<td><p>2023</p></td>
<td><p>MoleRec encodes drug molecule in a substructure level as well as the patientâ€™s information into a drug combination representation, used only for drug recommendation task</p></td>
<td><p><a class="reference external" href="https://www.researchgate.net/publication/368454974_MoleRec_Combinatorial_Drug_Recommendation_with_Substructure-Aware_Molecular_Representation_Learning">MoleRec: Combinatorial Drug Recommendation with Substructure-Aware Molecular Representation Learning</a></p></td>
</tr>
<tr class="row-odd"><td><p>Deepr</p></td>
<td><p>deep Learning</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pyhealth.models.Deepr</span></code></p></td>
<td><p>2017</p></td>
<td><p>Deepr is based on 1D CNN. General purpose.</p></td>
<td><p><a class="reference external" href="https://arxiv.org/abs/1607.07519">Deepr : A Convolutional Net for Medical Records</a></p></td>
</tr>
<tr class="row-even"><td><p>ContraWR Encoder (STFT+CNN)</p></td>
<td><p>deep Learning</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pyhealth.models.ContraWR</span></code></p></td>
<td><p>2021</p></td>
<td><p>ContraWR encoder uses short time Fourier transform (STFT) + 2D CNN, used for biosignal learning</p></td>
<td><p><a class="reference external" href="https://arxiv.org/abs/2110.15278">Self-supervised EEG Representation Learning for Automatic Sleep Staging</a></p></td>
</tr>
<tr class="row-odd"><td><p>SparcNet (1D CNN)</p></td>
<td><p>deep Learning</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pyhealth.models.SparcNet</span></code></p></td>
<td><p>2023</p></td>
<td><p>SparcNet is based on 1D CNN, used for biosignal learning</p></td>
<td><p><a class="reference external" href="#">Development of Expert-level Classification of Seizures and Rhythmic and Periodic Patterns During EEG Interpretation</a></p></td>
</tr>
<tr class="row-even"><td><p>TCN</p></td>
<td><p>deep learning</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pyhealth.models.TCN</span></code></p></td>
<td><p>2018</p></td>
<td><p>TCN is based on dilated 1D CNN. General purpose</p></td>
<td><p><a class="reference external" href="https://arxiv.org/abs/1803.01271">Temporal Convolutional Networks</a></p></td>
</tr>
<tr class="row-odd"><td><p>AdaCare</p></td>
<td><p>deep learning</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pyhealth.models.AdaCare</span></code></p></td>
<td><p>2020</p></td>
<td><p>AdaCare uses CNNs with dilated filters to learn enriched patient embedding. It uses feature calibration module to provide the feature-level and visit-level interpretability</p></td>
<td><p><a class="reference external" href="https://arxiv.org/abs/1911.12205">AdaCare: Explainable Clinical Health Status Representation Learning via Scale-Adaptive Feature Extraction and Recalibration</a></p></td>
</tr>
<tr class="row-even"><td><p>ConCare</p></td>
<td><p>deep learning</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pyhealth.models.ConCare</span></code></p></td>
<td><p>2020</p></td>
<td><p>ConCare uses transformers to learn patient embedding and calculate inter-feature correlations.</p></td>
<td><p><a class="reference external" href="https://arxiv.org/abs/1911.12216">ConCare: Personalized Clinical Feature Embedding via Capturing the Healthcare Context</a></p></td>
</tr>
<tr class="row-odd"><td><p>StageNet</p></td>
<td><p>deep learning</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pyhealth.models.StageNet</span></code></p></td>
<td><p>2020</p></td>
<td><p>StageNet uses stage-aware LSTM to conduct clinical predictive tasks while learning patient disease progression stage change unsupervisedly</p></td>
<td><p><a class="reference external" href="https://arxiv.org/abs/2001.10054">StageNet: Stage-Aware Neural Networks for Health Risk Prediction</a></p></td>
</tr>
<tr class="row-even"><td><p>Dr. Agent</p></td>
<td><p>deep learning</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pyhealth.models.Agent</span></code></p></td>
<td><p>2020</p></td>
<td><p>Dr. Agent uses two reinforcement learning agents to learn patient embeddings by mimicking clinical second opinions</p></td>
<td><p><a class="reference external" href="https://academic.oup.com/jamia/article/27/7/1084/5858308">Dr. Agent: Clinical predictive model via mimicked second opinions</a></p></td>
</tr>
<tr class="row-odd"><td><p>GRASP</p></td>
<td><p>deep learning</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pyhealth.models.GRASP</span></code></p></td>
<td><p>2021</p></td>
<td><p>GRASP uses graph neural network to identify latent patient clusters and uses the clustering information to learn patient</p></td>
<td><p><a class="reference external" href="https://ojs.aaai.org/index.php/AAAI/article/view/16152">GRASP: Generic Framework for Health Status Representation Learning Based on Incorporating Knowledge from Similar Patients</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="toctree-wrapper compound">
<span id="document-install"></span><section id="installation">
<h3>Installation<a class="headerlink" href="#installation" title="Permalink to this heading">#</a></h3>
<p>You could install from PyPi:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>pyhealth
</pre></div>
</div>
<p>or from github source:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/sunlabuiuc/PyHealth.git
<span class="nb">cd</span><span class="w"> </span>pyhealth
pip<span class="w"> </span>install<span class="w"> </span>.
</pre></div>
</div>
<p><strong>Required Dependencies</strong>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python&gt;<span class="o">=</span><span class="m">3</span>.8
torch&gt;<span class="o">=</span><span class="m">1</span>.8.0
rdkit&gt;<span class="o">=</span><span class="m">2022</span>.03.4
scikit-learn&gt;<span class="o">=</span><span class="m">0</span>.24.2
networkx&gt;<span class="o">=</span><span class="m">2</span>.6.3
pandas&gt;<span class="o">=</span><span class="m">1</span>.3.2
tqdm
</pre></div>
</div>
<p><strong>Warning 1</strong>:</p>
<p>PyHealth has multiple neural network based models, e.g., LSTM, which are
implemented in PyTorch. However, PyHealth does <strong>NOT</strong> install these DL libraries for you.
This reduces the risk of interfering with your local copies.
If you want to use neural-net based models, please make sure PyTorch is installed.
Similarly, models depending on <strong>xgboost</strong> would <strong>NOT</strong> enforce xgboost installation by default.</p>
<p><strong>CUDA Setting</strong>:</p>
<p>To run PyHealth, you also need CUDA and cudatoolkit that support your GPU well. <a class="reference external" href="https://developer.nvidia.com/cuda-gpus/">More info</a></p>
<p>For example, if you use NVIDIA RTX A6000 as your GPU for training, you should install a compatible cudatoolkit using:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>install<span class="w"> </span>pytorch<span class="w"> </span>torchvision<span class="w"> </span>torchaudio<span class="w"> </span><span class="nv">cudatoolkit</span><span class="o">=</span><span class="m">11</span>.3<span class="w"> </span>-c<span class="w"> </span>pytorch.
</pre></div>
</div>
<hr class="docutils" />
</section>
<span id="document-tutorials"></span><section id="tutorials">
<h3>Tutorials<a class="headerlink" href="#tutorials" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>We provide the following tutorials to help users get started with our pyhealth.</p>
</div></blockquote>
<p><a class="reference external" href="https://colab.research.google.com/drive/1y9PawgSbyMbSSMw1dpfwtooH7qzOEYdN?usp=sharing">Tutorial 0: Introduction to pyhealth.data</a>  <a class="reference external" href="https://www.youtube.com/watch?v=Nk1itBoLOX8&amp;list=PLR3CNIF8DDHJUl8RLhyOVpX_kT4bxulEV&amp;index=2">[Video]</a></p>
<p><a class="reference external" href="https://colab.research.google.com/drive/18kbzEQAj1FMs_J9rTGX8eCoxnWdx4Ltn?usp=sharing">Tutorial 1: Introduction to pyhealth.datasets</a>  <a class="reference external" href="https://www.youtube.com/watch?v=c1InKqFJbsI&amp;list=PLR3CNIF8DDHJUl8RLhyOVpX_kT4bxulEV&amp;index=3">[Video]</a></p>
<p><a class="reference external" href="https://colab.research.google.com/drive/1r7MYQR_5yCJGpK_9I9-A10HmpupZuIN-?usp=sharing">Tutorial 2: Introduction to pyhealth.tasks</a>  <a class="reference external" href="https://www.youtube.com/watch?v=CxESe1gYWU4&amp;list=PLR3CNIF8DDHJUl8RLhyOVpX_kT4bxulEV&amp;index=4">[Video]</a></p>
<p><a class="reference external" href="https://colab.research.google.com/drive/1LcXZlu7ZUuqepf269X3FhXuhHeRvaJX5?usp=sharing">Tutorial 3: Introduction to pyhealth.models</a>  <a class="reference external" href="https://www.youtube.com/watch?v=fRc0ncbTgZA&amp;list=PLR3CNIF8DDHJUl8RLhyOVpX_kT4bxulEV&amp;index=6">[Video]</a></p>
<p><a class="reference external" href="https://colab.research.google.com/drive/1L1Nz76cRNB7wTp5Pz_4Vp4N2eRZ9R6xl?usp=sharing">Tutorial 4: Introduction to pyhealth.trainer</a>  <a class="reference external" href="https://www.youtube.com/watch?v=5Hyw3of5pO4&amp;list=PLR3CNIF8DDHJUl8RLhyOVpX_kT4bxulEV&amp;index=7">[Video]</a></p>
<p><a class="reference external" href="https://colab.research.google.com/drive/1Mrs77EJ92HwMgDaElJ_CBXbi4iABZBeo?usp=sharing">Tutorial 5: Introduction to pyhealth.metrics</a>  <a class="reference external" href="https://www.youtube.com/watch?v=d-Kx_xCwre4&amp;list=PLR3CNIF8DDHJUl8RLhyOVpX_kT4bxulEV&amp;index=8">[Video]</a></p>
<p><a class="reference external" href="https://colab.research.google.com/drive/1bDOb0A5g0umBjtz8NIp4wqye7taJ03D0?usp=sharing">Tutorial 6: Introduction to pyhealth.tokenizer</a> <a class="reference external" href="https://www.youtube.com/watch?v=CeXJtf0lfs0&amp;list=PLR3CNIF8DDHJUl8RLhyOVpX_kT4bxulEV&amp;index=10">[Video]</a></p>
<p><a class="reference external" href="https://colab.research.google.com/drive/1xrp_ACM2_Hg5Wxzj0SKKKgZfMY0WwEj3?usp=sharing">Tutorial 7: Introduction to pyhealth.medcode</a> <a class="reference external" href="https://www.youtube.com/watch?v=MmmfU6_xkYg&amp;list=PLR3CNIF8DDHJUl8RLhyOVpX_kT4bxulEV&amp;index=9">[Video]</a></p>
<blockquote>
<div><p>The following tutorials will help users build their own task pipelines. <a class="reference external" href="https://www.youtube.com/watch?v=GGP3Dhfyisc&amp;list=PLR3CNIF8DDHJUl8RLhyOVpX_kT4bxulEV&amp;index=12">[Video]</a></p>
</div></blockquote>
<p><a class="reference external" href="https://colab.research.google.com/drive/10CSb4F4llYJvv42yTUiRmvSZdoEsbmFF?usp=sharing">Pipeline 1: Drug Recommendation</a></p>
<p><a class="reference external" href="https://colab.research.google.com/drive/1JoPpXqqB1_lGF1XscBOsDHMLtgvlOYI1?usp=sharing">Pipeline 2: Length of Stay Prediction</a></p>
<p><a class="reference external" href="https://colab.research.google.com/drive/1bhCwbXce1YFtVaQLsOt4FcyZJ1_my7Cs?usp=sharing">Pipeline 3: Readmission Prediction</a></p>
<p><a class="reference external" href="https://colab.research.google.com/drive/1Qblpcv4NWjrnADT66TjBcNwOe8x6wU4c?usp=sharing">Pipeline 4: Mortality Prediction</a></p>
<p><a class="reference external" href="https://colab.research.google.com/drive/1mpSeNCAthXG3cqROkdUcUdozIPIMTCuo?usp=sharing">Pipeline 5: Sleep Staging</a></p>
<hr class="docutils" />
</section>
<span id="document-advance_tutorials"></span><section id="advanced-tutorials">
<h3>Advanced Tutorials<a class="headerlink" href="#advanced-tutorials" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>We provided advanced tutorials for supporting various needs.</p>
</div></blockquote>
<p><a class="reference external" href="https://colab.research.google.com/drive/1UurxwAAov1bL_5OO3gQJ4gAa_paeJwJp?usp=sharing">Advanced Tutorial 1: Fit your dataset into our pipeline</a>  <a class="reference external" href="https://www.youtube.com/watch?v=xw2hGLEQ4Y0&amp;list=PLR3CNIF8DDHJUl8RLhyOVpX_kT4bxulEV&amp;index=13">[Video]</a></p>
<p><a class="reference external" href="https://colab.research.google.com/drive/1gK6zPXvfFGBM1uNaLP32BOKrnnJdqRq2?usp=sharing">Advanced Tutorial 2: Define your own healthcare task</a></p>
<p><a class="reference external" href="https://colab.research.google.com/drive/1F_NJ90GC8_Eq-vKTf7Tyziew4gWjjKoH?usp=sharing">Advanced Tutorial 3: Adopt customized model into pyhealth</a>  <a class="reference external" href="https://www.youtube.com/watch?v=lADFlcmLtdE&amp;list=PLR3CNIF8DDHJUl8RLhyOVpX_kT4bxulEV&amp;index=14">[Video]</a></p>
<p><a class="reference external" href="https://colab.research.google.com/drive/1ZRnKch2EyJLrI3G5AvDXVpeE2wwgBWfw?usp=sharing">Advanced Tutorial 4: Load your own processed data into pyhealth and try out our ML models</a> <a class="reference external" href="https://www.youtube.com/watch?v=xw2hGLEQ4Y0&amp;list=PLR3CNIF8DDHJUl8RLhyOVpX_kT4bxulEV&amp;index=13">[Video]</a></p>
<hr class="docutils" />
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-api/data"></span><section id="data">
<h3>Data<a class="headerlink" href="#data" title="Permalink to this heading">#</a></h3>
<p><strong>pyhealth.data</strong> defines the atomic data structures of this package.</p>
<div class="toctree-wrapper compound">
<span id="document-api/data/pyhealth.data.Event"></span><section id="pyhealth-data-event">
<h4>pyhealth.data.Event<a class="headerlink" href="#pyhealth-data-event" title="Permalink to this heading">#</a></h4>
<p>One basic data structure in the package. It is a simple container for a single event.
It contains all necessary attributes for supporting various healthcare tasks.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyhealth.data.Event">
<em class="property"><span class="pre">class</span><span class="w">  </span></em><span class="sig-prename descclassname"><span class="pre">pyhealth.data.</span></span><span class="sig-name descname"><span class="pre">Event</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr_dict=&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.data.Event" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Event class representing a single clinical event.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyhealth.data.Event.event_type">
<span class="sig-name descname"><span class="pre">event_type</span></span><a class="headerlink" href="#pyhealth.data.Event.event_type" title="Permalink to this definition">#</a></dt>
<dd><p>Type of the clinical event (e.g., â€˜medicationâ€™, â€˜diagnosisâ€™)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyhealth.data.Event.timestamp">
<span class="sig-name descname"><span class="pre">timestamp</span></span><a class="headerlink" href="#pyhealth.data.Event.timestamp" title="Permalink to this definition">#</a></dt>
<dd><p>When the event occurred</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>datetime</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyhealth.data.Event.attr_dict">
<span class="sig-name descname"><span class="pre">attr_dict</span></span><a class="headerlink" href="#pyhealth.data.Event.attr_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Dictionary containing event-specific attributes</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Mapping[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">event_type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w">  </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#id0" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">timestamp</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w">  </span><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="(in Python v3.13)"><span class="pre">datetime</span></a></em><a class="headerlink" href="#id1" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">attr_dict</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w">  </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.13)"><span class="pre">Mapping</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w">  </span><span class="pre">any</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#id2" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyhealth.data.Event.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w">  </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.data.Event.from_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Create an Event instance from a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>d</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>any</em><em>]</em>) â€“ Dictionary containing event data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An instance of the Event class.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="index.html#pyhealth.data.Event" title="pyhealth.data.Event">Event</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<span id="document-api/data/pyhealth.data.Patient"></span><section id="pyhealth-data-patient">
<h4>pyhealth.data.Patient<a class="headerlink" href="#pyhealth-data-patient" title="Permalink to this heading">#</a></h4>
<p>Another basic data structure in the package. A Patient is a collection of Visit for
the current patients. It contains all necessary attributes of a patient, such as
ethnicity, mortality status, gender, etc. It can support various healthcare tasks.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyhealth.data.Patient">
<em class="property"><span class="pre">class</span><span class="w">  </span></em><span class="sig-prename descclassname"><span class="pre">pyhealth.data.</span></span><span class="sig-name descname"><span class="pre">Patient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patient_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_source</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.data.Patient" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Patient class representing a sequence of events.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyhealth.data.Patient.patient_id">
<span class="sig-name descname"><span class="pre">patient_id</span></span><a class="headerlink" href="#pyhealth.data.Patient.patient_id" title="Permalink to this definition">#</a></dt>
<dd><p>Unique patient identifier.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyhealth.data.Patient.data_source">
<span class="sig-name descname"><span class="pre">data_source</span></span><a class="headerlink" href="#pyhealth.data.Patient.data_source" title="Permalink to this definition">#</a></dt>
<dd><p>DataFrame containing all events.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pl.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyhealth.data.Patient.get_events">
<span class="sig-name descname"><span class="pre">get_events</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.data.Patient.get_events" title="Permalink to this definition">#</a></dt>
<dd><p>Get events with optional type and time filters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>event_type</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>) â€“ Type of events to filter.</p></li>
<li><p><strong>start</strong> (<em>Optional</em><em>[</em><em>datetime</em><em>]</em>) â€“ Start time for filtering events.</p></li>
<li><p><strong>end</strong> (<em>Optional</em><em>[</em><em>datetime</em><em>]</em>) â€“ End time for filtering events.</p></li>
<li><p><strong>return_df</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) â€“ Whether to return a DataFrame or a list of
Event objects.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Filtered events as a DataFrame
or a list of Event objects.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[pl.DataFrame, List[<a class="reference internal" href="index.html#pyhealth.data.Event" title="pyhealth.data.Event">Event</a>]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</div>
</section>
<span id="document-api/datasets"></span><section id="datasets">
<h3>Datasets<a class="headerlink" href="#datasets" title="Permalink to this heading">#</a></h3>
<div class="toctree-wrapper compound">
<span id="document-api/datasets/pyhealth.datasets.BaseDataset"></span><section id="pyhealth-datasets-basedataset">
<h4>pyhealth.datasets.BaseDataset<a class="headerlink" href="#pyhealth-datasets-basedataset" title="Permalink to this heading">#</a></h4>
<p>This is the basic base dataset class. Any specific datasets will inherit from this class.</p>
</section>
<span id="document-api/datasets/pyhealth.datasets.SampleDataset"></span><section id="pyhealth-datasets-sampledataset">
<h4>pyhealth.datasets.SampleDataset<a class="headerlink" href="#pyhealth-datasets-sampledataset" title="Permalink to this heading">#</a></h4>
<p>This class is the basic sample dataset. All sample datasets are inherited from this class.</p>
</section>
<span id="document-api/datasets/pyhealth.datasets.MIMIC3Dataset"></span><section id="pyhealth-datasets-mimic3dataset">
<h4>pyhealth.datasets.MIMIC3Dataset<a class="headerlink" href="#pyhealth-datasets-mimic3dataset" title="Permalink to this heading">#</a></h4>
<p>The open Medical Information Mart for Intensive Care (MIMIC-III) database, refer to <a class="reference external" href="https://mimic.mit.edu/">doc</a> for more information. We process this database into well-structured dataset object and give user the <strong>best flexibility and convenience</strong> for supporting modeling and analysis.</p>
</section>
<span id="document-api/datasets/pyhealth.datasets.MIMIC4Dataset"></span><section id="pyhealth-datasets-mimic4dataset">
<h4>pyhealth.datasets.MIMIC4Dataset<a class="headerlink" href="#pyhealth-datasets-mimic4dataset" title="Permalink to this heading">#</a></h4>
<p>The open Medical Information Mart for Intensive Care (MIMIC-IV) database, refer to <a class="reference external" href="https://mimic.mit.edu/">doc</a> for more information. We process this database into well-structured dataset object and give user the <strong>best flexibility and convenience</strong> for supporting modeling and analysis.</p>
</section>
<span id="document-api/datasets/pyhealth.datasets.MedicalTranscriptionsDataset"></span><section id="pyhealth-datasets-medicaltranscriptionsdataset">
<h4>pyhealth.datasets.MedicalTranscriptionsDataset<a class="headerlink" href="#pyhealth-datasets-medicaltranscriptionsdataset" title="Permalink to this heading">#</a></h4>
<p>The Medical Transcriptions dataset, refer to <a class="reference external" href="https://www.kaggle.com/datasets/codebasics/medical-transcriptions-for-speech-recognition">doc</a>.</p>
</section>
<span id="document-api/datasets/pyhealth.datasets.CardiologyDataset"></span><section id="pyhealth-datasets-cardiologydataset">
<h4>pyhealth.datasets.CardiologyDataset<a class="headerlink" href="#pyhealth-datasets-cardiologydataset" title="Permalink to this heading">#</a></h4>
<p>The Cardiology dataset includes six portions â€œcpsc_2018â€, â€œcpsc_2018_extraâ€, â€œgeorgiaâ€, â€œptbâ€, â€œptb-xlâ€, â€œst_petersburg_incartâ€, refer to <a class="reference external" href="https://physionet.org/content/challenge-2020/1.0.2/">doc</a> for more information.</p>
</section>
<span id="document-api/datasets/pyhealth.datasets.eICUDataset"></span><section id="pyhealth-datasets-eicudataset">
<h4>pyhealth.datasets.eICUDataset<a class="headerlink" href="#pyhealth-datasets-eicudataset" title="Permalink to this heading">#</a></h4>
<p>The open eICU Collaborative Research Database, refer to <a class="reference external" href="https://eicu-crd.mit.edu/">doc</a> for more information. We process this database into well-structured dataset object and give user the <strong>best flexibility and convenience</strong> for supporting modeling and analysis.</p>
</section>
<span id="document-api/datasets/pyhealth.datasets.ISRUCDataset"></span><section id="pyhealth-datasets-isrucdataset">
<h4>pyhealth.datasets.ISRUCDataset<a class="headerlink" href="#pyhealth-datasets-isrucdataset" title="Permalink to this heading">#</a></h4>
<p>The open ISRUC EEF database, refer to <a class="reference external" href="https://sleeptight.isr.uc.pt/">doc</a> for more information.</p>
</section>
<span id="document-api/datasets/pyhealth.datasets.MIMICExtractDataset"></span><section id="pyhealth-datasets-mimicextractdataset">
<h4>pyhealth.datasets.MIMICExtractDataset<a class="headerlink" href="#pyhealth-datasets-mimicextractdataset" title="Permalink to this heading">#</a></h4>
<p>The open Medical Information Mart for Intensive Care (MIMIC-III) database, refer to <a class="reference external" href="https://mimic.mit.edu/">doc</a> for more information. We process this database into well-structured dataset object and give user the <strong>best flexibility and convenience</strong> for supporting modeling and analysis.</p>
</section>
<span id="document-api/datasets/pyhealth.datasets.OMOPDataset"></span><section id="pyhealth-datasets-omopdataset">
<h4>pyhealth.datasets.OMOPDataset<a class="headerlink" href="#pyhealth-datasets-omopdataset" title="Permalink to this heading">#</a></h4>
<p>We can process any OMOP-CDM formatted database, refer to <a class="reference external" href="https://www.ohdsi.org/data-standardization/the-common-data-model/">doc</a> for more information. The raw data is processed into well-structured dataset object and give user the <strong>best flexibility and convenience</strong> for supporting modeling and analysis.</p>
</section>
<span id="document-api/datasets/pyhealth.datasets.SHHSDataset"></span><section id="pyhealth-datasets-shhsdataset">
<h4>pyhealth.datasets.SHHSDataset<a class="headerlink" href="#pyhealth-datasets-shhsdataset" title="Permalink to this heading">#</a></h4>
<p>The open Sleep-EDF Database Expanded database, refer to <a class="reference external" href="https://sleepdata.org/datasets/shhs">doc</a> for more information.</p>
</section>
<span id="document-api/datasets/pyhealth.datasets.SleepEDFDataset"></span><section id="pyhealth-datasets-sleepedfdataset">
<h4>pyhealth.datasets.SleepEDFDataset<a class="headerlink" href="#pyhealth-datasets-sleepedfdataset" title="Permalink to this heading">#</a></h4>
<p>The open Sleep-EDF Database Expanded database, refer to <a class="reference external" href="https://www.physionet.org/content/sleep-edfx/1.0.0/">doc</a> for more information.</p>
</section>
<span id="document-api/datasets/pyhealth.datasets.TUABDataset"></span><section id="pyhealth-datasets-tuabdataset">
<h4>pyhealth.datasets.TUABDataset<a class="headerlink" href="#pyhealth-datasets-tuabdataset" title="Permalink to this heading">#</a></h4>
<p>Dataset is available at <a class="reference external" href="https://isip.piconepress.com/projects/nedc/html/tuh_eeg/#c_tuab">https://isip.piconepress.com/projects/nedc/html/tuh_eeg/#c_tuab</a></p>
<p>The TUAB dataset (or Temple University Hospital EEG Abnormal Corpus) is a collection of EEG data acquired at the Temple University Hospital.</p>
<p>The dataset contains both normal and abnormal EEG readings.</p>
</section>
<span id="document-api/datasets/pyhealth.datasets.TUEVDataset"></span><section id="pyhealth-datasets-tuevdataset">
<h4>pyhealth.datasets.TUEVDataset<a class="headerlink" href="#pyhealth-datasets-tuevdataset" title="Permalink to this heading">#</a></h4>
<p>Dataset is available at <a class="reference external" href="https://isip.piconepress.com/projects/tuh_eeg/html/downloads.shtml">https://isip.piconepress.com/projects/tuh_eeg/html/downloads.shtml</a></p>
<p>This corpus is a subset of TUEG that contains annotations of EEG segments as one of six classes: (1) spike and sharp wave (SPSW), (2) generalized periodic epileptiform discharges (GPED), (3) periodic lateralized epileptiform discharges (PLED), (4) eye movement (EYEM), (5) artifact (ARTF) and (6) background (BCKG).</p>
</section>
<span id="document-api/datasets/pyhealth.datasets.splitter"></span><section id="pyhealth-datasets-splitter">
<h4>pyhealth.datasets.splitter<a class="headerlink" href="#pyhealth-datasets-splitter" title="Permalink to this heading">#</a></h4>
<p>Several data splitting function for <cite>pyhealth.datasets</cite> module to obtain training / validation / test sets.</p>
</section>
<span id="document-api/datasets/pyhealth.datasets.utils"></span><section id="pyhealth-datasets-utils">
<h4>pyhealth.datasets.utils<a class="headerlink" href="#pyhealth-datasets-utils" title="Permalink to this heading">#</a></h4>
<p>Several utility functions.</p>
</section>
</div>
</section>
<span id="document-api/tasks"></span><section id="tasks">
<h3>Tasks<a class="headerlink" href="#tasks" title="Permalink to this heading">#</a></h3>
<p>We support various real-world healthcare predictive tasks defined by <strong>function calls</strong>. The following example tasks are collected from top AI/Medical venues, such as:</p>
<ol class="lowerroman simple">
<li><p>Drug Recommendation [Yang et al. IJCAI 2021a, Yang et al. IJCAI 2021b, Shang et al. AAAI 2020]</p></li>
<li><p>Readmission Prediction [Choi et al. AAAI 2021]</p></li>
<li><p>Mortality Prediction [Choi et al. AAAI 2021]</p></li>
<li><p>Length of Stay Prediction</p></li>
<li><p>Sleep Staging [Yang et al. ArXiv 2021]</p></li>
</ol>
<div class="toctree-wrapper compound">
<span id="document-api/tasks/pyhealth.tasks.BaseTask"></span><section id="module-pyhealth.tasks.BaseTask">
<span id="pyhealth-tasks-basetask"></span><h4>pyhealth.tasks.BaseTask<a class="headerlink" href="#module-pyhealth.tasks.BaseTask" title="Permalink to this heading">#</a></h4>
<p>Helper class that provides a standard way to create an ABC using
inheritance.</p>
</section>
<span id="document-api/tasks/pyhealth.tasks.Readmission30DaysMIMIC4"></span><section id="module-pyhealth.tasks.Readmission30DaysMIMIC4">
<span id="pyhealth-tasks-readmission30daysmimic4"></span><h4>pyhealth.tasks.Readmission30DaysMIMIC4<a class="headerlink" href="#module-pyhealth.tasks.Readmission30DaysMIMIC4" title="Permalink to this heading">#</a></h4>
<p>Task for predicting 30-day readmission using MIMIC-IV data.</p>
</section>
<span id="document-api/tasks/pyhealth.tasks.InHospitalMortalityMIMIC4"></span><section id="pyhealth-tasks-eeg-evinhospitalmortalitymimic4ents">
<h4>pyhealth.tasks.EEG_evInHospitalMortalityMIMIC4ents<a class="headerlink" href="#pyhealth-tasks-eeg-evinhospitalmortalitymimic4ents" title="Permalink to this heading">#</a></h4>
<span class="target" id="module-pyhealth.tasks.InHospitalMortalityMIMIC4"></span><p>Task for predicting in-hospital mortality using MIMIC-IV dataset.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyhealth.tasks.InHospitalMortalityMIMIC4.task_name">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.InHospitalMortalityMIMIC4.</span></span><span class="sig-name descname"><span class="pre">task_name</span></span><a class="headerlink" href="#pyhealth.tasks.InHospitalMortalityMIMIC4.task_name" title="Permalink to this definition">#</a></dt>
<dd><p>The name of the task.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyhealth.tasks.InHospitalMortalityMIMIC4.input_schema">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.InHospitalMortalityMIMIC4.</span></span><span class="sig-name descname"><span class="pre">input_schema</span></span><a class="headerlink" href="#pyhealth.tasks.InHospitalMortalityMIMIC4.input_schema" title="Permalink to this definition">#</a></dt>
<dd><p>The input schema for the task.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyhealth.tasks.InHospitalMortalityMIMIC4.output_schema">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.InHospitalMortalityMIMIC4.</span></span><span class="sig-name descname"><span class="pre">output_schema</span></span><a class="headerlink" href="#pyhealth.tasks.InHospitalMortalityMIMIC4.output_schema" title="Permalink to this definition">#</a></dt>
<dd><p>The output schema for the task.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>]</p>
</dd>
</dl>
</dd></dl>

</section>
<span id="document-api/tasks/pyhealth.tasks.MIMIC3ICD9Coding"></span><section id="module-pyhealth.tasks.MIMIC3ICD9Coding">
<span id="pyhealth-tasks-mimic3icd9coding"></span><h4>pyhealth.tasks.MIMIC3ICD9Coding<a class="headerlink" href="#module-pyhealth.tasks.MIMIC3ICD9Coding" title="Permalink to this heading">#</a></h4>
<p>Medical coding task for MIMIC-III using ICD-9 codes.</p>
<p>This task uses clinical notes to predict ICD-9 codes for a patient.</p>
<dl class="field-list simple">
<dt class="field-odd">param task_name<span class="colon">:</span></dt>
<dd class="field-odd"><p>Name of the task</p>
</dd>
<dt class="field-even">param input_schema<span class="colon">:</span></dt>
<dd class="field-even"><p>Definition of the input data schema</p>
</dd>
<dt class="field-odd">param output_schema<span class="colon">:</span></dt>
<dd class="field-odd"><p>Definition of the output data schema</p>
</dd>
</dl>
</section>
<span id="document-api/tasks/pyhealth.tasks.cardiology_detect"></span><section id="module-pyhealth.tasks.cardiology_detect">
<span id="pyhealth-tasks-cardiology-detect"></span><h4>pyhealth.tasks.cardiology_detect<a class="headerlink" href="#module-pyhealth.tasks.cardiology_detect" title="Permalink to this heading">#</a></h4>
<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.cardiology_detect.cardiology_isAR_fn">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.cardiology_detect.</span></span><span class="sig-name descname"><span class="pre">cardiology_isAR_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch_sec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.cardiology_detect.cardiology_isAR_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Processes a single patient for the Arrhythmias symptom in cardiology on the CardiologyDataset</p>
<p>Cardiology symptoms can be divided into six categories. The task focuses on Arrhythmias and is defined as a binary classification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>record</strong> â€“ <p>a singleton list of one subject from the CardiologyDataset.
The (single) record is a dictionary with the following keys:</p>
<blockquote>
<div><p>load_from_path, signal_file, label1_file, label2_file, save_to_path, subject_id</p>
</div></blockquote>
</p></li>
<li><p><strong>epoch_sec</strong> â€“ how long will each epoch be (in seconds).</p></li>
<li><p><strong>shift</strong> â€“ the step size for the sampling window (with a width of epoch_sec)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a list of samples, each sample is a dict with patient_id, record_id,</dt><dd><p>and epoch_path (the path to the saved epoch {â€œXâ€: signal, â€œSexâ€: gender, â€œAgeâ€: age, Yâ€: label} as key.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>samples</p>
</dd>
</dl>
<p>Note that we define the task as a binary classification task.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">CardiologyDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">isAR</span> <span class="o">=</span> <span class="n">CardiologyDataset</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">root</span><span class="o">=</span><span class="s2">&quot;physionet.org/files/challenge-2020/1.0.2/training&quot;</span><span class="p">,</span>
<span class="go">            chosen_dataset=[1,1,1,1,1,1],</span>
<span class="go">...     )</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">cardiology_isAR_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cardiology_ds</span> <span class="o">=</span> <span class="n">isAR</span><span class="o">.</span><span class="n">set_task</span><span class="p">(</span><span class="n">cardiology_isAR_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cardiology_ds</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">{</span>
<span class="go">    &#39;patient_id&#39;: &#39;0_0&#39;,</span>
<span class="go">    &#39;visit_id&#39;: &#39;A0033&#39;,</span>
<span class="go">    &#39;record_id&#39;: 1,</span>
<span class="go">    &#39;Sex&#39;: [&#39;Female&#39;],</span>
<span class="go">    &#39;Age&#39;: [&#39;34&#39;],</span>
<span class="go">    &#39;epoch_path&#39;: &#39;/Users/liyanjing/.cache/pyhealth/datasets/46c18f2a1a18803b4707a934a577a331/0_0-0.pkl&#39;,</span>
<span class="go">    &#39;label&#39;: &#39;0&#39;</span>
<span class="go">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.cardiology_detect.cardiology_isBBBFB_fn">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.cardiology_detect.</span></span><span class="sig-name descname"><span class="pre">cardiology_isBBBFB_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch_sec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.cardiology_detect.cardiology_isBBBFB_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Processes a single patient for the Bundle branch blocks and fascicular blocks symptom in cardiology on the CardiologyDataset</p>
<p>Cardiology symptoms can be divided into six categories. The task focuses on Bundle branch blocks and fascicular blocks and is defined as a binary classification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>record</strong> â€“ <p>a singleton list of one subject from the CardiologyDataset.
The (single) record is a dictionary with the following keys:</p>
<blockquote>
<div><p>load_from_path, signal_file, label1_file, label2_file, save_to_path, subject_id</p>
</div></blockquote>
</p></li>
<li><p><strong>epoch_sec</strong> â€“ how long will each epoch be (in seconds).</p></li>
<li><p><strong>shift</strong> â€“ the step size for the sampling window (with a width of epoch_sec)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a list of samples, each sample is a dict with patient_id, record_id,</dt><dd><p>and epoch_path (the path to the saved epoch {â€œXâ€: signal, â€œSexâ€: gender, â€œAgeâ€: age, Yâ€: label} as key.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>samples</p>
</dd>
</dl>
<p>Note that we define the task as a binary classification task.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">CardiologyDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">isBBBFB</span> <span class="o">=</span> <span class="n">CardiologyDataset</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">root</span><span class="o">=</span><span class="s2">&quot;physionet.org/files/challenge-2020/1.0.2/training&quot;</span><span class="p">,</span>
<span class="go">            chosen_dataset=[1,1,1,1,1,1],</span>
<span class="go">...     )</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">cardiology_isBBBFB_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cardiology_ds</span> <span class="o">=</span> <span class="n">isBBBFB</span><span class="o">.</span><span class="n">set_task</span><span class="p">(</span><span class="n">cardiology_isBBBFB_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cardiology_ds</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">{</span>
<span class="go">    &#39;patient_id&#39;: &#39;0_0&#39;,</span>
<span class="go">    &#39;visit_id&#39;: &#39;A0033&#39;,</span>
<span class="go">    &#39;record_id&#39;: 1,</span>
<span class="go">    &#39;Sex&#39;: [&#39;Female&#39;],</span>
<span class="go">    &#39;Age&#39;: [&#39;34&#39;],</span>
<span class="go">    &#39;epoch_path&#39;: &#39;/Users/liyanjing/.cache/pyhealth/datasets/46c18f2a1a18803b4707a934a577a331/0_0-0.pkl&#39;,</span>
<span class="go">    &#39;label&#39;: &#39;0&#39;</span>
<span class="go">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.cardiology_detect.cardiology_isAD_fn">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.cardiology_detect.</span></span><span class="sig-name descname"><span class="pre">cardiology_isAD_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch_sec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.cardiology_detect.cardiology_isAD_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Processes a single patient for the Axis deviations symptom in cardiology on the CardiologyDataset</p>
<p>Cardiology symptoms can be divided into six categories. The task focuses on Axis deviations and is defined as a binary classification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>record</strong> â€“ <p>a singleton list of one subject from the CardiologyDataset.
The (single) record is a dictionary with the following keys:</p>
<blockquote>
<div><p>load_from_path, signal_file, label1_file, label2_file, save_to_path, subject_id</p>
</div></blockquote>
</p></li>
<li><p><strong>epoch_sec</strong> â€“ how long will each epoch be (in seconds).</p></li>
<li><p><strong>shift</strong> â€“ the step size for the sampling window (with a width of epoch_sec)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a list of samples, each sample is a dict with patient_id, record_id,</dt><dd><p>and epoch_path (the path to the saved epoch {â€œXâ€: signal, â€œSexâ€: gender, â€œAgeâ€: age, Yâ€: label} as key.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>samples</p>
</dd>
</dl>
<p>Note that we define the task as a binary classification task.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">CardiologyDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">isAD</span> <span class="o">=</span> <span class="n">CardiologyDataset</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">root</span><span class="o">=</span><span class="s2">&quot;physionet.org/files/challenge-2020/1.0.2/training&quot;</span><span class="p">,</span>
<span class="go">            chosen_dataset=[1,1,1,1,1,1],</span>
<span class="go">...     )</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">cardiology_isAD_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cardiology_ds</span> <span class="o">=</span> <span class="n">isAD</span><span class="o">.</span><span class="n">set_task</span><span class="p">(</span><span class="n">cardiology_isAD_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cardiology_ds</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">{</span>
<span class="go">    &#39;patient_id&#39;: &#39;0_0&#39;,</span>
<span class="go">    &#39;visit_id&#39;: &#39;A0033&#39;,</span>
<span class="go">    &#39;record_id&#39;: 1,</span>
<span class="go">    &#39;Sex&#39;: [&#39;Female&#39;],</span>
<span class="go">    &#39;Age&#39;: [&#39;34&#39;],</span>
<span class="go">    &#39;epoch_path&#39;: &#39;/Users/liyanjing/.cache/pyhealth/datasets/46c18f2a1a18803b4707a934a577a331/0_0-0.pkl&#39;,</span>
<span class="go">    &#39;label&#39;: &#39;0&#39;</span>
<span class="go">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.cardiology_detect.cardiology_isCD_fn">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.cardiology_detect.</span></span><span class="sig-name descname"><span class="pre">cardiology_isCD_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch_sec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.cardiology_detect.cardiology_isCD_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Processes a single patient for the Conduction delays symptom in cardiology on the CardiologyDataset</p>
<p>Cardiology symptoms can be divided into six categories. The task focuses on Conduction delays and is defined as a binary classification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>record</strong> â€“ <p>a singleton list of one subject from the CardiologyDataset.
The (single) record is a dictionary with the following keys:</p>
<blockquote>
<div><p>load_from_path, signal_file, label1_file, label2_file, save_to_path, subject_id</p>
</div></blockquote>
</p></li>
<li><p><strong>epoch_sec</strong> â€“ how long will each epoch be (in seconds).</p></li>
<li><p><strong>shift</strong> â€“ the step size for the sampling window (with a width of epoch_sec)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a list of samples, each sample is a dict with patient_id, record_id,</dt><dd><p>and epoch_path (the path to the saved epoch {â€œXâ€: signal, â€œSexâ€: gender, â€œAgeâ€: age, Yâ€: label} as key.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>samples</p>
</dd>
</dl>
<p>Note that we define the task as a binary classification task.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">CardiologyDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">isCD</span> <span class="o">=</span> <span class="n">CardiologyDataset</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">root</span><span class="o">=</span><span class="s2">&quot;physionet.org/files/challenge-2020/1.0.2/training&quot;</span><span class="p">,</span>
<span class="go">            chosen_dataset=[1,1,1,1,1,1],</span>
<span class="go">...     )</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">cardiology_isCD_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cardiology_ds</span> <span class="o">=</span> <span class="n">isCD</span><span class="o">.</span><span class="n">set_task</span><span class="p">(</span><span class="n">cardiology_isCD_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cardiology_ds</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">{</span>
<span class="go">    &#39;patient_id&#39;: &#39;0_0&#39;,</span>
<span class="go">    &#39;visit_id&#39;: &#39;A0033&#39;,</span>
<span class="go">    &#39;record_id&#39;: 1,</span>
<span class="go">    &#39;Sex&#39;: [&#39;Female&#39;],</span>
<span class="go">    &#39;Age&#39;: [&#39;34&#39;],</span>
<span class="go">    &#39;epoch_path&#39;: &#39;/Users/liyanjing/.cache/pyhealth/datasets/46c18f2a1a18803b4707a934a577a331/0_0-0.pkl&#39;,</span>
<span class="go">    &#39;label&#39;: &#39;0&#39;</span>
<span class="go">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.cardiology_detect.cardiology_isWA_fn">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.cardiology_detect.</span></span><span class="sig-name descname"><span class="pre">cardiology_isWA_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch_sec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.cardiology_detect.cardiology_isWA_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Processes a single patient for the Wave abnormalities symptom in cardiology on the CardiologyDataset</p>
<p>Cardiology symptoms can be divided into six categories. The task focuses on Wave abnormalities and is defined as a binary classification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>record</strong> â€“ <p>a singleton list of one subject from the CardiologyDataset.
The (single) record is a dictionary with the following keys:</p>
<blockquote>
<div><p>load_from_path, signal_file, label1_file, label2_file, save_to_path, subject_id</p>
</div></blockquote>
</p></li>
<li><p><strong>epoch_sec</strong> â€“ how long will each epoch be (in seconds).</p></li>
<li><p><strong>shift</strong> â€“ the step size for the sampling window (with a width of epoch_sec)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a list of samples, each sample is a dict with patient_id, record_id,</dt><dd><p>and epoch_path (the path to the saved epoch {â€œXâ€: signal, â€œSexâ€: gender, â€œAgeâ€: age, Yâ€: label} as key.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>samples</p>
</dd>
</dl>
<p>Note that we define the task as a binary classification task.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">CardiologyDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">isWA</span> <span class="o">=</span> <span class="n">CardiologyDataset</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">root</span><span class="o">=</span><span class="s2">&quot;physionet.org/files/challenge-2020/1.0.2/training&quot;</span><span class="p">,</span>
<span class="go">            chosen_dataset=[1,1,1,1,1,1],</span>
<span class="go">...     )</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">cardiology_isWA_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cardiology_ds</span> <span class="o">=</span> <span class="n">isWA</span><span class="o">.</span><span class="n">set_task</span><span class="p">(</span><span class="n">cardiology_isWA_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cardiology_ds</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">{</span>
<span class="go">    &#39;patient_id&#39;: &#39;0_0&#39;,</span>
<span class="go">    &#39;visit_id&#39;: &#39;A0033&#39;,</span>
<span class="go">    &#39;record_id&#39;: 1,</span>
<span class="go">    &#39;Sex&#39;: [&#39;Female&#39;],</span>
<span class="go">    &#39;Age&#39;: [&#39;34&#39;],</span>
<span class="go">    &#39;epoch_path&#39;: &#39;/Users/liyanjing/.cache/pyhealth/datasets/46c18f2a1a18803b4707a934a577a331/0_0-0.pkl&#39;,</span>
<span class="go">    &#39;label&#39;: &#39;0&#39;</span>
<span class="go">}</span>
</pre></div>
</div>
</dd></dl>

</section>
<span id="document-api/tasks/pyhealth.tasks.COVID19CXRClassification"></span><section id="module-pyhealth.tasks.COVID19CXRClassification">
<span id="pyhealth-tasks-covid19cxrclassification"></span><h4>pyhealth.tasks.COVID19CXRClassification<a class="headerlink" href="#module-pyhealth.tasks.COVID19CXRClassification" title="Permalink to this heading">#</a></h4>
<p>A task for classifying chest disease from chest X-ray images.</p>
<p>This task classifies chest X-ray images into different disease categories.
It expects a single chest X-ray image per patient and returns the
corresponding disease label.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyhealth.tasks.COVID19CXRClassification.task_name">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.COVID19CXRClassification.</span></span><span class="sig-name descname"><span class="pre">task_name</span></span><a class="headerlink" href="#pyhealth.tasks.COVID19CXRClassification.task_name" title="Permalink to this definition">#</a></dt>
<dd><p>The name of the task, set to
â€œCOVID19CXRClassificationâ€.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyhealth.tasks.COVID19CXRClassification.input_schema">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.COVID19CXRClassification.</span></span><span class="sig-name descname"><span class="pre">input_schema</span></span><a class="headerlink" href="#pyhealth.tasks.COVID19CXRClassification.input_schema" title="Permalink to this definition">#</a></dt>
<dd><p>The input schema specifying the required
input format. Contains a single key â€œimageâ€ with value â€œimageâ€.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyhealth.tasks.COVID19CXRClassification.output_schema">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.COVID19CXRClassification.</span></span><span class="sig-name descname"><span class="pre">output_schema</span></span><a class="headerlink" href="#pyhealth.tasks.COVID19CXRClassification.output_schema" title="Permalink to this definition">#</a></dt>
<dd><p>The output schema specifying the output
format. Contains a single key â€œdiseaseâ€ with value â€œmulticlassâ€.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>]</p>
</dd>
</dl>
</dd></dl>

</section>
<span id="document-api/tasks/pyhealth.tasks.drug_recommendation"></span><section id="module-pyhealth.tasks.drug_recommendation">
<span id="pyhealth-tasks-drug-recommendation"></span><h4>pyhealth.tasks.drug_recommendation<a class="headerlink" href="#module-pyhealth.tasks.drug_recommendation" title="Permalink to this heading">#</a></h4>
<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.drug_recommendation.drug_recommendation_mimic3_fn">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.drug_recommendation.</span></span><span class="sig-name descname"><span class="pre">drug_recommendation_mimic3_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patient</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.drug_recommendation.drug_recommendation_mimic3_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Processes a single patient for the drug recommendation task.</p>
<p>Drug recommendation aims at recommending a set of drugs given the patient health
history  (e.g., conditions and procedures).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>patient</strong> (<a class="reference internal" href="index.html#pyhealth.data.Patient" title="pyhealth.data.data.Patient"><code class="xref py py-class docutils literal notranslate"><span class="pre">Patient</span></code></a>) â€“ a Patient object</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl>
<dt>a list of samples, each sample is a dict with patient_id, visit_id,</dt><dd><p>and other task-specific attributes as key, like this
{</p>
<blockquote>
<div><p>â€patient_idâ€: xxx,
â€œvisit_idâ€: xxx,
â€œconditionsâ€: [list of diag in visit 1, list of diag in visit 2, â€¦, list of diag in visit N],
â€œproceduresâ€: [list of prod in visit 1, list of prod in visit 2, â€¦, list of prod in visit N],
â€œdrugs_histâ€: [list of drug in visit 1, list of drug in visit 2, â€¦, list of drug in visit (N-1)],
â€œdrugsâ€: list of drug in visit N, # this is the predicted target</p>
</div></blockquote>
<p>}</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>samples</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">MIMIC3Dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mimic3_base</span> <span class="o">=</span> <span class="n">MIMIC3Dataset</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">root</span><span class="o">=</span><span class="s2">&quot;/srv/local/data/physionet.org/files/mimiciii/1.4&quot;</span><span class="p">,</span>
<span class="gp">... </span>   <span class="n">tables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;DIAGNOSES_ICD&quot;</span><span class="p">,</span> <span class="s2">&quot;PROCEDURES_ICD&quot;</span><span class="p">,</span> <span class="s2">&quot;PRESCRIPTIONS&quot;</span><span class="p">],</span>
<span class="gp">... </span>   <span class="n">code_mapping</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;ICD9CM&quot;</span><span class="p">:</span> <span class="s2">&quot;CCSCM&quot;</span><span class="p">},</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">drug_recommendation_mimic3_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mimic3_sample</span> <span class="o">=</span> <span class="n">mimic3_base</span><span class="o">.</span><span class="n">set_task</span><span class="p">(</span><span class="n">drug_recommendation_mimic3_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mimic3_sample</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">{</span>
<span class="go">    &#39;visit_id&#39;: &#39;174162&#39;,</span>
<span class="go">    &#39;patient_id&#39;: &#39;107&#39;,</span>
<span class="go">    &#39;conditions&#39;: [[&#39;139&#39;, &#39;158&#39;, &#39;237&#39;, &#39;99&#39;, &#39;60&#39;, &#39;101&#39;, &#39;51&#39;, &#39;54&#39;, &#39;53&#39;, &#39;133&#39;, &#39;143&#39;, &#39;140&#39;, &#39;117&#39;, &#39;138&#39;, &#39;55&#39;]],</span>
<span class="go">    &#39;procedures&#39;: [[&#39;4443&#39;, &#39;4513&#39;, &#39;3995&#39;]],</span>
<span class="go">    &#39;drugs_hist&#39;: [[]],</span>
<span class="go">    &#39;drugs&#39;: [&#39;0000&#39;, &#39;0033&#39;, &#39;5817&#39;, &#39;0057&#39;, &#39;0090&#39;, &#39;0053&#39;, &#39;0&#39;, &#39;0012&#39;, &#39;6332&#39;, &#39;1001&#39;, &#39;6155&#39;, &#39;1001&#39;, &#39;6332&#39;, &#39;0033&#39;, &#39;5539&#39;, &#39;6332&#39;, &#39;5967&#39;, &#39;0033&#39;, &#39;0040&#39;, &#39;5967&#39;, &#39;5846&#39;, &#39;0016&#39;, &#39;5846&#39;, &#39;5107&#39;, &#39;5551&#39;, &#39;6808&#39;, &#39;5107&#39;, &#39;0090&#39;, &#39;5107&#39;, &#39;5416&#39;, &#39;0033&#39;, &#39;1150&#39;, &#39;0005&#39;, &#39;6365&#39;, &#39;0090&#39;, &#39;6155&#39;, &#39;0005&#39;, &#39;0090&#39;, &#39;0000&#39;, &#39;6373&#39;],</span>
<span class="go">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.drug_recommendation.drug_recommendation_mimic4_fn">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.drug_recommendation.</span></span><span class="sig-name descname"><span class="pre">drug_recommendation_mimic4_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patient</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.drug_recommendation.drug_recommendation_mimic4_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Processes a single patient for the drug recommendation task.</p>
<p>Drug recommendation aims at recommending a set of drugs given the patient health
history  (e.g., conditions and procedures).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>patient</strong> (<a class="reference internal" href="index.html#pyhealth.data.Patient" title="pyhealth.data.data.Patient"><code class="xref py py-class docutils literal notranslate"><span class="pre">Patient</span></code></a>) â€“ a Patient object</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl>
<dt>a list of samples, each sample is a dict with patient_id, visit_id,</dt><dd><p>and other task-specific attributes as key
{</p>
<blockquote>
<div><p>â€patient_idâ€: xxx,
â€œvisit_idâ€: xxx,
â€œconditionsâ€: [list of diag in visit 1, list of diag in visit 2, â€¦, list of diag in visit N],
â€œproceduresâ€: [list of prod in visit 1, list of prod in visit 2, â€¦, list of prod in visit N],
â€œdrugs_histâ€: [list of drug in visit 1, list of drug in visit 2, â€¦, list of drug in visit (N-1)],
â€œdrugsâ€: list of drug in visit N, # this is the predicted target</p>
</div></blockquote>
<p>}</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>samples</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">MIMIC4Dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mimic4_base</span> <span class="o">=</span> <span class="n">MIMIC4Dataset</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">root</span><span class="o">=</span><span class="s2">&quot;/srv/local/data/physionet.org/files/mimiciv/2.0/hosp&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">tables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;diagnoses_icd&quot;</span><span class="p">,</span> <span class="s2">&quot;procedures_icd&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">code_mapping</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;ICD10PROC&quot;</span><span class="p">:</span> <span class="s2">&quot;CCSPROC&quot;</span><span class="p">},</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">drug_recommendation_mimic4_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mimic4_sample</span> <span class="o">=</span> <span class="n">mimic4_base</span><span class="o">.</span><span class="n">set_task</span><span class="p">(</span><span class="n">drug_recommendation_mimic4_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mimic4_sample</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">[{&#39;visit_id&#39;: &#39;130744&#39;, &#39;patient_id&#39;: &#39;103&#39;, &#39;conditions&#39;: [[&#39;42&#39;, &#39;109&#39;, &#39;19&#39;, &#39;122&#39;, &#39;98&#39;, &#39;663&#39;, &#39;58&#39;, &#39;51&#39;]], &#39;procedures&#39;: [[&#39;1&#39;]], &#39;label&#39;: [[&#39;2&#39;, &#39;3&#39;, &#39;4&#39;]]}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.drug_recommendation.drug_recommendation_eicu_fn">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.drug_recommendation.</span></span><span class="sig-name descname"><span class="pre">drug_recommendation_eicu_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patient</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.drug_recommendation.drug_recommendation_eicu_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Processes a single patient for the drug recommendation task.</p>
<p>Drug recommendation aims at recommending a set of drugs given the patient health
history  (e.g., conditions and procedures).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>patient</strong> (<a class="reference internal" href="index.html#pyhealth.data.Patient" title="pyhealth.data.data.Patient"><code class="xref py py-class docutils literal notranslate"><span class="pre">Patient</span></code></a>) â€“ a Patient object</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a list of samples, each sample is a dict with patient_id, visit_id,</dt><dd><p>and other task-specific attributes as key</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>samples</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">eICUDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eicu_base</span> <span class="o">=</span> <span class="n">eICUDataset</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">root</span><span class="o">=</span><span class="s2">&quot;/srv/local/data/physionet.org/files/eicu-crd/2.0&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">tables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;diagnosis&quot;</span><span class="p">,</span> <span class="s2">&quot;medication&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">code_mapping</span><span class="o">=</span><span class="p">{},</span>
<span class="gp">... </span>    <span class="n">dev</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">drug_recommendation_eicu_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eicu_sample</span> <span class="o">=</span> <span class="n">eicu_base</span><span class="o">.</span><span class="n">set_task</span><span class="p">(</span><span class="n">drug_recommendation_eicu_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eicu_sample</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">[{&#39;visit_id&#39;: &#39;130744&#39;, &#39;patient_id&#39;: &#39;103&#39;, &#39;conditions&#39;: [[&#39;42&#39;, &#39;109&#39;, &#39;98&#39;, &#39;663&#39;, &#39;58&#39;, &#39;51&#39;]], &#39;procedures&#39;: [[&#39;1&#39;]], &#39;label&#39;: [[&#39;2&#39;, &#39;3&#39;, &#39;4&#39;]]}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.drug_recommendation.drug_recommendation_omop_fn">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.drug_recommendation.</span></span><span class="sig-name descname"><span class="pre">drug_recommendation_omop_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patient</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.drug_recommendation.drug_recommendation_omop_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Processes a single patient for the drug recommendation task.</p>
<p>Drug recommendation aims at recommending a set of drugs given the patient health
history  (e.g., conditions and procedures).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>patient</strong> (<a class="reference internal" href="index.html#pyhealth.data.Patient" title="pyhealth.data.data.Patient"><code class="xref py py-class docutils literal notranslate"><span class="pre">Patient</span></code></a>) â€“ a Patient object</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a list of samples, each sample is a dict with patient_id, visit_id,</dt><dd><p>and other task-specific attributes as key</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>samples</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">OMOPDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">omop_base</span> <span class="o">=</span> <span class="n">OMOPDataset</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">root</span><span class="o">=</span><span class="s2">&quot;https://storage.googleapis.com/pyhealth/synpuf1k_omop_cdm_5.2.2&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">tables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;condition_occurrence&quot;</span><span class="p">,</span> <span class="s2">&quot;procedure_occurrence&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">code_mapping</span><span class="o">=</span><span class="p">{},</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">drug_recommendation_omop_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">omop_sample</span> <span class="o">=</span> <span class="n">omop_base</span><span class="o">.</span><span class="n">set_task</span><span class="p">(</span><span class="n">drug_recommendation_eicu_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">omop_sample</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">[{&#39;visit_id&#39;: &#39;130744&#39;, &#39;patient_id&#39;: &#39;103&#39;, &#39;conditions&#39;: [[&#39;42&#39;, &#39;109&#39;, &#39;98&#39;, &#39;663&#39;, &#39;58&#39;, &#39;51&#39;], [&#39;98&#39;, &#39;663&#39;, &#39;58&#39;, &#39;51&#39;]], &#39;procedures&#39;: [[&#39;1&#39;], [&#39;2&#39;, &#39;3&#39;]], &#39;label&#39;: [[&#39;2&#39;, &#39;3&#39;, &#39;4&#39;], [&#39;0&#39;, &#39;1&#39;, &#39;4&#39;, &#39;5&#39;]]}]</span>
</pre></div>
</div>
</dd></dl>

</section>
<span id="document-api/tasks/pyhealth.tasks.EEG_abnormal"></span><section id="module-pyhealth.tasks.EEG_abnormal">
<span id="pyhealth-tasks-eeg-abnormal"></span><h4>pyhealth.tasks.EEG_abnormal<a class="headerlink" href="#module-pyhealth.tasks.EEG_abnormal" title="Permalink to this heading">#</a></h4>
<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.EEG_abnormal.EEG_isAbnormal_fn">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.EEG_abnormal.</span></span><span class="sig-name descname"><span class="pre">EEG_isAbnormal_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.EEG_abnormal.EEG_isAbnormal_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Processes a single patient for the abnormal EEG detection task on TUAB.</p>
<p>Abnormal EEG detection aims at determining whether a EEG is abnormal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>record</strong> â€“ <p>a singleton list of one subject from the TUABDataset.
The (single) record is a dictionary with the following keys:</p>
<blockquote>
<div><p>load_from_path, patient_id, visit_id, signal_file, label_file, save_to_path</p>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a list of samples, each sample is a dict with patient_id, visit_id, record_id,</dt><dd><p>and epoch_path (the path to the saved epoch {â€œsignalâ€: signal, â€œlabelâ€: label} as key.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>samples</p>
</dd>
</dl>
<p>Note that we define the task as a binary classification task.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">TUABDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">isabnormal</span> <span class="o">=</span> <span class="n">TUABDataset</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">root</span><span class="o">=</span><span class="s2">&quot;/srv/local/data/TUH/tuh_eeg_abnormal/v3.0.0/edf/&quot;</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">EEG_isabnormal_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EEG_abnormal_ds</span> <span class="o">=</span> <span class="n">isabnormal</span><span class="o">.</span><span class="n">set_task</span><span class="p">(</span><span class="n">EEG_isAbnormal_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EEG_abnormal_ds</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">{</span>
<span class="go">    &#39;patient_id&#39;: &#39;aaaaamye&#39;,</span>
<span class="go">    &#39;visit_id&#39;: &#39;s001&#39;,</span>
<span class="go">    &#39;record_id&#39;: &#39;1&#39;,</span>
<span class="go">    &#39;epoch_path&#39;: &#39;/home/zhenlin4/.cache/pyhealth/datasets/832afe6e6e8a5c9ea5505b47e7af8125/10-1/1/0.pkl&#39;,</span>
<span class="go">    &#39;label&#39;: 1</span>
<span class="go">}</span>
</pre></div>
</div>
</dd></dl>

</section>
<span id="document-api/tasks/pyhealth.tasks.EEG_events"></span><section id="module-pyhealth.tasks.EEG_events">
<span id="pyhealth-tasks-eeg-events"></span><h4>pyhealth.tasks.EEG_events<a class="headerlink" href="#module-pyhealth.tasks.EEG_events" title="Permalink to this heading">#</a></h4>
<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.EEG_events.EEG_events_fn">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.EEG_events.</span></span><span class="sig-name descname"><span class="pre">EEG_events_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.EEG_events.EEG_events_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Processes a single patient for the EEG events task on TUEV.</p>
<p>This task aims at annotating of EEG segments as one of six classes: (1) spike and sharp wave (SPSW), (2) generalized periodic epileptiform discharges (GPED), (3) periodic lateralized epileptiform discharges (PLED), (4) eye movement (EYEM), (5) artifact (ARTF) and (6) background (BCKG).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>record</strong> â€“ <p>a singleton list of one subject from the TUEVDataset.
The (single) record is a dictionary with the following keys:</p>
<blockquote>
<div><p>load_from_path, patient_id, visit_id, signal_file, label_file, save_to_path</p>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a list of samples, each sample is a dict with patient_id, visit_id, record_id, label, offending_channel,</dt><dd><p>and epoch_path (the path to the saved epoch {â€œsignalâ€: signal, â€œlabelâ€: label} as key.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>samples</p>
</dd>
</dl>
<p>Note that we define the task as a multiclass classification task.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">TUEVDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EEGevents</span> <span class="o">=</span> <span class="n">TUEVDataset</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">root</span><span class="o">=</span><span class="s2">&quot;/srv/local/data/TUH/tuh_eeg_events/v2.0.0/edf/&quot;</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">EEG_events_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EEG_events_ds</span> <span class="o">=</span> <span class="n">EEGevents</span><span class="o">.</span><span class="n">set_task</span><span class="p">(</span><span class="n">EEG_events_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EEG_events_ds</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">{</span>
<span class="go">    &#39;patient_id&#39;: &#39;0_00002265&#39;,</span>
<span class="go">    &#39;visit_id&#39;: &#39;00000001&#39;,</span>
<span class="go">    &#39;record_id&#39;: 0,</span>
<span class="go">    &#39;epoch_path&#39;: &#39;/Users/liyanjing/.cache/pyhealth/datasets/d8f3cb92cc444d481444d3414fb5240c/0_00002265_00000001_0.pkl&#39;,</span>
<span class="go">    &#39;label&#39;: 6,</span>
<span class="go">    &#39;offending_channel&#39;: array([4.])</span>
<span class="go">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.EEG_events.BuildEvents">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.EEG_events.</span></span><span class="sig-name descname"><span class="pre">BuildEvents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EventData</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.EEG_events.BuildEvents" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.EEG_events.convert_signals">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.EEG_events.</span></span><span class="sig-name descname"><span class="pre">convert_signals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rawdata</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.EEG_events.convert_signals" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.EEG_events.readEDF">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.EEG_events.</span></span><span class="sig-name descname"><span class="pre">readEDF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fileName</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.EEG_events.readEDF" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</section>
<span id="document-api/tasks/pyhealth.tasks.length_of_stay_prediction"></span><section id="module-pyhealth.tasks.length_of_stay_prediction">
<span id="pyhealth-tasks-length-of-stay-prediction"></span><h4>pyhealth.tasks.length_of_stay_prediction<a class="headerlink" href="#module-pyhealth.tasks.length_of_stay_prediction" title="Permalink to this heading">#</a></h4>
<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.length_of_stay_prediction.categorize_los">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.length_of_stay_prediction.</span></span><span class="sig-name descname"><span class="pre">categorize_los</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">days</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.length_of_stay_prediction.categorize_los" title="Permalink to this definition">#</a></dt>
<dd><p>Categorizes length of stay into 10 categories.</p>
<p>One for ICU stays shorter than a day, seven day-long categories for each day of
the first week, one for stays of over one week but less than two,
and one for stays of over two weeks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>days</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) â€“ int, length of stay in days</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>int, category of length of stay</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>category</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.length_of_stay_prediction.length_of_stay_prediction_mimic3_fn">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.length_of_stay_prediction.</span></span><span class="sig-name descname"><span class="pre">length_of_stay_prediction_mimic3_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patient</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.length_of_stay_prediction.length_of_stay_prediction_mimic3_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Processes a single patient for the length-of-stay prediction task.</p>
<p>Length of stay prediction aims at predicting the length of stay (in days) of the
current hospital visit based on the clinical information from the visit
(e.g., conditions and procedures).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>patient</strong> (<a class="reference internal" href="index.html#pyhealth.data.Patient" title="pyhealth.data.data.Patient"><code class="xref py py-class docutils literal notranslate"><span class="pre">Patient</span></code></a>) â€“ a Patient object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a list of samples, each sample is a dict with patient_id, visit_id,</dt><dd><p>and other task-specific attributes as key.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>samples</p>
</dd>
</dl>
<p>Note that we define the task as a multi-class classification task.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">MIMIC3Dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mimic3_base</span> <span class="o">=</span> <span class="n">MIMIC3Dataset</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">root</span><span class="o">=</span><span class="s2">&quot;/srv/local/data/physionet.org/files/mimiciii/1.4&quot;</span><span class="p">,</span>
<span class="gp">... </span>   <span class="n">tables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;DIAGNOSES_ICD&quot;</span><span class="p">,</span> <span class="s2">&quot;PROCEDURES_ICD&quot;</span><span class="p">,</span> <span class="s2">&quot;PRESCRIPTIONS&quot;</span><span class="p">],</span>
<span class="gp">... </span>   <span class="n">code_mapping</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;ICD9CM&quot;</span><span class="p">:</span> <span class="s2">&quot;CCSCM&quot;</span><span class="p">},</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">length_of_stay_prediction_mimic3_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mimic3_sample</span> <span class="o">=</span> <span class="n">mimic3_base</span><span class="o">.</span><span class="n">set_task</span><span class="p">(</span><span class="n">length_of_stay_prediction_mimic3_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mimic3_sample</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">[{&#39;visit_id&#39;: &#39;130744&#39;, &#39;patient_id&#39;: &#39;103&#39;, &#39;conditions&#39;: [[&#39;42&#39;, &#39;109&#39;, &#39;19&#39;, &#39;122&#39;, &#39;98&#39;, &#39;663&#39;, &#39;58&#39;, &#39;51&#39;]], &#39;procedures&#39;: [[&#39;1&#39;]], &#39;label&#39;: 4}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.length_of_stay_prediction.length_of_stay_prediction_mimic4_fn">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.length_of_stay_prediction.</span></span><span class="sig-name descname"><span class="pre">length_of_stay_prediction_mimic4_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patient</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.length_of_stay_prediction.length_of_stay_prediction_mimic4_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Processes a single patient for the length-of-stay prediction task.</p>
<p>Length of stay prediction aims at predicting the length of stay (in days) of the
current hospital visit based on the clinical information from the visit
(e.g., conditions and procedures).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>patient</strong> (<a class="reference internal" href="index.html#pyhealth.data.Patient" title="pyhealth.data.data.Patient"><code class="xref py py-class docutils literal notranslate"><span class="pre">Patient</span></code></a>) â€“ a Patient object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a list of samples, each sample is a dict with patient_id, visit_id,</dt><dd><p>and other task-specific attributes as key.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>samples</p>
</dd>
</dl>
<p>Note that we define the task as a multi-class classification task.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">MIMIC4Dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mimic4_base</span> <span class="o">=</span> <span class="n">MIMIC4Dataset</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">root</span><span class="o">=</span><span class="s2">&quot;/srv/local/data/physionet.org/files/mimiciv/2.0/hosp&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">tables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;diagnoses_icd&quot;</span><span class="p">,</span> <span class="s2">&quot;procedures_icd&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">code_mapping</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;ICD10PROC&quot;</span><span class="p">:</span> <span class="s2">&quot;CCSPROC&quot;</span><span class="p">},</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">length_of_stay_prediction_mimic4_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mimic4_sample</span> <span class="o">=</span> <span class="n">mimic4_base</span><span class="o">.</span><span class="n">set_task</span><span class="p">(</span><span class="n">length_of_stay_prediction_mimic4_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mimic4_sample</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">[{&#39;visit_id&#39;: &#39;130744&#39;, &#39;patient_id&#39;: &#39;103&#39;, &#39;conditions&#39;: [[&#39;42&#39;, &#39;109&#39;, &#39;19&#39;, &#39;122&#39;, &#39;98&#39;, &#39;663&#39;, &#39;58&#39;, &#39;51&#39;]], &#39;procedures&#39;: [[&#39;1&#39;]], &#39;label&#39;: 2}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.length_of_stay_prediction.length_of_stay_prediction_eicu_fn">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.length_of_stay_prediction.</span></span><span class="sig-name descname"><span class="pre">length_of_stay_prediction_eicu_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patient</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.length_of_stay_prediction.length_of_stay_prediction_eicu_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Processes a single patient for the length-of-stay prediction task.</p>
<p>Length of stay prediction aims at predicting the length of stay (in days) of the
current hospital visit based on the clinical information from the visit
(e.g., conditions and procedures).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>patient</strong> (<a class="reference internal" href="index.html#pyhealth.data.Patient" title="pyhealth.data.data.Patient"><code class="xref py py-class docutils literal notranslate"><span class="pre">Patient</span></code></a>) â€“ a Patient object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a list of samples, each sample is a dict with patient_id, visit_id,</dt><dd><p>and other task-specific attributes as key.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>samples</p>
</dd>
</dl>
<p>Note that we define the task as a multi-class classification task.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">eICUDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eicu_base</span> <span class="o">=</span> <span class="n">eICUDataset</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">root</span><span class="o">=</span><span class="s2">&quot;/srv/local/data/physionet.org/files/eicu-crd/2.0&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">tables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;diagnosis&quot;</span><span class="p">,</span> <span class="s2">&quot;medication&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">code_mapping</span><span class="o">=</span><span class="p">{},</span>
<span class="gp">... </span>    <span class="n">dev</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">length_of_stay_prediction_eicu_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eicu_sample</span> <span class="o">=</span> <span class="n">eicu_base</span><span class="o">.</span><span class="n">set_task</span><span class="p">(</span><span class="n">length_of_stay_prediction_eicu_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eicu_sample</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">[{&#39;visit_id&#39;: &#39;130744&#39;, &#39;patient_id&#39;: &#39;103&#39;, &#39;conditions&#39;: [[&#39;42&#39;, &#39;109&#39;, &#39;98&#39;, &#39;663&#39;, &#39;58&#39;, &#39;51&#39;]], &#39;procedures&#39;: [[&#39;1&#39;]], &#39;label&#39;: 5}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.length_of_stay_prediction.length_of_stay_prediction_omop_fn">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.length_of_stay_prediction.</span></span><span class="sig-name descname"><span class="pre">length_of_stay_prediction_omop_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patient</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.length_of_stay_prediction.length_of_stay_prediction_omop_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Processes a single patient for the length-of-stay prediction task.</p>
<p>Length of stay prediction aims at predicting the length of stay (in days) of the
current hospital visit based on the clinical information from the visit
(e.g., conditions and procedures).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>patient</strong> (<a class="reference internal" href="index.html#pyhealth.data.Patient" title="pyhealth.data.data.Patient"><code class="xref py py-class docutils literal notranslate"><span class="pre">Patient</span></code></a>) â€“ a Patient object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a list of samples, each sample is a dict with patient_id, visit_id,</dt><dd><p>and other task-specific attributes as key.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>samples</p>
</dd>
</dl>
<p>Note that we define the task as a multi-class classification task.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">OMOPDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">omop_base</span> <span class="o">=</span> <span class="n">OMOPDataset</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">root</span><span class="o">=</span><span class="s2">&quot;https://storage.googleapis.com/pyhealth/synpuf1k_omop_cdm_5.2.2&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">tables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;condition_occurrence&quot;</span><span class="p">,</span> <span class="s2">&quot;procedure_occurrence&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">code_mapping</span><span class="o">=</span><span class="p">{},</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">length_of_stay_prediction_omop_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">omop_sample</span> <span class="o">=</span> <span class="n">omop_base</span><span class="o">.</span><span class="n">set_task</span><span class="p">(</span><span class="n">length_of_stay_prediction_eicu_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">omop_sample</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">[{&#39;visit_id&#39;: &#39;130744&#39;, &#39;patient_id&#39;: &#39;103&#39;, &#39;conditions&#39;: [[&#39;42&#39;, &#39;109&#39;, &#39;98&#39;, &#39;663&#39;, &#39;58&#39;, &#39;51&#39;]], &#39;procedures&#39;: [[&#39;1&#39;]], &#39;label&#39;: 7}]</span>
</pre></div>
</div>
</dd></dl>

</section>
<span id="document-api/tasks/pyhealth.tasks.MedicalTranscriptionsClassification"></span><section id="pyhealth-tasks-medicaltranscriptionsclassification">
<h4>pyhealth.tasks.MedicalTranscriptionsClassification<a class="headerlink" href="#pyhealth-tasks-medicaltranscriptionsclassification" title="Permalink to this heading">#</a></h4>
<span class="target" id="module-pyhealth.tasks.MedicalTranscriptionsClassification"></span><p>Task for classifying medical transcriptions into medical specialties.</p>
<p>This task takes medical transcription text as input and predicts the
corresponding medical specialty. It processes patient records containing
mtsamples events and extracts transcription and medical specialty
information.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyhealth.tasks.MedicalTranscriptionsClassification.task_name">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.MedicalTranscriptionsClassification.</span></span><span class="sig-name descname"><span class="pre">task_name</span></span><a class="headerlink" href="#pyhealth.tasks.MedicalTranscriptionsClassification.task_name" title="Permalink to this definition">#</a></dt>
<dd><p>Name of the task</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyhealth.tasks.MedicalTranscriptionsClassification.input_schema">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.MedicalTranscriptionsClassification.</span></span><span class="sig-name descname"><span class="pre">input_schema</span></span><a class="headerlink" href="#pyhealth.tasks.MedicalTranscriptionsClassification.input_schema" title="Permalink to this definition">#</a></dt>
<dd><p>Schema defining input features</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyhealth.tasks.MedicalTranscriptionsClassification.output_schema">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.MedicalTranscriptionsClassification.</span></span><span class="sig-name descname"><span class="pre">output_schema</span></span><a class="headerlink" href="#pyhealth.tasks.MedicalTranscriptionsClassification.output_schema" title="Permalink to this definition">#</a></dt>
<dd><p>Schema defining output features</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>]</p>
</dd>
</dl>
</dd></dl>

</section>
<span id="document-api/tasks/pyhealth.tasks.mortality_prediction"></span><section id="module-pyhealth.tasks.mortality_prediction">
<span id="pyhealth-tasks-mortality-prediction"></span><h4>pyhealth.tasks.mortality_prediction<a class="headerlink" href="#module-pyhealth.tasks.mortality_prediction" title="Permalink to this heading">#</a></h4>
<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.mortality_prediction.mortality_prediction_mimic3_fn">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.mortality_prediction.</span></span><span class="sig-name descname"><span class="pre">mortality_prediction_mimic3_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patient</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.mortality_prediction.mortality_prediction_mimic3_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Processes a single patient for the mortality prediction task.</p>
<p>Mortality prediction aims at predicting whether the patient will decease in the
next hospital visit based on the clinical information from current visit
(e.g., conditions and procedures).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>patient</strong> (<a class="reference internal" href="index.html#pyhealth.data.Patient" title="pyhealth.data.data.Patient"><code class="xref py py-class docutils literal notranslate"><span class="pre">Patient</span></code></a>) â€“ a Patient object</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a list of samples, each sample is a dict with patient_id,</dt><dd><p>visit_id, and other task-specific attributes as key</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>samples</p>
</dd>
</dl>
<p>Note that we define the task as a binary classification task.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">MIMIC3Dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mimic3_base</span> <span class="o">=</span> <span class="n">MIMIC3Dataset</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">root</span><span class="o">=</span><span class="s2">&quot;/srv/local/data/physionet.org/files/mimiciii/1.4&quot;</span><span class="p">,</span>
<span class="gp">... </span>   <span class="n">tables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;DIAGNOSES_ICD&quot;</span><span class="p">,</span> <span class="s2">&quot;PROCEDURES_ICD&quot;</span><span class="p">,</span> <span class="s2">&quot;PRESCRIPTIONS&quot;</span><span class="p">],</span>
<span class="gp">... </span>   <span class="n">code_mapping</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;ICD9CM&quot;</span><span class="p">:</span> <span class="s2">&quot;CCSCM&quot;</span><span class="p">},</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">mortality_prediction_mimic3_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mimic3_sample</span> <span class="o">=</span> <span class="n">mimic3_base</span><span class="o">.</span><span class="n">set_task</span><span class="p">(</span><span class="n">mortality_prediction_mimic3_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mimic3_sample</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">[{&#39;visit_id&#39;: &#39;130744&#39;, &#39;patient_id&#39;: &#39;103&#39;, &#39;conditions&#39;: [[&#39;42&#39;, &#39;109&#39;, &#39;19&#39;, &#39;122&#39;, &#39;98&#39;, &#39;663&#39;, &#39;58&#39;, &#39;51&#39;]], &#39;procedures&#39;: [[&#39;1&#39;]], &#39;label&#39;: 0}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.mortality_prediction.mortality_prediction_mimic4_fn">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.mortality_prediction.</span></span><span class="sig-name descname"><span class="pre">mortality_prediction_mimic4_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patient</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.mortality_prediction.mortality_prediction_mimic4_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Processes a single patient for the mortality prediction task.</p>
<p>Mortality prediction aims at predicting whether the patient will decease in the
next hospital visit based on the clinical information from current visit
(e.g., conditions and procedures).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>patient</strong> (<a class="reference internal" href="index.html#pyhealth.data.Patient" title="pyhealth.data.data.Patient"><code class="xref py py-class docutils literal notranslate"><span class="pre">Patient</span></code></a>) â€“ a Patient object</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a list of samples, each sample is a dict with patient_id,</dt><dd><p>visit_id, and other task-specific attributes as key</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>samples</p>
</dd>
</dl>
<p>Note that we define the task as a binary classification task.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">MIMIC4Dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mimic4_base</span> <span class="o">=</span> <span class="n">MIMIC4Dataset</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">root</span><span class="o">=</span><span class="s2">&quot;/srv/local/data/physionet.org/files/mimiciv/2.0/hosp&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">tables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;diagnoses_icd&quot;</span><span class="p">,</span> <span class="s2">&quot;procedures_icd&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">code_mapping</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;ICD10PROC&quot;</span><span class="p">:</span> <span class="s2">&quot;CCSPROC&quot;</span><span class="p">},</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">mortality_prediction_mimic4_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mimic4_sample</span> <span class="o">=</span> <span class="n">mimic4_base</span><span class="o">.</span><span class="n">set_task</span><span class="p">(</span><span class="n">mortality_prediction_mimic4_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mimic4_sample</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">[{&#39;visit_id&#39;: &#39;130744&#39;, &#39;patient_id&#39;: &#39;103&#39;, &#39;conditions&#39;: [[&#39;42&#39;, &#39;109&#39;, &#39;19&#39;, &#39;122&#39;, &#39;98&#39;, &#39;663&#39;, &#39;58&#39;, &#39;51&#39;]], &#39;procedures&#39;: [[&#39;1&#39;]], &#39;label&#39;: 1}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.mortality_prediction.mortality_prediction_eicu_fn">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.mortality_prediction.</span></span><span class="sig-name descname"><span class="pre">mortality_prediction_eicu_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patient</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.mortality_prediction.mortality_prediction_eicu_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Processes a single patient for the mortality prediction task.</p>
<p>Mortality prediction aims at predicting whether the patient will decease in the
next hospital visit based on the clinical information from current visit
(e.g., conditions and procedures).</p>
<p>Features key-value pairs:
- using diagnosis table (ICD9CM and ICD10CM) as condition codes
- using physicalExam table as procedure codes
- using medication table as drugs codes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>patient</strong> (<a class="reference internal" href="index.html#pyhealth.data.Patient" title="pyhealth.data.data.Patient"><code class="xref py py-class docutils literal notranslate"><span class="pre">Patient</span></code></a>) â€“ a Patient object</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a list of samples, each sample is a dict with patient_id,</dt><dd><p>visit_id, and other task-specific attributes as key</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>samples</p>
</dd>
</dl>
<p>Note that we define the task as a binary classification task.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">eICUDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eicu_base</span> <span class="o">=</span> <span class="n">eICUDataset</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">root</span><span class="o">=</span><span class="s2">&quot;/srv/local/data/physionet.org/files/eicu-crd/2.0&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">tables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;diagnosis&quot;</span><span class="p">,</span> <span class="s2">&quot;medication&quot;</span><span class="p">,</span> <span class="s2">&quot;physicalExam&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">code_mapping</span><span class="o">=</span><span class="p">{},</span>
<span class="gp">... </span>    <span class="n">dev</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">mortality_prediction_eicu_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eicu_sample</span> <span class="o">=</span> <span class="n">eicu_base</span><span class="o">.</span><span class="n">set_task</span><span class="p">(</span><span class="n">mortality_prediction_eicu_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eicu_sample</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">[{&#39;visit_id&#39;: &#39;130744&#39;, &#39;patient_id&#39;: &#39;103&#39;, &#39;conditions&#39;: [[&#39;42&#39;, &#39;109&#39;, &#39;98&#39;, &#39;663&#39;, &#39;58&#39;, &#39;51&#39;]], &#39;procedures&#39;: [[&#39;1&#39;]], &#39;label&#39;: 0}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.mortality_prediction.mortality_prediction_eicu_fn2">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.mortality_prediction.</span></span><span class="sig-name descname"><span class="pre">mortality_prediction_eicu_fn2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patient</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.mortality_prediction.mortality_prediction_eicu_fn2" title="Permalink to this definition">#</a></dt>
<dd><p>Processes a single patient for the mortality prediction task.</p>
<p>Mortality prediction aims at predicting whether the patient will decease in the
next hospital visit based on the clinical information from current visit
(e.g., conditions and procedures).</p>
<p>Similar to mortality_prediction_eicu_fn, but with different code mapping:
- using admissionDx table and diagnosisString under diagnosis table as condition codes
- using treatment table as procedure codes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>patient</strong> (<a class="reference internal" href="index.html#pyhealth.data.Patient" title="pyhealth.data.data.Patient"><code class="xref py py-class docutils literal notranslate"><span class="pre">Patient</span></code></a>) â€“ a Patient object</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a list of samples, each sample is a dict with patient_id,</dt><dd><p>visit_id, and other task-specific attributes as key</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>samples</p>
</dd>
</dl>
<p>Note that we define the task as a binary classification task.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">eICUDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eicu_base</span> <span class="o">=</span> <span class="n">eICUDataset</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">root</span><span class="o">=</span><span class="s2">&quot;/srv/local/data/physionet.org/files/eicu-crd/2.0&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">tables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;diagnosis&quot;</span><span class="p">,</span> <span class="s2">&quot;admissionDx&quot;</span><span class="p">,</span> <span class="s2">&quot;treatment&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">code_mapping</span><span class="o">=</span><span class="p">{},</span>
<span class="gp">... </span>    <span class="n">dev</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">mortality_prediction_eicu_fn2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eicu_sample</span> <span class="o">=</span> <span class="n">eicu_base</span><span class="o">.</span><span class="n">set_task</span><span class="p">(</span><span class="n">mortality_prediction_eicu_fn2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eicu_sample</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">{&#39;visit_id&#39;: &#39;130744&#39;, &#39;patient_id&#39;: &#39;103&#39;, &#39;conditions&#39;: [[&#39;42&#39;, &#39;109&#39;, &#39;98&#39;, &#39;663&#39;, &#39;58&#39;, &#39;51&#39;]], &#39;procedures&#39;: [[&#39;1&#39;]], &#39;label&#39;: 0}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.mortality_prediction.mortality_prediction_omop_fn">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.mortality_prediction.</span></span><span class="sig-name descname"><span class="pre">mortality_prediction_omop_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patient</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.mortality_prediction.mortality_prediction_omop_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Processes a single patient for the mortality prediction task.</p>
<p>Mortality prediction aims at predicting whether the patient will decease in the
next hospital visit based on the clinical information from current visit
(e.g., conditions and procedures).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>patient</strong> (<a class="reference internal" href="index.html#pyhealth.data.Patient" title="pyhealth.data.data.Patient"><code class="xref py py-class docutils literal notranslate"><span class="pre">Patient</span></code></a>) â€“ a Patient object</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a list of samples, each sample is a dict with patient_id,</dt><dd><p>visit_id, and other task-specific attributes as key</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>samples</p>
</dd>
</dl>
<p>Note that we define the task as a binary classification task.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">OMOPDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">omop_base</span> <span class="o">=</span> <span class="n">OMOPDataset</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">root</span><span class="o">=</span><span class="s2">&quot;https://storage.googleapis.com/pyhealth/synpuf1k_omop_cdm_5.2.2&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">tables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;condition_occurrence&quot;</span><span class="p">,</span> <span class="s2">&quot;procedure_occurrence&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">code_mapping</span><span class="o">=</span><span class="p">{},</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">mortality_prediction_omop_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">omop_sample</span> <span class="o">=</span> <span class="n">omop_base</span><span class="o">.</span><span class="n">set_task</span><span class="p">(</span><span class="n">mortality_prediction_eicu_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">omop_sample</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">[{&#39;visit_id&#39;: &#39;130744&#39;, &#39;patient_id&#39;: &#39;103&#39;, &#39;conditions&#39;: [[&#39;42&#39;, &#39;109&#39;, &#39;98&#39;, &#39;663&#39;, &#39;58&#39;, &#39;51&#39;]], &#39;procedures&#39;: [[&#39;1&#39;]], &#39;label&#39;: 1}]</span>
</pre></div>
</div>
</dd></dl>

</section>
<span id="document-api/tasks/pyhealth.tasks.patient_linkage_mimic3_fn"></span><section id="module-pyhealth.tasks.patient_linkage_mimic3_fn-patient">
<span id="pyhealth-tasks-patient-linkage-mimic3-fn"></span><h4>pyhealth.tasks.patient_linkage_mimic3_fn<a class="headerlink" href="#module-pyhealth.tasks.patient_linkage_mimic3_fn-patient" title="Permalink to this heading">#</a></h4>
<p>Patient linkage task for the mimic3 dataset.</p>
</section>
<span id="document-api/tasks/pyhealth.tasks.readmission_prediction"></span><section id="module-pyhealth.tasks.readmission_prediction">
<span id="pyhealth-tasks-readmission-prediction"></span><h4>pyhealth.tasks.readmission_prediction<a class="headerlink" href="#module-pyhealth.tasks.readmission_prediction" title="Permalink to this heading">#</a></h4>
<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.readmission_prediction.readmission_prediction_mimic3_fn">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.readmission_prediction.</span></span><span class="sig-name descname"><span class="pre">readmission_prediction_mimic3_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patient</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.readmission_prediction.readmission_prediction_mimic3_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Processes a single patient for the readmission prediction task.</p>
<p>Readmission prediction aims at predicting whether the patient will be readmitted
into hospital within time_window days based on the clinical information from
current visit (e.g., conditions and procedures).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patient</strong> (<a class="reference internal" href="index.html#pyhealth.data.Patient" title="pyhealth.data.data.Patient"><code class="xref py py-class docutils literal notranslate"><span class="pre">Patient</span></code></a>) â€“ a Patient object</p></li>
<li><p><strong>time_window</strong> â€“ the time window threshold (gap &lt; time_window means label=1 for
the task)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a list of samples, each sample is a dict with patient_id, visit_id,</dt><dd><p>and other task-specific attributes as key</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>samples</p>
</dd>
</dl>
<p>Note that we define the task as a binary classification task.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">MIMIC3Dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mimic3_base</span> <span class="o">=</span> <span class="n">MIMIC3Dataset</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">root</span><span class="o">=</span><span class="s2">&quot;/srv/local/data/physionet.org/files/mimiciii/1.4&quot;</span><span class="p">,</span>
<span class="gp">... </span>   <span class="n">tables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;DIAGNOSES_ICD&quot;</span><span class="p">,</span> <span class="s2">&quot;PROCEDURES_ICD&quot;</span><span class="p">,</span> <span class="s2">&quot;PRESCRIPTIONS&quot;</span><span class="p">],</span>
<span class="gp">... </span>   <span class="n">code_mapping</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;ICD9CM&quot;</span><span class="p">:</span> <span class="s2">&quot;CCSCM&quot;</span><span class="p">},</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">readmission_prediction_mimic3_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mimic3_sample</span> <span class="o">=</span> <span class="n">mimic3_base</span><span class="o">.</span><span class="n">set_task</span><span class="p">(</span><span class="n">readmission_prediction_mimic3_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mimic3_sample</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">[{&#39;visit_id&#39;: &#39;130744&#39;, &#39;patient_id&#39;: &#39;103&#39;, &#39;conditions&#39;: [[&#39;42&#39;, &#39;109&#39;, &#39;19&#39;, &#39;122&#39;, &#39;98&#39;, &#39;663&#39;, &#39;58&#39;, &#39;51&#39;]], &#39;procedures&#39;: [[&#39;1&#39;]], &#39;label&#39;: 1}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.readmission_prediction.readmission_prediction_mimic4_fn">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.readmission_prediction.</span></span><span class="sig-name descname"><span class="pre">readmission_prediction_mimic4_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patient</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.readmission_prediction.readmission_prediction_mimic4_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Processes a single patient for the readmission prediction task.</p>
<p>Readmission prediction aims at predicting whether the patient will be readmitted
into hospital within time_window days based on the clinical information from
current visit (e.g., conditions and procedures).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patient</strong> (<a class="reference internal" href="index.html#pyhealth.data.Patient" title="pyhealth.data.data.Patient"><code class="xref py py-class docutils literal notranslate"><span class="pre">Patient</span></code></a>) â€“ a Patient object</p></li>
<li><p><strong>time_window</strong> â€“ the time window threshold (gap &lt; time_window means label=1 for
the task)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a list of samples, each sample is a dict with patient_id, visit_id,</dt><dd><p>and other task-specific attributes as key</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>samples</p>
</dd>
</dl>
<p>Note that we define the task as a binary classification task.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">MIMIC4Dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mimic4_base</span> <span class="o">=</span> <span class="n">MIMIC4Dataset</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">root</span><span class="o">=</span><span class="s2">&quot;/srv/local/data/physionet.org/files/mimiciv/2.0/hosp&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">tables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;diagnoses_icd&quot;</span><span class="p">,</span> <span class="s2">&quot;procedures_icd&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">code_mapping</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;ICD10PROC&quot;</span><span class="p">:</span> <span class="s2">&quot;CCSPROC&quot;</span><span class="p">},</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">readmission_prediction_mimic4_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mimic4_sample</span> <span class="o">=</span> <span class="n">mimic4_base</span><span class="o">.</span><span class="n">set_task</span><span class="p">(</span><span class="n">readmission_prediction_mimic4_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mimic4_sample</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">[{&#39;visit_id&#39;: &#39;130744&#39;, &#39;patient_id&#39;: &#39;103&#39;, &#39;conditions&#39;: [[&#39;42&#39;, &#39;109&#39;, &#39;19&#39;, &#39;122&#39;, &#39;98&#39;, &#39;663&#39;, &#39;58&#39;, &#39;51&#39;]], &#39;procedures&#39;: [[&#39;1&#39;]], &#39;label&#39;: 0}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.readmission_prediction.readmission_prediction_eicu_fn">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.readmission_prediction.</span></span><span class="sig-name descname"><span class="pre">readmission_prediction_eicu_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patient</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.readmission_prediction.readmission_prediction_eicu_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Processes a single patient for the readmission prediction task.</p>
<p>Readmission prediction aims at predicting whether the patient will be readmitted
into hospital within time_window days based on the clinical information from
current visit (e.g., conditions and procedures).</p>
<p>Features key-value pairs:
- using diagnosis table (ICD9CM and ICD10CM) as condition codes
- using physicalExam table as procedure codes
- using medication table as drugs codes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patient</strong> (<a class="reference internal" href="index.html#pyhealth.data.Patient" title="pyhealth.data.data.Patient"><code class="xref py py-class docutils literal notranslate"><span class="pre">Patient</span></code></a>) â€“ a Patient object</p></li>
<li><p><strong>time_window</strong> â€“ the time window threshold (gap &lt; time_window means label=1 for
the task)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a list of samples, each sample is a dict with patient_id, visit_id,</dt><dd><p>and other task-specific attributes as key</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>samples</p>
</dd>
</dl>
<p>Note that we define the task as a binary classification task.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">eICUDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eicu_base</span> <span class="o">=</span> <span class="n">eICUDataset</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">root</span><span class="o">=</span><span class="s2">&quot;/srv/local/data/physionet.org/files/eicu-crd/2.0&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">tables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;diagnosis&quot;</span><span class="p">,</span> <span class="s2">&quot;medication&quot;</span><span class="p">,</span> <span class="s2">&quot;physicalExam&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">code_mapping</span><span class="o">=</span><span class="p">{},</span>
<span class="gp">... </span>    <span class="n">dev</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">readmission_prediction_eicu_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eicu_sample</span> <span class="o">=</span> <span class="n">eicu_base</span><span class="o">.</span><span class="n">set_task</span><span class="p">(</span><span class="n">readmission_prediction_eicu_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eicu_sample</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">[{&#39;visit_id&#39;: &#39;130744&#39;, &#39;patient_id&#39;: &#39;103&#39;, &#39;conditions&#39;: [[&#39;42&#39;, &#39;109&#39;, &#39;98&#39;, &#39;663&#39;, &#39;58&#39;, &#39;51&#39;]], &#39;procedures&#39;: [[&#39;1&#39;]], &#39;label&#39;: 1}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.readmission_prediction.readmission_prediction_eicu_fn2">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.readmission_prediction.</span></span><span class="sig-name descname"><span class="pre">readmission_prediction_eicu_fn2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patient</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.readmission_prediction.readmission_prediction_eicu_fn2" title="Permalink to this definition">#</a></dt>
<dd><p>Processes a single patient for the readmission prediction task.</p>
<p>Readmission prediction aims at predicting whether the patient will be readmitted
into hospital within time_window days based on the clinical information from
current visit (e.g., conditions and procedures).</p>
<p>Similar to readmission_prediction_eicu_fn, but with different code mapping:
- using admissionDx table and diagnosisString under diagnosis table as condition codes
- using treatment table as procedure codes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patient</strong> (<a class="reference internal" href="index.html#pyhealth.data.Patient" title="pyhealth.data.data.Patient"><code class="xref py py-class docutils literal notranslate"><span class="pre">Patient</span></code></a>) â€“ a Patient object</p></li>
<li><p><strong>time_window</strong> â€“ the time window threshold (gap &lt; time_window means label=1 for
the task)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a list of samples, each sample is a dict with patient_id, visit_id,</dt><dd><p>and other task-specific attributes as key</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>samples</p>
</dd>
</dl>
<p>Note that we define the task as a binary classification task.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">eICUDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eicu_base</span> <span class="o">=</span> <span class="n">eICUDataset</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">root</span><span class="o">=</span><span class="s2">&quot;/srv/local/data/physionet.org/files/eicu-crd/2.0&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">tables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;diagnosis&quot;</span><span class="p">,</span> <span class="s2">&quot;treatment&quot;</span><span class="p">,</span> <span class="s2">&quot;admissionDx&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">code_mapping</span><span class="o">=</span><span class="p">{},</span>
<span class="gp">... </span>    <span class="n">dev</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">readmission_prediction_eicu_fn2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eicu_sample</span> <span class="o">=</span> <span class="n">eicu_base</span><span class="o">.</span><span class="n">set_task</span><span class="p">(</span><span class="n">readmission_prediction_eicu_fn2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eicu_sample</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">[{&#39;visit_id&#39;: &#39;130744&#39;, &#39;patient_id&#39;: &#39;103&#39;, &#39;conditions&#39;: [[&#39;42&#39;, &#39;109&#39;, &#39;98&#39;, &#39;663&#39;, &#39;58&#39;, &#39;51&#39;]], &#39;procedures&#39;: [[&#39;1&#39;]], &#39;label&#39;: 1}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.readmission_prediction.readmission_prediction_omop_fn">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.readmission_prediction.</span></span><span class="sig-name descname"><span class="pre">readmission_prediction_omop_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patient</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.readmission_prediction.readmission_prediction_omop_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Processes a single patient for the readmission prediction task.</p>
<p>Readmission prediction aims at predicting whether the patient will be readmitted
into hospital within time_window days based on the clinical information from
current visit (e.g., conditions and procedures).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patient</strong> (<a class="reference internal" href="index.html#pyhealth.data.Patient" title="pyhealth.data.data.Patient"><code class="xref py py-class docutils literal notranslate"><span class="pre">Patient</span></code></a>) â€“ a Patient object</p></li>
<li><p><strong>time_window</strong> â€“ the time window threshold (gap &lt; time_window means label=1 for
the task)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a list of samples, each sample is a dict with patient_id, visit_id,</dt><dd><p>and other task-specific attributes as key</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>samples</p>
</dd>
</dl>
<p>Note that we define the task as a binary classification task.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">OMOPDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">omop_base</span> <span class="o">=</span> <span class="n">OMOPDataset</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">root</span><span class="o">=</span><span class="s2">&quot;https://storage.googleapis.com/pyhealth/synpuf1k_omop_cdm_5.2.2&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">tables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;condition_occurrence&quot;</span><span class="p">,</span> <span class="s2">&quot;procedure_occurrence&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">code_mapping</span><span class="o">=</span><span class="p">{},</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">readmission_prediction_omop_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">omop_sample</span> <span class="o">=</span> <span class="n">omop_base</span><span class="o">.</span><span class="n">set_task</span><span class="p">(</span><span class="n">readmission_prediction_eicu_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">omop_sample</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">[{&#39;visit_id&#39;: &#39;130744&#39;, &#39;patient_id&#39;: &#39;103&#39;, &#39;conditions&#39;: [[&#39;42&#39;, &#39;109&#39;, &#39;98&#39;, &#39;663&#39;, &#39;58&#39;, &#39;51&#39;]], &#39;procedures&#39;: [[&#39;1&#39;]], &#39;label&#39;: 1}]</span>
</pre></div>
</div>
</dd></dl>

</section>
<span id="document-api/tasks/pyhealth.tasks.sleep_staging"></span><section id="module-pyhealth.tasks.sleep_staging">
<span id="pyhealth-tasks-sleep-staging"></span><h4>pyhealth.tasks.sleep_staging<a class="headerlink" href="#module-pyhealth.tasks.sleep_staging" title="Permalink to this heading">#</a></h4>
<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.sleep_staging.sleep_staging_isruc_fn">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.sleep_staging.</span></span><span class="sig-name descname"><span class="pre">sleep_staging_isruc_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch_seconds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.sleep_staging.sleep_staging_isruc_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Processes a single patient for the sleep staging task on ISRUC.</p>
<p>Sleep staging aims at predicting the sleep stages (Awake, N1, N2, N3, REM) based on
the multichannel EEG signals. The task is defined as a multi-class classification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>record</strong> â€“ <p>a singleton list of one subject from the ISRUCDataset.
The (single) record is a dictionary with the following keys:</p>
<blockquote>
<div><p>load_from_path, signal_file, label1_file, label2_file, save_to_path, subject_id</p>
</div></blockquote>
</p></li>
<li><p><strong>epoch_seconds</strong> â€“ how long will each epoch be (in seconds).
It has to be a factor of 30 because the original data was labeled every 30 seconds.</p></li>
<li><p><strong>label_id</strong> â€“ which set of labels to use. ISURC is labeled by <em>two</em> experts.
By default we use the first set of labels (label_id=1).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a list of samples, each sample is a dict with patient_id, record_id,</dt><dd><p>and epoch_path (the path to the saved epoch {â€œXâ€: signal, â€œYâ€: label} as key.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>samples</p>
</dd>
</dl>
<p>Note that we define the task as a multi-class classification task.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">ISRUCDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">isruc</span> <span class="o">=</span> <span class="n">ISRUCDataset</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">root</span><span class="o">=</span><span class="s2">&quot;/srv/local/data/data/ISRUC-I&quot;</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">sleep_staging_isruc_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sleepstage_ds</span> <span class="o">=</span> <span class="n">isruc</span><span class="o">.</span><span class="n">set_task</span><span class="p">(</span><span class="n">sleep_staging_isruc_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sleepstage_ds</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">{</span>
<span class="go">    &#39;record_id&#39;: &#39;1-0&#39;,</span>
<span class="go">    &#39;patient_id&#39;: &#39;1&#39;,</span>
<span class="go">    &#39;epoch_path&#39;: &#39;/home/zhenlin4/.cache/pyhealth/datasets/832afe6e6e8a5c9ea5505b47e7af8125/10-1/1/0.pkl&#39;,</span>
<span class="go">    &#39;label&#39;: &#39;W&#39;</span>
<span class="go">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.sleep_staging.sleep_staging_sleepedf_fn">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.sleep_staging.</span></span><span class="sig-name descname"><span class="pre">sleep_staging_sleepedf_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch_seconds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.sleep_staging.sleep_staging_sleepedf_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Processes a single patient for the sleep staging task on Sleep EDF.</p>
<p>Sleep staging aims at predicting the sleep stages (Awake, REM, N1, N2, N3, N4) based on
the multichannel EEG signals. The task is defined as a multi-class classification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patient</strong> â€“ a list of (load_from_path, signal_file, label_file, save_to_path) tuples, where PSG is the signal files and the labels are</p></li>
<li><p><strong>file</strong> (<em>in label</em>) â€“ </p></li>
<li><p><strong>epoch_seconds</strong> â€“ how long will each epoch be (in seconds)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a list of samples, each sample is a dict with patient_id, record_id,</dt><dd><p>and epoch_path (the path to the saved epoch {â€œXâ€: signal, â€œYâ€: label} as key.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>samples</p>
</dd>
</dl>
<p>Note that we define the task as a multi-class classification task.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">SleepEDFDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sleepedf</span> <span class="o">=</span> <span class="n">SleepEDFDataset</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">root</span><span class="o">=</span><span class="s2">&quot;/srv/local/data/SLEEPEDF/sleep-edf-database-expanded-1.0.0/sleep-cassette&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">sleep_staging_sleepedf_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sleepstage_ds</span> <span class="o">=</span> <span class="n">sleepedf</span><span class="o">.</span><span class="n">set_task</span><span class="p">(</span><span class="n">sleep_staging_sleepedf_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sleepstage_ds</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">{</span>
<span class="go">    &#39;record_id&#39;: &#39;SC4001-0&#39;,</span>
<span class="go">    &#39;patient_id&#39;: &#39;SC4001&#39;,</span>
<span class="go">    &#39;epoch_path&#39;: &#39;/home/chaoqiy2/.cache/pyhealth/datasets/70d6dbb28bd81bab27ae2f271b2cbb0f/SC4001-0.pkl&#39;,</span>
<span class="go">    &#39;label&#39;: &#39;W&#39;</span>
<span class="go">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.sleep_staging.sleep_staging_shhs_fn">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.sleep_staging.</span></span><span class="sig-name descname"><span class="pre">sleep_staging_shhs_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch_seconds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.sleep_staging.sleep_staging_shhs_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Processes a single recording for the sleep staging task on SHHS.</p>
<p>Sleep staging aims at predicting the sleep stages (Awake, REM, N1, N2, N3) based on
the multichannel EEG signals. The task is defined as a multi-class classification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patient</strong> â€“ a list of (load_from_path, signal file, label file, save_to_path) tuples, where the signal is in edf file and</p></li>
<li><p><strong>file</strong> (<em>the labels are in the label</em>) â€“ </p></li>
<li><p><strong>epoch_seconds</strong> â€“ how long will each epoch be (in seconds), 30 seconds as default given by the label file</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a list of samples, each sample is a dict with patient_id, record_id,</dt><dd><p>and epoch_path (the path to the saved epoch {â€œXâ€: signal, â€œYâ€: label} as key.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>samples</p>
</dd>
</dl>
<p>Note that we define the task as a multi-class classification task.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">SHHSDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shhs</span> <span class="o">=</span> <span class="n">SHHSDataset</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">root</span><span class="o">=</span><span class="s2">&quot;/srv/local/data/SHHS/polysomnography&quot;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">dev</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">sleep_staging_shhs_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shhs_ds</span> <span class="o">=</span> <span class="n">shhs</span><span class="o">.</span><span class="n">set_task</span><span class="p">(</span><span class="n">sleep_staging_shhs_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shhs_ds</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">{</span>
<span class="go">    &#39;record_id&#39;: &#39;shhs1-200001-0&#39;,</span>
<span class="go">    &#39;patient_id&#39;: &#39;shhs1-200001&#39;,</span>
<span class="go">    &#39;epoch_path&#39;: &#39;/home/chaoqiy2/.cache/pyhealth/datasets/76c1ce8195a2e1a654e061cb5df4671a/shhs1-200001-0.pkl&#39;,</span>
<span class="go">    &#39;label&#39;: &#39;0&#39;</span>
<span class="go">}</span>
</pre></div>
</div>
</dd></dl>

</section>
<span id="document-api/tasks/pyhealth.tasks.SleepStagingSleepEDF"></span><section id="pyhealth-tasks-sleepstagingsleepedf">
<h4>pyhealth.tasks.SleepStagingSleepEDF<a class="headerlink" href="#pyhealth-tasks-sleepstagingsleepedf" title="Permalink to this heading">#</a></h4>
</section>
<span id="document-api/tasks/pyhealth.tasks.temple_university_EEG_tasks"></span><section id="pyhealth-tasks-temple-university-eeg-tasks">
<h4>pyhealth.tasks.temple_university_EEG_tasks<a class="headerlink" href="#pyhealth-tasks-temple-university-eeg-tasks" title="Permalink to this heading">#</a></h4>
<span class="target" id="module-pyhealth.tasks.temple_university_EEG_tasks"></span><dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.temple_university_EEG_tasks.EEG_isAbnormal_fn">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.temple_university_EEG_tasks.</span></span><span class="sig-name descname"><span class="pre">EEG_isAbnormal_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.temple_university_EEG_tasks.EEG_isAbnormal_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Processes a single patient for the abnormal EEG detection task on TUAB.</p>
<p>Abnormal EEG detection aims at determining whether a EEG is abnormal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>record</strong> â€“ <p>a singleton list of one subject from the TUABDataset.
The (single) record is a dictionary with the following keys:</p>
<blockquote>
<div><p>load_from_path, patient_id, visit_id, signal_file, label_file, save_to_path</p>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a list of samples, each sample is a dict with patient_id, visit_id, record_id,</dt><dd><p>and epoch_path (the path to the saved epoch {â€œsignalâ€: signal, â€œlabelâ€: label} as key.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>samples</p>
</dd>
</dl>
<p>Note that we define the task as a binary classification task.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">TUABDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">isabnormal</span> <span class="o">=</span> <span class="n">TUABDataset</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">root</span><span class="o">=</span><span class="s2">&quot;/srv/local/data/TUH/tuh_eeg_abnormal/v3.0.0/edf/&quot;</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">EEG_isabnormal_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EEG_abnormal_ds</span> <span class="o">=</span> <span class="n">isabnormal</span><span class="o">.</span><span class="n">set_task</span><span class="p">(</span><span class="n">EEG_isAbnormal_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EEG_abnormal_ds</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">{</span>
<span class="go">    &#39;patient_id&#39;: &#39;aaaaamye&#39;,</span>
<span class="go">    &#39;visit_id&#39;: &#39;s001&#39;,</span>
<span class="go">    &#39;record_id&#39;: &#39;1&#39;,</span>
<span class="go">    &#39;epoch_path&#39;: &#39;/home/zhenlin4/.cache/pyhealth/datasets/832afe6e6e8a5c9ea5505b47e7af8125/10-1/1/0.pkl&#39;,</span>
<span class="go">    &#39;label&#39;: 1</span>
<span class="go">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.temple_university_EEG_tasks.EEG_events_fn">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.temple_university_EEG_tasks.</span></span><span class="sig-name descname"><span class="pre">EEG_events_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.temple_university_EEG_tasks.EEG_events_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Processes a single patient for the EEG events task on TUEV.</p>
<p>This task aims at annotating of EEG segments as one of six classes: (1) spike and sharp wave (SPSW), (2) generalized periodic epileptiform discharges (GPED), (3) periodic lateralized epileptiform discharges (PLED), (4) eye movement (EYEM), (5) artifact (ARTF) and (6) background (BCKG).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>record</strong> â€“ <p>a singleton list of one subject from the TUEVDataset.
The (single) record is a dictionary with the following keys:</p>
<blockquote>
<div><p>load_from_path, patient_id, visit_id, signal_file, label_file, save_to_path</p>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a list of samples, each sample is a dict with patient_id, visit_id, record_id, label, offending_channel,</dt><dd><p>and epoch_path (the path to the saved epoch {â€œsignalâ€: signal, â€œlabelâ€: label} as key.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>samples</p>
</dd>
</dl>
<p>Note that we define the task as a multiclass classification task.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">TUEVDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EEGevents</span> <span class="o">=</span> <span class="n">TUEVDataset</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">root</span><span class="o">=</span><span class="s2">&quot;/srv/local/data/TUH/tuh_eeg_events/v2.0.0/edf/&quot;</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">EEG_events_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EEG_events_ds</span> <span class="o">=</span> <span class="n">EEGevents</span><span class="o">.</span><span class="n">set_task</span><span class="p">(</span><span class="n">EEG_events_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EEG_events_ds</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">{</span>
<span class="go">    &#39;patient_id&#39;: &#39;0_00002265&#39;,</span>
<span class="go">    &#39;visit_id&#39;: &#39;00000001&#39;,</span>
<span class="go">    &#39;record_id&#39;: 0,</span>
<span class="go">    &#39;epoch_path&#39;: &#39;/Users/liyanjing/.cache/pyhealth/datasets/d8f3cb92cc444d481444d3414fb5240c/0_00002265_00000001_0.pkl&#39;,</span>
<span class="go">    &#39;label&#39;: 6,</span>
<span class="go">    &#39;offending_channel&#39;: array([4.])</span>
<span class="go">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.temple_university_EEG_tasks.BuildEvents">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.temple_university_EEG_tasks.</span></span><span class="sig-name descname"><span class="pre">BuildEvents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EventData</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.temple_university_EEG_tasks.BuildEvents" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.temple_university_EEG_tasks.convert_signals">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.temple_university_EEG_tasks.</span></span><span class="sig-name descname"><span class="pre">convert_signals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rawdata</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.temple_university_EEG_tasks.convert_signals" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.tasks.temple_university_EEG_tasks.readEDF">
<span class="sig-prename descclassname"><span class="pre">pyhealth.tasks.temple_university_EEG_tasks.</span></span><span class="sig-name descname"><span class="pre">readEDF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fileName</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tasks.temple_university_EEG_tasks.readEDF" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</section>
</div>
</section>
<span id="document-api/models"></span><section id="models">
<h3>Models<a class="headerlink" href="#models" title="Permalink to this heading">#</a></h3>
<p>We implement the following models for supporting multiple healthcare predictive tasks.</p>
<div class="toctree-wrapper compound">
<span id="document-api/models/pyhealth.models.BaseModel"></span><section id="pyhealth-models-basemodel">
<h4>pyhealth.models.BaseModel<a class="headerlink" href="#pyhealth-models-basemodel" title="Permalink to this heading">#</a></h4>
<p>The base class for all models.</p>
</section>
<span id="document-api/models/pyhealth.models.MLP"></span><section id="pyhealth-models-mlp">
<h4>pyhealth.models.MLP<a class="headerlink" href="#pyhealth-models-mlp" title="Permalink to this heading">#</a></h4>
<p>The separate callable MLP model.</p>
</section>
<span id="document-api/models/pyhealth.models.CNN"></span><section id="pyhealth-models-cnn">
<h4>pyhealth.models.CNN<a class="headerlink" href="#pyhealth-models-cnn" title="Permalink to this heading">#</a></h4>
<p>The separate callable CNNLayer and the complete CNN model.</p>
</section>
<span id="document-api/models/pyhealth.models.RNN"></span><section id="pyhealth-models-rnn">
<h4>pyhealth.models.RNN<a class="headerlink" href="#pyhealth-models-rnn" title="Permalink to this heading">#</a></h4>
<p>The separate callable RNNLayer and the complete RNN model.</p>
</section>
<span id="document-api/models/pyhealth.models.GNN"></span><section id="pyhealth-models-gnn">
<h4>pyhealth.models.GNN<a class="headerlink" href="#pyhealth-models-gnn" title="Permalink to this heading">#</a></h4>
<p>The GNN model (pyhealth trainer does not apply to GNN, refer to the example/ChestXray-image-generation-GAN.ipynb for examples of using GNN model).</p>
</section>
<span id="document-api/models/pyhealth.models.Transformer"></span><section id="pyhealth-models-transformer">
<h4>pyhealth.models.Transformer<a class="headerlink" href="#pyhealth-models-transformer" title="Permalink to this heading">#</a></h4>
<p>The separate callable TransformerLayer and the complete Transformer model.</p>
</section>
<span id="document-api/models/pyhealth.models.TransformersModel"></span><section id="pyhealth-models-transformersmodel">
<h4>pyhealth.models.TransformersModel<a class="headerlink" href="#pyhealth-models-transformersmodel" title="Permalink to this heading">#</a></h4>
<p>The complete TransformersModel model.</p>
</section>
<span id="document-api/models/pyhealth.models.RETAIN"></span><section id="pyhealth-models-retain">
<h4>pyhealth.models.RETAIN<a class="headerlink" href="#pyhealth-models-retain" title="Permalink to this heading">#</a></h4>
<p>The separate callable RETAINLayer and the complete RETAIN model.</p>
</section>
<span id="document-api/models/pyhealth.models.GAMENet"></span><section id="pyhealth-models-gamenet">
<h4>pyhealth.models.GAMENet<a class="headerlink" href="#pyhealth-models-gamenet" title="Permalink to this heading">#</a></h4>
<p>The separate callable GAMENetLayer and the complete GAMENet model.</p>
</section>
<span id="document-api/models/pyhealth.models.MICRON"></span><section id="pyhealth-models-micron">
<h4>pyhealth.models.MICRON<a class="headerlink" href="#pyhealth-models-micron" title="Permalink to this heading">#</a></h4>
<p>The separate callable MICRONLayer and the complete MICRON model.</p>
</section>
<span id="document-api/models/pyhealth.models.SafeDrug"></span><section id="pyhealth-models-safedrug">
<h4>pyhealth.models.SafeDrug<a class="headerlink" href="#pyhealth-models-safedrug" title="Permalink to this heading">#</a></h4>
<p>The separate callable SafeDrugLayer and the complete SafeDrug model.</p>
</section>
<span id="document-api/models/pyhealth.models.MoleRec"></span><section id="pyhealth-models-molerec">
<h4>pyhealth.models.MoleRec<a class="headerlink" href="#pyhealth-models-molerec" title="Permalink to this heading">#</a></h4>
<p>The separate callable MoleRecLayer and the complete MoleRec model.</p>
</section>
<span id="document-api/models/pyhealth.models.Deepr"></span><section id="pyhealth-models-deepr">
<h4>pyhealth.models.Deepr<a class="headerlink" href="#pyhealth-models-deepr" title="Permalink to this heading">#</a></h4>
<p>The separate callable DeeprLayer and the complete Deepr model.</p>
</section>
<span id="document-api/models/pyhealth.models.ContraWR"></span><section id="pyhealth-models-contrawr">
<h4>pyhealth.models.ContraWR<a class="headerlink" href="#pyhealth-models-contrawr" title="Permalink to this heading">#</a></h4>
<p>The separate callable ResBlock2D and the complete ContraWR model.</p>
</section>
<span id="document-api/models/pyhealth.models.SparcNet"></span><section id="pyhealth-models-sparcnet">
<h4>pyhealth.models.SparcNet<a class="headerlink" href="#pyhealth-models-sparcnet" title="Permalink to this heading">#</a></h4>
<p>The SparcNet Model: Jin Jing, et al. Development of Expert-level Classification of Seizures and Rhythmic and Periodic Patterns During EEG Interpretation. Neurology 2023.</p>
</section>
<span id="document-api/models/pyhealth.models.StageNet"></span><section id="pyhealth-models-stagenet">
<h4>pyhealth.models.StageNet<a class="headerlink" href="#pyhealth-models-stagenet" title="Permalink to this heading">#</a></h4>
<p>The separate callable StageNetLayer and the complete StageNet model.</p>
</section>
<span id="document-api/models/pyhealth.models.AdaCare"></span><section id="pyhealth-models-adacare">
<h4>pyhealth.models.AdaCare<a class="headerlink" href="#pyhealth-models-adacare" title="Permalink to this heading">#</a></h4>
<p>The separate callable AdaCareLayer and the complete AdaCare model.</p>
</section>
<span id="document-api/models/pyhealth.models.ConCare"></span><section id="pyhealth-models-concare">
<h4>pyhealth.models.ConCare<a class="headerlink" href="#pyhealth-models-concare" title="Permalink to this heading">#</a></h4>
<p>The separate callable ConCareLayer and the complete ConCare model.</p>
</section>
<span id="document-api/models/pyhealth.models.Agent"></span><section id="pyhealth-models-agent">
<h4>pyhealth.models.Agent<a class="headerlink" href="#pyhealth-models-agent" title="Permalink to this heading">#</a></h4>
<p>The separate callable AgentLayer and the complete Agent model.</p>
</section>
<span id="document-api/models/pyhealth.models.GRASP"></span><section id="pyhealth-models-grasp">
<h4>pyhealth.models.GRASP<a class="headerlink" href="#pyhealth-models-grasp" title="Permalink to this heading">#</a></h4>
<p>The separate callable GRASPLayer and the complete GRASP model.</p>
</section>
<span id="document-api/models/pyhealth.models.MedLink"></span><section id="pyhealth-models-medlink">
<h4>pyhealth.models.MedLink<a class="headerlink" href="#pyhealth-models-medlink" title="Permalink to this heading">#</a></h4>
<p>The complete MedLink model.</p>
</section>
<span id="document-api/models/pyhealth.models.TCN"></span><section id="pyhealth-models-tcn">
<h4>pyhealth.models.TCN<a class="headerlink" href="#pyhealth-models-tcn" title="Permalink to this heading">#</a></h4>
<p>The separate callable TCNLayer and the complete TCN model.</p>
</section>
<span id="document-api/models/pyhealth.models.GAN"></span><section id="pyhealth-models-gan">
<h4>pyhealth.models.GAN<a class="headerlink" href="#pyhealth-models-gan" title="Permalink to this heading">#</a></h4>
<p>The GAN model (pyhealth trainer does not apply to GAN, refer to the example/ChestXray-image-generation-GAN.ipynb for examples of using GAN model).</p>
</section>
<span id="document-api/models/pyhealth.models.VAE"></span><section id="pyhealth-models-vae">
<h4>pyhealth.models.VAE<a class="headerlink" href="#pyhealth-models-vae" title="Permalink to this heading">#</a></h4>
<p>The VAE model (treated as a regression task).</p>
</section>
</div>
</section>
<span id="document-api/trainer"></span><section id="trainer">
<h3>Trainer<a class="headerlink" href="#trainer" title="Permalink to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyhealth.trainer.Trainer">
<em class="property"><span class="pre">class</span><span class="w">  </span></em><span class="sig-prename descclassname"><span class="pre">pyhealth.trainer.</span></span><span class="sig-name descname"><span class="pre">Trainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_logging</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.trainer.Trainer" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Trainer for PyTorch models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>) â€“ PyTorch model.</p></li>
<li><p><strong>checkpoint_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) â€“ Path to the checkpoint. Default is None, which means
the model will be randomly initialized.</p></li>
<li><p><strong>metrics</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]]) â€“ List of metric names to be calculated. Default is None, which
means the default metrics in each metrics_fn will be used.</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) â€“ Device to be used for training. Default is None, which means
the device will be GPU if available, otherwise CPU.</p></li>
<li><p><strong>enable_logging</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) â€“ Whether to enable logging. Default is True.</p></li>
<li><p><strong>output_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) â€“ Path to save the output. Default is â€œ./outputâ€.</p></li>
<li><p><strong>exp_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) â€“ Name of the experiment. Default is current datetime.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyhealth.trainer.Trainer.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_dataloader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_dataloader=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_dataloader=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs=5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer_class=&lt;class</span> <span class="pre">'torch.optim.adam.Adam'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer_params=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps_per_epoch=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluation_steps=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grad_norm=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor_criterion='max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_best_model_at_last=True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.trainer.Trainer.train" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_dataloader</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">DataLoader</span></code>) â€“ Dataloader for training.</p></li>
<li><p><strong>val_dataloader</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">DataLoader</span></code>]) â€“ Dataloader for validation. Default is None.</p></li>
<li><p><strong>test_dataloader</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">DataLoader</span></code>]) â€“ Dataloader for testing. Default is None.</p></li>
<li><p><strong>epochs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) â€“ Number of epochs. Default is 5.</p></li>
<li><p><strong>optimizer_class</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Type" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Optimizer</span></code>]) â€“ Optimizer class. Default is torch.optim.Adam.</p></li>
<li><p><strong>optimizer_params</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a>]]) â€“ Parameters for the optimizer. Default is {â€œlrâ€: 1e-3}.</p></li>
<li><p><strong>steps_per_epoch</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]) â€“ Number of steps per epoch. Default is None.</p></li>
<li><p><strong>weight_decay</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) â€“ Weight decay. Default is 0.0.</p></li>
<li><p><strong>max_grad_norm</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]) â€“ Maximum gradient norm. Default is None.</p></li>
<li><p><strong>monitor</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) â€“ Metric name to monitor. Default is None.</p></li>
<li><p><strong>monitor_criterion</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) â€“ Criterion to monitor. Default is â€œmaxâ€.</p></li>
<li><p><strong>load_best_model_at_last</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) â€“ Whether to load the best model at the last.
Default is True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyhealth.trainer.Trainer.inference">
<span class="sig-name descname"><span class="pre">inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">additional_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_patient_ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.trainer.Trainer.inference" title="Permalink to this definition">#</a></dt>
<dd><p>Model inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataloader</strong> â€“ Dataloader for evaluation.</p></li>
<li><p><strong>additional_outputs</strong> â€“ List of additional output to collect.
Defaults to None ([]).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of true labels.
y_prob_all: List of predicted probabilities.
loss_mean: Mean loss over batches.
additional_outputs (only if requested): Dict of additional results.
patient_ids (only if requested): List of patient ids in the same order as y_true_all/y_prob_all.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y_true_all</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyhealth.trainer.Trainer.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloader</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.trainer.Trainer.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluates the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dataloader</strong> â€“ Dataloader for evaluation.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a dictionary of scores.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>scores</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyhealth.trainer.Trainer.save_ckpt">
<span class="sig-name descname"><span class="pre">save_ckpt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpt_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.trainer.Trainer.save_ckpt" title="Permalink to this definition">#</a></dt>
<dd><p>Saves the model checkpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyhealth.trainer.Trainer.load_ckpt">
<span class="sig-name descname"><span class="pre">load_ckpt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpt_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.trainer.Trainer.load_ckpt" title="Permalink to this definition">#</a></dt>
<dd><p>Saves the model checkpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<span id="document-api/tokenizer"></span><section id="tokenizer">
<h3>Tokenizer<a class="headerlink" href="#tokenizer" title="Permalink to this heading">#</a></h3>
<p>The tokenizer functionality can be used for supporting tokens-to-index or index-to-token mapping in general ML setting.</p>
<span class="target" id="module-pyhealth.tokenizer"></span><dl class="py class">
<dt class="sig sig-object py" id="pyhealth.tokenizer.Vocabulary">
<em class="property"><span class="pre">class</span><span class="w">  </span></em><span class="sig-prename descclassname"><span class="pre">pyhealth.tokenizer.</span></span><span class="sig-name descname"><span class="pre">Vocabulary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">special_tokens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tokenizer.Vocabulary" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Vocabulary class for mapping between tokens and indices.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyhealth.tokenizer.Vocabulary.add_token">
<span class="sig-name descname"><span class="pre">add_token</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">token</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tokenizer.Vocabulary.add_token" title="Permalink to this definition">#</a></dt>
<dd><p>Adds a token to the vocabulary.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyhealth.tokenizer.Tokenizer">
<em class="property"><span class="pre">class</span><span class="w">  </span></em><span class="sig-prename descclassname"><span class="pre">pyhealth.tokenizer.</span></span><span class="sig-name descname"><span class="pre">Tokenizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">special_tokens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tokenizer.Tokenizer" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Tokenizer class for converting tokens to indices and vice versa.</p>
<p>This class will build a vocabulary from the provided tokens and provide the
functionality to convert tokens to indices and vice versa. This class also
provides the functionality to tokenize a batch of data.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.tokenizer</span><span class="w"> </span><span class="kn">import</span> <span class="n">Tokenizer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">token_space</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A01A&#39;</span><span class="p">,</span> <span class="s1">&#39;A02A&#39;</span><span class="p">,</span> <span class="s1">&#39;A02B&#39;</span><span class="p">,</span> <span class="s1">&#39;A02X&#39;</span><span class="p">,</span> <span class="s1">&#39;A03A&#39;</span><span class="p">,</span> <span class="s1">&#39;A03B&#39;</span><span class="p">,</span> <span class="s1">&#39;A03C&#39;</span><span class="p">,</span> <span class="s1">&#39;A03D&#39;</span><span class="p">,</span> <span class="s1">&#39;A03E&#39;</span><span class="p">,</span>             <span class="o">...</span>                <span class="s1">&#39;A03F&#39;</span><span class="p">,</span> <span class="s1">&#39;A04A&#39;</span><span class="p">,</span> <span class="s1">&#39;A05A&#39;</span><span class="p">,</span> <span class="s1">&#39;A05B&#39;</span><span class="p">,</span> <span class="s1">&#39;A05C&#39;</span><span class="p">,</span> <span class="s1">&#39;A06A&#39;</span><span class="p">,</span> <span class="s1">&#39;A07A&#39;</span><span class="p">,</span> <span class="s1">&#39;A07B&#39;</span><span class="p">,</span> <span class="s1">&#39;A07C&#39;</span><span class="p">,</span>             <span class="o">...</span>                <span class="s1">&#39;A07D&#39;</span><span class="p">,</span> <span class="s1">&#39;A07E&#39;</span><span class="p">,</span> <span class="s1">&#39;A07F&#39;</span><span class="p">,</span> <span class="s1">&#39;A07X&#39;</span><span class="p">,</span> <span class="s1">&#39;A08A&#39;</span><span class="p">,</span> <span class="s1">&#39;A09A&#39;</span><span class="p">,</span> <span class="s1">&#39;A10A&#39;</span><span class="p">,</span> <span class="s1">&#39;A10B&#39;</span><span class="p">,</span> <span class="s1">&#39;A10X&#39;</span><span class="p">,</span>             <span class="o">...</span>                <span class="s1">&#39;A11A&#39;</span><span class="p">,</span> <span class="s1">&#39;A11B&#39;</span><span class="p">,</span> <span class="s1">&#39;A11C&#39;</span><span class="p">,</span> <span class="s1">&#39;A11D&#39;</span><span class="p">,</span> <span class="s1">&#39;A11E&#39;</span><span class="p">,</span> <span class="s1">&#39;A11G&#39;</span><span class="p">,</span> <span class="s1">&#39;A11H&#39;</span><span class="p">,</span> <span class="s1">&#39;A11J&#39;</span><span class="p">,</span> <span class="s1">&#39;A12A&#39;</span><span class="p">,</span>             <span class="o">...</span>                <span class="s1">&#39;A12B&#39;</span><span class="p">,</span> <span class="s1">&#39;A12C&#39;</span><span class="p">,</span> <span class="s1">&#39;A13A&#39;</span><span class="p">,</span> <span class="s1">&#39;A14A&#39;</span><span class="p">,</span> <span class="s1">&#39;A14B&#39;</span><span class="p">,</span> <span class="s1">&#39;A16A&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tokenizer</span> <span class="o">=</span> <span class="n">Tokenizer</span><span class="p">(</span><span class="n">tokens</span><span class="o">=</span><span class="n">token_space</span><span class="p">,</span> <span class="n">special_tokens</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;&lt;pad&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;unk&gt;&quot;</span><span class="p">])</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pyhealth.tokenizer.Tokenizer.get_padding_index">
<span class="sig-name descname"><span class="pre">get_padding_index</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tokenizer.Tokenizer.get_padding_index" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the index of the padding token.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyhealth.tokenizer.Tokenizer.get_vocabulary_size">
<span class="sig-name descname"><span class="pre">get_vocabulary_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tokenizer.Tokenizer.get_vocabulary_size" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the size of the vocabulary.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tokenizer</span><span class="o">.</span><span class="n">get_vocabulary_size</span><span class="p">()</span>
<span class="go">44</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyhealth.tokenizer.Tokenizer.convert_tokens_to_indices">
<span class="sig-name descname"><span class="pre">convert_tokens_to_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokens</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tokenizer.Tokenizer.convert_tokens_to_indices" title="Permalink to this definition">#</a></dt>
<dd><p>Converts a list of tokens to indices.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A03C&#39;</span><span class="p">,</span> <span class="s1">&#39;A03D&#39;</span><span class="p">,</span> <span class="s1">&#39;A03E&#39;</span><span class="p">,</span> <span class="s1">&#39;A03F&#39;</span><span class="p">,</span> <span class="s1">&#39;A04A&#39;</span><span class="p">,</span> <span class="s1">&#39;A05A&#39;</span><span class="p">,</span> <span class="s1">&#39;A05B&#39;</span><span class="p">,</span> <span class="s1">&#39;B035&#39;</span><span class="p">,</span> <span class="s1">&#39;C129&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">convert_tokens_to_indices</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
<span class="go">[8, 9, 10, 11, 12, 13, 14, 1, 1]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyhealth.tokenizer.Tokenizer.convert_indices_to_tokens">
<span class="sig-name descname"><span class="pre">convert_indices_to_tokens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tokenizer.Tokenizer.convert_indices_to_tokens" title="Permalink to this definition">#</a></dt>
<dd><p>Converts a list of indices to tokens.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tokens</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">convert_indices_to_tokens</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
<span class="go">[&#39;&lt;pad&gt;&#39;, &#39;&lt;unk&gt;&#39;, &#39;A01A&#39;, &#39;A02A&#39;, &#39;A02B&#39;, &#39;A02X&#39;]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyhealth.tokenizer.Tokenizer.batch_encode_2d">
<span class="sig-name descname"><span class="pre">batch_encode_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tokenizer.Tokenizer.batch_encode_2d" title="Permalink to this definition">#</a></dt>
<dd><p>Converts a list of lists of tokens (2D) to indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]]) â€“ List of lists of tokens to convert to indices.</p></li>
<li><p><strong>padding</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) â€“ whether to pad the tokens to the max number of tokens in
the batch (smart padding).</p></li>
<li><p><strong>truncation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) â€“ whether to truncate the tokens to max_length.</p></li>
<li><p><strong>max_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) â€“ maximum length of the tokens. This argument is ignored
if truncation is False.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="p">[</span><span class="s1">&#39;A03C&#39;</span><span class="p">,</span> <span class="s1">&#39;A03D&#39;</span><span class="p">,</span> <span class="s1">&#39;A03E&#39;</span><span class="p">,</span> <span class="s1">&#39;A03F&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="s1">&#39;A04A&#39;</span><span class="p">,</span> <span class="s1">&#39;B035&#39;</span><span class="p">,</span> <span class="s1">&#39;C129&#39;</span><span class="p">]</span>
<span class="gp">... </span><span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">batch_encode_2d</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;case 1:&#39;</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span>
<span class="go">case 1: [[8, 9, 10, 11], [12, 1, 1, 0]]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">batch_encode_2d</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;case 2:&#39;</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span>
<span class="go">case 2: [[8, 9, 10, 11], [12, 1, 1]]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">batch_encode_2d</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;case 3:&#39;</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span>
<span class="go">case 3: [[9, 10, 11], [12, 1, 1]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyhealth.tokenizer.Tokenizer.batch_decode_2d">
<span class="sig-name descname"><span class="pre">batch_decode_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tokenizer.Tokenizer.batch_decode_2d" title="Permalink to this definition">#</a></dt>
<dd><p>Converts a list of lists of indices (2D) to tokens.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]) â€“ List of lists of indices to convert to tokens.</p></li>
<li><p><strong>padding</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) â€“ whether to keep the padding tokens from the tokens.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">... </span><span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tokens</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">batch_decode_2d</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;case 1:&#39;</span><span class="p">,</span> <span class="n">tokens</span><span class="p">)</span>
<span class="go">case 1: [[&#39;A03C&#39;, &#39;A03D&#39;, &#39;A03E&#39;, &#39;A03F&#39;], [&#39;A04A&#39;, &#39;&lt;unk&gt;&#39;, &#39;&lt;unk&gt;&#39;]]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tokens</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">batch_decode_2d</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;case 2:&#39;</span><span class="p">,</span> <span class="n">tokens</span><span class="p">)</span>
<span class="go">case 2: [[&#39;A03C&#39;, &#39;A03D&#39;, &#39;A03E&#39;, &#39;A03F&#39;], [&#39;A04A&#39;, &#39;&lt;unk&gt;&#39;, &#39;&lt;unk&gt;&#39;, &#39;&lt;pad&gt;&#39;]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyhealth.tokenizer.Tokenizer.batch_encode_3d">
<span class="sig-name descname"><span class="pre">batch_encode_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(True,</span> <span class="pre">True)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(True,</span> <span class="pre">True)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(10,</span> <span class="pre">512)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tokenizer.Tokenizer.batch_encode_3d" title="Permalink to this definition">#</a></dt>
<dd><p>Converts a list of lists of lists of tokens (3D) to indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]]]) â€“ List of lists of lists of tokens to convert to indices.</p></li>
<li><p><strong>padding</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>]) â€“ a tuple of two booleans indicating whether to pad the tokens
to the max number of tokens and visits (smart padding).</p></li>
<li><p><strong>truncation</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>]) â€“ a tuple of two booleans indicating whether to truncate the
tokens to the corresponding element in max_length</p></li>
<li><p><strong>max_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]) â€“ a tuple of two integers indicating the maximum length of the
tokens along the first and second dimension. This argument is ignored
if truncation is False.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="p">[</span>
<span class="gp">... </span>        <span class="p">[</span><span class="s1">&#39;A03C&#39;</span><span class="p">,</span> <span class="s1">&#39;A03D&#39;</span><span class="p">,</span> <span class="s1">&#39;A03E&#39;</span><span class="p">,</span> <span class="s1">&#39;A03F&#39;</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="s1">&#39;A08A&#39;</span><span class="p">,</span> <span class="s1">&#39;A09A&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span>
<span class="gp">... </span>        <span class="p">[</span><span class="s1">&#39;A04A&#39;</span><span class="p">,</span> <span class="s1">&#39;B035&#39;</span><span class="p">,</span> <span class="s1">&#39;C129&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">]</span>
<span class="gp">... </span><span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">batch_encode_3d</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;case 1:&#39;</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span>
<span class="go">case 1: [[[8, 9, 10, 11], [24, 25, 0, 0]], [[12, 1, 1, 0], [0, 0, 0, 0]]]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">batch_encode_3d</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;case 2:&#39;</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span>
<span class="go">case 2: [[[8, 9, 10, 11], [24, 25, 0, 0]], [[12, 1, 1, 0]]]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">batch_encode_3d</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;case 3:&#39;</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span>
<span class="go">case 3: [[[8, 9, 10, 11], [24, 25]], [[12, 1, 1], [0]]]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">batch_encode_3d</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;case 4:&#39;</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span>
<span class="go">case 4: [[[8, 9, 10, 11], [24, 25]], [[12, 1, 1]]]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">batch_encode_3d</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;case 5:&#39;</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span>
<span class="go">case 5: [[[10, 11], [24, 25]], [[1, 1], [0, 0]]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyhealth.tokenizer.Tokenizer.batch_decode_3d">
<span class="sig-name descname"><span class="pre">batch_decode_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.tokenizer.Tokenizer.batch_decode_3d" title="Permalink to this definition">#</a></dt>
<dd><p>Converts a list of lists of lists of indices (3D) to tokens.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]]) â€“ List of lists of lists of indices to convert to tokens.</p></li>
<li><p><strong>padding</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) â€“ whether to keep the padding tokens from the tokens.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="p">[</span>
<span class="gp">... </span>        <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">... </span>    <span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span>
<span class="gp">... </span>        <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">... </span>    <span class="p">]</span>
<span class="gp">... </span><span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tokens</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">batch_decode_3d</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;case 1:&#39;</span><span class="p">,</span> <span class="n">tokens</span><span class="p">)</span>
<span class="go">case 1: [[[&#39;A03C&#39;, &#39;A03D&#39;, &#39;A03E&#39;, &#39;A03F&#39;], [&#39;A08A&#39;, &#39;A09A&#39;]], [[&#39;A04A&#39;, &#39;&lt;unk&gt;&#39;, &#39;&lt;unk&gt;&#39;]]]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tokens</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">batch_decode_3d</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;case 2:&#39;</span><span class="p">,</span> <span class="n">tokens</span><span class="p">)</span>
<span class="go">case 2: [[[&#39;A03C&#39;, &#39;A03D&#39;, &#39;A03E&#39;, &#39;A03F&#39;], [&#39;A08A&#39;, &#39;A09A&#39;, &#39;&lt;pad&gt;&#39;, &#39;&lt;pad&gt;&#39;]], [[&#39;A04A&#39;, &#39;&lt;unk&gt;&#39;, &#39;&lt;unk&gt;&#39;, &#39;&lt;pad&gt;&#39;], [&#39;&lt;pad&gt;&#39;, &#39;&lt;pad&gt;&#39;, &#39;&lt;pad&gt;&#39;, &#39;&lt;pad&gt;&#39;]]]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<span id="document-api/metrics"></span><section id="metrics">
<h3>Metrics<a class="headerlink" href="#metrics" title="Permalink to this heading">#</a></h3>
<p>We provide easy to use metrics (the same style and args as <cite>sklearn.metrics</cite>) for binary classification,
multiclass classification, multilabel classification.
For applicable tasks, we provide the relevant metrics for model calibration, as well as those for prediction set evaluation.
Among these we also provide metrics related to uncertainty quantification, for model calibration, as well as metrics that measure the quality of prediction sets
We also provide other metrics specically for healthcare
tasks, such as drug drug interaction (DDI) rate.</p>
<div class="toctree-wrapper compound">
<span id="document-api/metrics/pyhealth.metrics.multiclass"></span><section id="pyhealth-metrics-multiclass">
<h4>pyhealth.metrics.multiclass<a class="headerlink" href="#pyhealth-metrics-multiclass" title="Permalink to this heading">#</a></h4>
<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.metrics.multiclass.multiclass_metrics_fn">
<span class="sig-prename descclassname"><span class="pre">pyhealth.metrics.multiclass.</span></span><span class="sig-name descname"><span class="pre">multiclass_metrics_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_prob</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_predset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.metrics.multiclass.multiclass_metrics_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Computes metrics for multiclass classification.</p>
<p>User can specify which metrics to compute by passing a list of metric names.
The accepted metric names are:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt>roc_auc_macro_ovo: area under the receiver operating characteristic curve,</dt><dd><p>macro averaged over one-vs-one multiclass classification</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>roc_auc_macro_ovr: area under the receiver operating characteristic curve,</dt><dd><p>macro averaged over one-vs-rest multiclass classification</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>roc_auc_weighted_ovo: area under the receiver operating characteristic curve,</dt><dd><p>weighted averaged over one-vs-one multiclass classification</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>roc_auc_weighted_ovr: area under the receiver operating characteristic curve,</dt><dd><p>weighted averaged over one-vs-rest multiclass classification</p>
</dd>
</dl>
</li>
<li><p>accuracy: accuracy score</p></li>
<li><dl class="simple">
<dt>balanced_accuracy: balanced accuracy score (usually used for imbalanced</dt><dd><p>datasets)</p>
</dd>
</dl>
</li>
<li><p>f1_micro: f1 score, micro averaged</p></li>
<li><p>f1_macro: f1 score, macro averaged</p></li>
<li><p>f1_weighted: f1 score, weighted averaged</p></li>
<li><p>jaccard_micro: Jaccard similarity coefficient score, micro averaged</p></li>
<li><p>jaccard_macro: Jaccard similarity coefficient score, macro averaged</p></li>
<li><p>jaccard_weighted: Jaccard similarity coefficient score, weighted averaged</p></li>
<li><p>cohen_kappa: Cohenâ€™s kappa score</p></li>
<li><p>brier_top1: brier score between the top prediction and the true label</p></li>
<li><p>ECE: Expected Calibration Error (with 20 equal-width bins). Check <a class="reference internal" href="index.html#pyhealth.metrics.calibration.ece_confidence_multiclass" title="pyhealth.metrics.calibration.ece_confidence_multiclass"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyhealth.metrics.calibration.ece_confidence_multiclass()</span></code></a>.</p></li>
<li><p>ECE_adapt: adaptive ECE (with 20 equal-size bins). Check <a class="reference internal" href="index.html#pyhealth.metrics.calibration.ece_confidence_multiclass" title="pyhealth.metrics.calibration.ece_confidence_multiclass"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyhealth.metrics.calibration.ece_confidence_multiclass()</span></code></a>.</p></li>
<li><p>cwECEt: classwise ECE with threshold=min(0.01,1/K). Check <a class="reference internal" href="index.html#pyhealth.metrics.calibration.ece_classwise" title="pyhealth.metrics.calibration.ece_classwise"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyhealth.metrics.calibration.ece_classwise()</span></code></a>.</p></li>
<li><p>cwECEt_adapt: classwise adaptive ECE with threshold=min(0.01,1/K). Check <a class="reference internal" href="index.html#pyhealth.metrics.calibration.ece_classwise" title="pyhealth.metrics.calibration.ece_classwise"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyhealth.metrics.calibration.ece_classwise()</span></code></a>.</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>The following metrics related to the prediction sets are accepted as well, but will be ignored if y_predset is None:</dt><dd><ul class="simple">
<li><p>rejection_rate: Frequency of rejection, where rejection happens when the prediction set has cardinality other than 1. Check <a class="reference internal" href="index.html#pyhealth.metrics.prediction_set.rejection_rate" title="pyhealth.metrics.prediction_set.rejection_rate"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyhealth.metrics.prediction_set.rejection_rate()</span></code></a>.</p></li>
<li><p>set_size: Average size of the prediction sets. Check <a class="reference internal" href="index.html#pyhealth.metrics.prediction_set.size" title="pyhealth.metrics.prediction_set.size"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyhealth.metrics.prediction_set.size()</span></code></a>.</p></li>
<li><p>miscoverage_ps:  Prob(k not in prediction set). Check <a class="reference internal" href="index.html#pyhealth.metrics.prediction_set.miscoverage_ps" title="pyhealth.metrics.prediction_set.miscoverage_ps"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyhealth.metrics.prediction_set.miscoverage_ps()</span></code></a>.</p></li>
<li><p>miscoverage_mean_ps: The average (across different classes k) of miscoverage_ps.</p></li>
<li><p>miscoverage_overall_ps: Prob(Y not in prediction set). Check <a class="reference internal" href="index.html#pyhealth.metrics.prediction_set.miscoverage_overall_ps" title="pyhealth.metrics.prediction_set.miscoverage_overall_ps"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyhealth.metrics.prediction_set.miscoverage_overall_ps()</span></code></a>.</p></li>
<li><p>error_ps: Same as miscoverage_ps, but retricted to un-rejected samples. Check <a class="reference internal" href="index.html#pyhealth.metrics.prediction_set.error_ps" title="pyhealth.metrics.prediction_set.error_ps"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyhealth.metrics.prediction_set.error_ps()</span></code></a>.</p></li>
<li><p>error_mean_ps: The average (across different classes k) of error_ps.</p></li>
<li><p>error_overall_ps: Same as miscoverage_overall_ps, but restricted to un-rejected samples. Check <a class="reference internal" href="index.html#pyhealth.metrics.prediction_set.error_overall_ps" title="pyhealth.metrics.prediction_set.error_overall_ps"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyhealth.metrics.prediction_set.error_overall_ps()</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<p>If no metrics are specified, accuracy, f1_macro, and f1_micro are computed
by default.</p>
<p>This function calls sklearn.metrics functions to compute the metrics. For
more information on the metrics, please refer to the documentation of the
corresponding sklearn.metrics functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) â€“ True target values of shape (n_samples,).</p></li>
<li><p><strong>y_prob</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) â€“ Predicted probabilities of shape (n_samples, n_classes).</p></li>
<li><p><strong>metrics</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]]) â€“ List of metrics to compute. Default is [â€œaccuracyâ€, â€œf1_macroâ€,
â€œf1_microâ€].</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Dictionary of metrics whose keys are the metric names and values are</dt><dd><p>the metric values.</p>
</dd>
</dl>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">multiclass_metrics_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_prob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.9</span><span class="p">,</span>  <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span>  <span class="mf">0.05</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">multiclass_metrics_fn</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_prob</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">])</span>
<span class="go">{&#39;accuracy&#39;: 0.75}</span>
</pre></div>
</div>
</dd></dl>

</section>
<span id="document-api/metrics/pyhealth.metrics.multilabel"></span><section id="pyhealth-metrics-multilabel">
<h4>pyhealth.metrics.multilabel<a class="headerlink" href="#pyhealth-metrics-multilabel" title="Permalink to this heading">#</a></h4>
<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.metrics.multilabel.multilabel_metrics_fn">
<span class="sig-prename descclassname"><span class="pre">pyhealth.metrics.multilabel.</span></span><span class="sig-name descname"><span class="pre">multilabel_metrics_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_prob</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_predset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.metrics.multilabel.multilabel_metrics_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Computes metrics for multilabel classification.</p>
<p>User can specify which metrics to compute by passing a list of metric names.
The accepted metric names are:</p>
<blockquote>
<div><ul class="simple">
<li><p>roc_auc_micro: area under the receiver operating characteristic curve,
micro averaged</p></li>
<li><p>roc_auc_macro: area under the receiver operating characteristic curve,
macro averaged</p></li>
<li><p>roc_auc_weighted: area under the receiver operating characteristic curve,
weighted averaged</p></li>
<li><p>roc_auc_samples: area under the receiver operating characteristic curve,
samples averaged</p></li>
<li><p>pr_auc_micro: area under the precision recall curve, micro averaged</p></li>
<li><p>pr_auc_macro: area under the precision recall curve, macro averaged</p></li>
<li><p>pr_auc_weighted: area under the precision recall curve, weighted averaged</p></li>
<li><p>pr_auc_samples: area under the precision recall curve, samples averaged</p></li>
<li><p>accuracy: accuracy score</p></li>
<li><p>f1_micro: f1 score, micro averaged</p></li>
<li><p>f1_macro: f1 score, macro averaged</p></li>
<li><p>f1_weighted: f1 score, weighted averaged</p></li>
<li><p>f1_samples: f1 score, samples averaged</p></li>
<li><p>precision_micro: precision score, micro averaged</p></li>
<li><p>precision_macro: precision score, macro averaged</p></li>
<li><p>precision_weighted: precision score, weighted averaged</p></li>
<li><p>precision_samples: precision score, samples averaged</p></li>
<li><p>recall_micro: recall score, micro averaged</p></li>
<li><p>recall_macro: recall score, macro averaged</p></li>
<li><p>recall_weighted: recall score, weighted averaged</p></li>
<li><p>recall_samples: recall score, samples averaged</p></li>
<li><p>jaccard_micro: Jaccard similarity coefficient score, micro averaged</p></li>
<li><p>jaccard_macro: Jaccard similarity coefficient score, macro averaged</p></li>
<li><p>jaccard_weighted: Jaccard similarity coefficient score, weighted averaged</p></li>
<li><p>jaccard_samples: Jaccard similarity coefficient score, samples averaged</p></li>
<li><p>ddi: drug-drug interaction score (specifically for drug-related tasks, such as drug recommendation)</p></li>
<li><p>hamming_loss: Hamming loss</p></li>
<li><p>cwECE: classwise ECE (with 20 equal-width bins). Check <a class="reference internal" href="index.html#pyhealth.metrics.calibration.ece_classwise" title="pyhealth.metrics.calibration.ece_classwise"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyhealth.metrics.calibration.ece_classwise()</span></code></a>.</p></li>
<li><p>cwECE_adapt: classwise adaptive ECE (with 20 equal-size bins). Check <a class="reference internal" href="index.html#pyhealth.metrics.calibration.ece_classwise" title="pyhealth.metrics.calibration.ece_classwise"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyhealth.metrics.calibration.ece_classwise()</span></code></a>.</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>The following metrics related to the prediction sets are accepted as well, but will be ignored if y_predset is None:</dt><dd><ul class="simple">
<li><p>fp: Number of false positives.</p></li>
<li><p>tp: Number of true positives.</p></li>
</ul>
</dd>
</dl>
<p>If no metrics are specified, pr_auc_samples is computed by default.</p>
<p>This function calls sklearn.metrics functions to compute the metrics. For
more information on the metrics, please refer to the documentation of the
corresponding sklearn.metrics functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) â€“ True target values of shape (n_samples, n_labels).</p></li>
<li><p><strong>y_prob</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) â€“ Predicted probabilities of shape (n_samples, n_labels).</p></li>
<li><p><strong>metrics</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]]) â€“ List of metrics to compute. Default is [â€œpr_auc_samplesâ€].</p></li>
<li><p><strong>threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) â€“ Threshold to binarize the predicted probabilities. Default is 0.5.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Dictionary of metrics whose keys are the metric names and values are</dt><dd><p>the metric values.</p>
</dd>
</dl>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">multilabel_metrics_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_prob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">multilabel_metrics_fn</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_prob</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">])</span>
<span class="go">{&#39;accuracy&#39;: 0.5}</span>
</pre></div>
</div>
</dd></dl>

</section>
<span id="document-api/metrics/pyhealth.metrics.binary"></span><section id="pyhealth-metrics-binary">
<h4>pyhealth.metrics.binary<a class="headerlink" href="#pyhealth-metrics-binary" title="Permalink to this heading">#</a></h4>
<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.metrics.binary.binary_metrics_fn">
<span class="sig-prename descclassname"><span class="pre">pyhealth.metrics.binary.</span></span><span class="sig-name descname"><span class="pre">binary_metrics_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_prob</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.metrics.binary.binary_metrics_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Computes metrics for binary classification.</p>
<p>User can specify which metrics to compute by passing a list of metric names.
The accepted metric names are:</p>
<blockquote>
<div><ul class="simple">
<li><p>pr_auc: area under the precision-recall curve</p></li>
<li><p>roc_auc: area under the receiver operating characteristic curve</p></li>
<li><p>accuracy: accuracy score</p></li>
<li><p>balanced_accuracy: balanced accuracy score (usually used for imbalanced
datasets)</p></li>
<li><p>f1: f1 score</p></li>
<li><p>precision: precision score</p></li>
<li><p>recall: recall score</p></li>
<li><p>cohen_kappa: Cohenâ€™s kappa score</p></li>
<li><p>jaccard: Jaccard similarity coefficient score</p></li>
<li><p>ECE: Expected Calibration Error (with 20 equal-width bins). Check <a class="reference internal" href="index.html#pyhealth.metrics.calibration.ece_confidence_binary" title="pyhealth.metrics.calibration.ece_confidence_binary"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyhealth.metrics.calibration.ece_confidence_binary()</span></code></a>.</p></li>
<li><p>ECE_adapt: adaptive ECE (with 20 equal-size bins). Check <a class="reference internal" href="index.html#pyhealth.metrics.calibration.ece_confidence_binary" title="pyhealth.metrics.calibration.ece_confidence_binary"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyhealth.metrics.calibration.ece_confidence_binary()</span></code></a>.</p></li>
</ul>
</div></blockquote>
<p>If no metrics are specified, pr_auc, roc_auc and f1 are computed by default.</p>
<p>This function calls sklearn.metrics functions to compute the metrics. For
more information on the metrics, please refer to the documentation of the
corresponding sklearn.metrics functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) â€“ True target values of shape (n_samples,).</p></li>
<li><p><strong>y_prob</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) â€“ Predicted probabilities of shape (n_samples,).</p></li>
<li><p><strong>metrics</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]]) â€“ List of metrics to compute. Default is [â€œpr_aucâ€, â€œroc_aucâ€, â€œf1â€].</p></li>
<li><p><strong>threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) â€“ Threshold for binary classification. Default is 0.5.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Dictionary of metrics whose keys are the metric names and values are</dt><dd><p>the metric values.</p>
</dd>
</dl>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">binary_metrics_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_prob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binary_metrics_fn</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_prob</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">])</span>
<span class="go">{&#39;accuracy&#39;: 0.75}</span>
</pre></div>
</div>
</dd></dl>

</section>
<span id="document-api/metrics/pyhealth.metrics.calibration"></span><section id="module-pyhealth.metrics.calibration">
<span id="core-calibration"></span><h4>[core] calibration<a class="headerlink" href="#module-pyhealth.metrics.calibration" title="Permalink to this heading">#</a></h4>
<p>Metrics that meature model calibration.</p>
<p>Reference Papers:</p>
<blockquote>
<div><p>[1] Lin, Zhen, Shubhendu Trivedi, and Jimeng Sun.
â€œTaking a Step Back with KCal: Multi-Class Kernel-Based Calibration
for Deep Neural Networks.â€
ICLR 2023.</p>
<p>[2] Nixon, Jeremy, Michael W. Dusenberry, Linchuan Zhang, Ghassen Jerfel, and Dustin Tran.
â€œMeasuring Calibration in Deep Learning.â€
In CVPR workshops, vol. 2, no. 7. 2019.</p>
<p>[3] Patel, Kanil, William Beluch, Bin Yang, Michael Pfeiffer, and Dan Zhang.
â€œMulti-class uncertainty calibration via mutual information maximization-based binning.â€
ICLR 2021.</p>
<p>[4] Guo, Chuan, Geoff Pleiss, Yu Sun, and Kilian Q. Weinberger.
â€œOn calibration of modern neural networks.â€
ICML 2017.</p>
<p>[5] Kull, Meelis, Miquel Perello Nieto, Markus KÃ¤ngsepp, Telmo Silva Filho, Hao Song, and Peter Flach.
â€œBeyond temperature scaling: Obtaining well-calibrated multi-class probabilities with dirichlet calibration.â€
Advances in neural information processing systems 32 (2019).</p>
<p>[6] Brier, Glenn W.
â€œVerification of forecasts expressed in terms of probability.â€
Monthly weather review 78, no. 1 (1950): 1-3.</p>
</div></blockquote>
<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.metrics.calibration.ece_confidence_multiclass">
<span class="sig-prename descclassname"><span class="pre">pyhealth.metrics.calibration.</span></span><span class="sig-name descname"><span class="pre">ece_confidence_multiclass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prob</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaptive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.metrics.calibration.ece_confidence_multiclass" title="Permalink to this definition">#</a></dt>
<dd><p>Expected Calibration Error (ECE).</p>
<p>We group samples into â€˜binsâ€™ basing on the top-class prediction.
Then, we compute the absolute difference between the average top-class prediction and
the frequency of top-class being correct (i.e. accuracy) for each bin.
ECE is the average (weighed by number of points in each bin) of these absolute differences.
It could be expressed by the following formula, with <span class="math notranslate nohighlight">\(B_m\)</span> denoting the m-th bin:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[ECE = \sum_{m=1}^M \frac{|B_m|}{N} |acc(B_m) - conf(B_m)|\]</div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.31</span><span class="p">,</span> <span class="mf">0.49</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ECE_confidence_multiclass</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">0.36333333333333334</span>
</pre></div>
</div>
<p>Explanation of the example: The bins are [0, 0.5] and (0.5, 1].
In the first bin, we have one sample with top-class prediction of 0.49, and its
accuracy is 0. In the second bin, we have average confidence of 0.7 and average
accuracy of 1. Thus, the ECE is <span class="math notranslate nohighlight">\(\frac{1}{3} \cdot 0.49 + \frac{2}{3}\cdot 0.3=0.3633\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prob</strong> (<em>np.ndarray</em>) â€“ (N, C)</p></li>
<li><p><strong>label</strong> (<em>np.ndarray</em>) â€“ (N,)</p></li>
<li><p><strong>bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) â€“ Number of bins. Defaults to 20.</p></li>
<li><p><strong>adaptive</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) â€“ If False, bins are equal width ([0, 0.05, 0.1, â€¦, 1])
If True, bin widths are adaptive such that each bin contains the same number
of points. Defaults to False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.metrics.calibration.ece_confidence_binary">
<span class="sig-prename descclassname"><span class="pre">pyhealth.metrics.calibration.</span></span><span class="sig-name descname"><span class="pre">ece_confidence_binary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prob</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaptive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.metrics.calibration.ece_confidence_binary" title="Permalink to this definition">#</a></dt>
<dd><p>Expected Calibration Error (ECE) for binary classification.</p>
<p>Similar to <a class="reference internal" href="#pyhealth.metrics.calibration.ece_confidence_multiclass" title="pyhealth.metrics.calibration.ece_confidence_multiclass"><code class="xref py py-func docutils literal notranslate"><span class="pre">ece_confidence_multiclass()</span></code></a>, but on class 1 instead of the top-prediction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prob</strong> (<em>np.ndarray</em>) â€“ (N, C)</p></li>
<li><p><strong>label</strong> (<em>np.ndarray</em>) â€“ (N,)</p></li>
<li><p><strong>bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) â€“ Number of bins. Defaults to 20.</p></li>
<li><p><strong>adaptive</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) â€“ If False, bins are equal width ([0, 0.05, 0.1, â€¦, 1])
If True, bin widths are adaptive such that each bin contains the same number
of points. Defaults to False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.metrics.calibration.ece_classwise">
<span class="sig-prename descclassname"><span class="pre">pyhealth.metrics.calibration.</span></span><span class="sig-name descname"><span class="pre">ece_classwise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prob</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaptive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.metrics.calibration.ece_classwise" title="Permalink to this definition">#</a></dt>
<dd><p>Classwise Expected Calibration Error (ECE).</p>
<p>This is equivalent to applying <a class="reference internal" href="#pyhealth.metrics.calibration.ece_confidence_binary" title="pyhealth.metrics.calibration.ece_confidence_binary"><code class="xref py py-func docutils literal notranslate"><span class="pre">ece_confidence_binary()</span></code></a> to each class and take the average.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prob</strong> (<em>np.ndarray</em>) â€“ (N, C)</p></li>
<li><p><strong>label</strong> (<em>np.ndarray</em>) â€“ (N,)</p></li>
<li><p><strong>bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) â€“ Number of bins. Defaults to 20.</p></li>
<li><p><strong>threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) â€“ threshold to filter out samples.
If the number of classes C is very large, many classes receive close to 0
prediction. Any prediction below threshold is considered noise and ignored.
In recent papers, this is typically set to a small number (such as 1/C).</p></li>
<li><p><strong>adaptive</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) â€“ If False, bins are equal width ([0, 0.05, 0.1, â€¦, 1])
If True, bin widths are adaptive such that each bin contains the same number
of points. Defaults to False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.metrics.calibration.brier_top1">
<span class="sig-prename descclassname"><span class="pre">pyhealth.metrics.calibration.</span></span><span class="sig-name descname"><span class="pre">brier_top1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prob</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.metrics.calibration.brier_top1" title="Permalink to this definition">#</a></dt>
<dd><p>Brier score (i.e. mean squared error between prediction and 0-1 label) of the top prediction.</p>
</dd></dl>

</section>
<span id="document-api/metrics/pyhealth.metrics.prediction_set"></span><section id="module-pyhealth.metrics.prediction_set">
<span id="core-prediction-set"></span><h4>[core] prediction_set<a class="headerlink" href="#module-pyhealth.metrics.prediction_set" title="Permalink to this heading">#</a></h4>
<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.metrics.prediction_set.size">
<span class="sig-prename descclassname"><span class="pre">pyhealth.metrics.prediction_set.</span></span><span class="sig-name descname"><span class="pre">size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.metrics.prediction_set.size" title="Permalink to this definition">#</a></dt>
<dd><p>Average size of the prediction set.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.metrics.prediction_set.rejection_rate">
<span class="sig-prename descclassname"><span class="pre">pyhealth.metrics.prediction_set.</span></span><span class="sig-name descname"><span class="pre">rejection_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.metrics.prediction_set.rejection_rate" title="Permalink to this definition">#</a></dt>
<dd><p>Rejection rate, defined as the proportion of samples with prediction set size != 1</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.metrics.prediction_set.miscoverage_ps">
<span class="sig-prename descclassname"><span class="pre">pyhealth.metrics.prediction_set.</span></span><span class="sig-name descname"><span class="pre">miscoverage_ps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.metrics.prediction_set.miscoverage_ps" title="Permalink to this definition">#</a></dt>
<dd><p>Miscoverage rates for all samples (similar to recall).</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">error_ps</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">)</span>
<span class="go">array([0. , 0.5, 1. ])</span>
</pre></div>
</div>
<p>Explanation:
For class 0, the 1-th prediction set ({0}) contains the label, so the miss-coverage is 0/1=0.
For class 1, the 0-th prediction set ({0}) does not contain the label, the 2-th prediction
set ({0,1}) contains the label. Thus, the miss-coverage is 1/2=0.5.
For class 2, the last prediction set is {1} and the label is 2, so the miss-coverage is 1/1=1.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.metrics.prediction_set.error_ps">
<span class="sig-prename descclassname"><span class="pre">pyhealth.metrics.prediction_set.</span></span><span class="sig-name descname"><span class="pre">error_ps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.metrics.prediction_set.error_ps" title="Permalink to this definition">#</a></dt>
<dd><p>Miscoverage rates for unrejected samples, where rejection is defined to be sets with size !=1).</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">error_ps</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">)</span>
<span class="go">array([0., 1., 1.])</span>
</pre></div>
</div>
<p>Explanation:
For class 0, the 1-th sample is correct and not rejected, so the error is 0/1=0.
For class 1, the 0-th sample is incorrerct and not rejected, the 2-th is rejected.
Thus, the error is 1/1=1.
For class 2, the last sample is not-rejected but the prediction set is {1}, so the error
is 1/1=1.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.metrics.prediction_set.miscoverage_overall_ps">
<span class="sig-prename descclassname"><span class="pre">pyhealth.metrics.prediction_set.</span></span><span class="sig-name descname"><span class="pre">miscoverage_overall_ps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.metrics.prediction_set.miscoverage_overall_ps" title="Permalink to this definition">#</a></dt>
<dd><p>Miscoverage rate for the true label. Only for multiclass.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">miscoverage_overall_ps</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">)</span>
<span class="go">0.333333</span>
</pre></div>
</div>
<p>Explanation:
The 0-th prediction set is {0} and the label is 1 (not covered).
The 1-th prediction set is {0} and the label is 0 (covered).
The 2-th prediction set is {0,1} and the label is 1 (covered).
Thus the miscoverage rate is 1/3.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhealth.metrics.prediction_set.error_overall_ps">
<span class="sig-prename descclassname"><span class="pre">pyhealth.metrics.prediction_set.</span></span><span class="sig-name descname"><span class="pre">error_overall_ps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.metrics.prediction_set.error_overall_ps" title="Permalink to this definition">#</a></dt>
<dd><p>Overall error rate for the un-rejected samples.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">error_overall_ps</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">)</span>
<span class="go">0.5</span>
</pre></div>
</div>
<p>Explanation:
The 0-th prediction set is {0} and the label is 1, so it is an error (no rejection
as its prediction set has only one class).
The 1-th sample is not rejected and incurs on error.
The 2-th sample is rejected, thus excluded from the computation.</p>
</dd></dl>

</section>
<span id="document-api/metrics/pyhealth.metrics.fairness"></span><section id="pyhealth-metrics-fairness">
<h4>pyhealth.metrics.fairness<a class="headerlink" href="#pyhealth-metrics-fairness" title="Permalink to this heading">#</a></h4>
</section>
</div>
</section>
<span id="document-api/medcode"></span><section id="medcode">
<h3>MedCode<a class="headerlink" href="#medcode" title="Permalink to this heading">#</a></h3>
<p>We provide medical code mapping tools for (i) ontology mapping within one coding system and
(ii) mapping the same concept cross different coding systems.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyhealth.medcode.InnerMap">
<em class="property"><span class="pre">class</span><span class="w">  </span></em><span class="sig-prename descclassname"><span class="pre">pyhealth.medcode.</span></span><span class="sig-name descname"><span class="pre">InnerMap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vocabulary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refresh_cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.medcode.InnerMap" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>Contains information for a specific medical code system.</p>
<p><cite>InnerMap</cite> is a base abstract class for all medical code systems.
It will be instantiated as a specific medical code system with
<cite>InnerMap.load(vocabulary).</cite></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class cannot be instantiated using <cite>__init__()</cite> (throws an error).</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pyhealth.medcode.InnerMap.load">
<em class="property"><span class="pre">classmethod</span><span class="w">  </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vocabulary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refresh_cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.medcode.InnerMap.load" title="Permalink to this definition">#</a></dt>
<dd><p>Initializes a specific medical code system inheriting from <cite>InnerMap</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vocabulary</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) â€“ vocabulary name. E.g., â€œICD9CMâ€, â€œICD9PROCâ€.</p></li>
<li><p><strong>refresh_cache</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) â€“ whether to refresh the cache. Default is False.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.medcode</span><span class="w"> </span><span class="kn">import</span> <span class="n">InnerMap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">icd9cm</span> <span class="o">=</span> <span class="n">InnerMap</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;ICD9CM&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">icd9cm</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="s2">&quot;428.0&quot;</span><span class="p">)</span>
<span class="go">&#39;Congestive heart failure, unspecified&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">icd9cm</span><span class="o">.</span><span class="n">get_ancestors</span><span class="p">(</span><span class="s2">&quot;428.0&quot;</span><span class="p">)</span>
<span class="go">[&#39;428&#39;, &#39;420-429.99&#39;, &#39;390-459.99&#39;, &#39;001-999.99&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyhealth.medcode.InnerMap.available_attributes">
<em class="property"><span class="pre">property</span><span class="w">  </span></em><span class="sig-name descname"><span class="pre">available_attributes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w">  </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#pyhealth.medcode.InnerMap.available_attributes" title="Permalink to this definition">#</a></dt>
<dd><p>Returns a list of available attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of available attributes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyhealth.medcode.InnerMap.stat">
<span class="sig-name descname"><span class="pre">stat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.medcode.InnerMap.stat" title="Permalink to this definition">#</a></dt>
<dd><p>Prints statistics of the code system.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyhealth.medcode.InnerMap.standardize">
<em class="property"><span class="pre">static</span><span class="w">  </span></em><span class="sig-name descname"><span class="pre">standardize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">code</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.medcode.InnerMap.standardize" title="Permalink to this definition">#</a></dt>
<dd><p>Standardizes a given code.</p>
<p>Subclass will override this method based on different
medical code systems.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyhealth.medcode.InnerMap.convert">
<em class="property"><span class="pre">static</span><span class="w">  </span></em><span class="sig-name descname"><span class="pre">convert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">code</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.medcode.InnerMap.convert" title="Permalink to this definition">#</a></dt>
<dd><p>Converts a given code.</p>
<p>Subclass will override this method based on different
medical code systems.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyhealth.medcode.InnerMap.lookup">
<span class="sig-name descname"><span class="pre">lookup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attribute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'name'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.medcode.InnerMap.lookup" title="Permalink to this definition">#</a></dt>
<dd><p>Looks up the code.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>code</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) â€“ code to look up.</p></li>
<li><p><strong>attribute</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) â€“ attribute to look up. One of <cite>self.available_attributes</cite>.
Default is â€œnameâ€.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The attribute value of the code.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyhealth.medcode.InnerMap.get_ancestors">
<span class="sig-name descname"><span class="pre">get_ancestors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">code</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.medcode.InnerMap.get_ancestors" title="Permalink to this definition">#</a></dt>
<dd><p>Gets the ancestors of the code.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>code</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) â€“ code to look up.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of ancestors ordered from the closest to the farthest.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyhealth.medcode.InnerMap.get_descendants">
<span class="sig-name descname"><span class="pre">get_descendants</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">code</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.medcode.InnerMap.get_descendants" title="Permalink to this definition">#</a></dt>
<dd><p>Gets the descendants of the code.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>code</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) â€“ code to look up.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of ancestors ordered from the closest to the farthest.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyhealth.medcode.CrossMap">
<em class="property"><span class="pre">class</span><span class="w">  </span></em><span class="sig-prename descclassname"><span class="pre">pyhealth.medcode.</span></span><span class="sig-name descname"><span class="pre">CrossMap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_vocabulary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_vocabulary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refresh_cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.medcode.CrossMap" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Contains mapping between two medical code systems.</p>
<p><cite>CrossMap</cite> is a base class for all possible mappings. It will be
initialized with two specific medical code systems with
<cite>CrossMap.load(source_vocabulary, target_vocabulary)</cite>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyhealth.medcode.CrossMap.load">
<em class="property"><span class="pre">classmethod</span><span class="w">  </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_vocabulary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_vocabulary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refresh_cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.medcode.CrossMap.load" title="Permalink to this definition">#</a></dt>
<dd><p>Initializes the mapping between two medical code systems.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source_vocabulary</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) â€“ source medical code system.</p></li>
<li><p><strong>target_vocabulary</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) â€“ target medical code system.</p></li>
<li><p><strong>refresh_cache</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) â€“ whether to refresh the cache. Default is False.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyhealth.medcode</span><span class="w"> </span><span class="kn">import</span> <span class="n">CrossMap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mapping</span> <span class="o">=</span> <span class="n">CrossMap</span><span class="p">(</span><span class="s2">&quot;ICD9CM&quot;</span><span class="p">,</span> <span class="s2">&quot;CCSCM&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mapping</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="s2">&quot;428.0&quot;</span><span class="p">)</span>
<span class="go">[&#39;108&#39;]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mapping</span> <span class="o">=</span> <span class="n">CrossMap</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;NDC&quot;</span><span class="p">,</span> <span class="s2">&quot;ATC&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mapping</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="s2">&quot;00527051210&quot;</span><span class="p">,</span> <span class="n">target_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;level&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
<span class="go">[&#39;A11C&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyhealth.medcode.CrossMap.map">
<span class="sig-name descname"><span class="pre">map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.medcode.CrossMap.map" title="Permalink to this definition">#</a></dt>
<dd><p>Maps a source code to a list of target codes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source_code</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) â€“ source code.</p></li>
<li><p><strong>**source_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>]) â€“ additional arguments for the source code. Will be
passed to <cite>self.s_class.convert()</cite>. Default is empty dict.</p></li>
<li><p><strong>**target_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>]) â€“ additional arguments for the target code. Will be
passed to <cite>self.t_class.convert()</cite>. Default is empty dict.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of target codes.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<section id="diagnosis-codes">
<h4>Diagnosis codes:<a class="headerlink" href="#diagnosis-codes" title="Permalink to this heading">#</a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="pyhealth.medcode.ICD9CM">
<em class="property"><span class="pre">class</span><span class="w">  </span></em><span class="sig-prename descclassname"><span class="pre">pyhealth.medcode.</span></span><span class="sig-name descname"><span class="pre">ICD9CM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.medcode.ICD9CM" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyhealth.medcode.InnerMap" title="pyhealth.medcode.inner_map.InnerMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">InnerMap</span></code></a></p>
<p>9-th International Classification of Diseases, Clinical Modification.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyhealth.medcode.ICD9CM.standardize">
<em class="property"><span class="pre">static</span><span class="w">  </span></em><span class="sig-name descname"><span class="pre">standardize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">code</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.medcode.ICD9CM.standardize" title="Permalink to this definition">#</a></dt>
<dd><p>Standardizes ICD9CM code.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyhealth.medcode.ICD10CM">
<em class="property"><span class="pre">class</span><span class="w">  </span></em><span class="sig-prename descclassname"><span class="pre">pyhealth.medcode.</span></span><span class="sig-name descname"><span class="pre">ICD10CM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.medcode.ICD10CM" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyhealth.medcode.InnerMap" title="pyhealth.medcode.inner_map.InnerMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">InnerMap</span></code></a></p>
<p>10-th International Classification of Diseases, Clinical Modification.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyhealth.medcode.ICD10CM.standardize">
<em class="property"><span class="pre">static</span><span class="w">  </span></em><span class="sig-name descname"><span class="pre">standardize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">code</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.medcode.ICD10CM.standardize" title="Permalink to this definition">#</a></dt>
<dd><p>Standardizes ICD10CM code.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyhealth.medcode.CCSCM">
<em class="property"><span class="pre">class</span><span class="w">  </span></em><span class="sig-prename descclassname"><span class="pre">pyhealth.medcode.</span></span><span class="sig-name descname"><span class="pre">CCSCM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.medcode.CCSCM" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyhealth.medcode.InnerMap" title="pyhealth.medcode.inner_map.InnerMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">InnerMap</span></code></a></p>
<p>Classification of Diseases, Clinical Modification.</p>
</dd></dl>

</section>
<section id="procedure-codes">
<h4>Procedure codes:<a class="headerlink" href="#procedure-codes" title="Permalink to this heading">#</a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="pyhealth.medcode.ICD9PROC">
<em class="property"><span class="pre">class</span><span class="w">  </span></em><span class="sig-prename descclassname"><span class="pre">pyhealth.medcode.</span></span><span class="sig-name descname"><span class="pre">ICD9PROC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.medcode.ICD9PROC" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyhealth.medcode.InnerMap" title="pyhealth.medcode.inner_map.InnerMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">InnerMap</span></code></a></p>
<p>9-th International Classification of Diseases, Procedure.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyhealth.medcode.ICD9PROC.standardize">
<em class="property"><span class="pre">static</span><span class="w">  </span></em><span class="sig-name descname"><span class="pre">standardize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">code</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.medcode.ICD9PROC.standardize" title="Permalink to this definition">#</a></dt>
<dd><p>Standardizes ICD9PROC code.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyhealth.medcode.ICD10PROC">
<em class="property"><span class="pre">class</span><span class="w">  </span></em><span class="sig-prename descclassname"><span class="pre">pyhealth.medcode.</span></span><span class="sig-name descname"><span class="pre">ICD10PROC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.medcode.ICD10PROC" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyhealth.medcode.InnerMap" title="pyhealth.medcode.inner_map.InnerMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">InnerMap</span></code></a></p>
<p>10-th International Classification of Diseases, Procedure.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyhealth.medcode.CCSPROC">
<em class="property"><span class="pre">class</span><span class="w">  </span></em><span class="sig-prename descclassname"><span class="pre">pyhealth.medcode.</span></span><span class="sig-name descname"><span class="pre">CCSPROC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.medcode.CCSPROC" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyhealth.medcode.InnerMap" title="pyhealth.medcode.inner_map.InnerMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">InnerMap</span></code></a></p>
<p>Classification of Diseases, Procedure.</p>
</dd></dl>

</section>
<section id="medication-codes">
<h4>Medication codes:<a class="headerlink" href="#medication-codes" title="Permalink to this heading">#</a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="pyhealth.medcode.NDC">
<em class="property"><span class="pre">class</span><span class="w">  </span></em><span class="sig-prename descclassname"><span class="pre">pyhealth.medcode.</span></span><span class="sig-name descname"><span class="pre">NDC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.medcode.NDC" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyhealth.medcode.InnerMap" title="pyhealth.medcode.inner_map.InnerMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">InnerMap</span></code></a></p>
<p>National Drug Code.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyhealth.medcode.RxNorm">
<em class="property"><span class="pre">class</span><span class="w">  </span></em><span class="sig-prename descclassname"><span class="pre">pyhealth.medcode.</span></span><span class="sig-name descname"><span class="pre">RxNorm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.medcode.RxNorm" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyhealth.medcode.InnerMap" title="pyhealth.medcode.inner_map.InnerMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">InnerMap</span></code></a></p>
<p>RxNorm.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyhealth.medcode.ATC">
<em class="property"><span class="pre">class</span><span class="w">  </span></em><span class="sig-prename descclassname"><span class="pre">pyhealth.medcode.</span></span><span class="sig-name descname"><span class="pre">ATC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.medcode.ATC" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyhealth.medcode.InnerMap" title="pyhealth.medcode.inner_map.InnerMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">InnerMap</span></code></a></p>
<p>Anatomical Therapeutic Chemical.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyhealth.medcode.ATC.convert">
<em class="property"><span class="pre">static</span><span class="w">  </span></em><span class="sig-name descname"><span class="pre">convert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.medcode.ATC.convert" title="Permalink to this definition">#</a></dt>
<dd><p>Convert ATC code to a specific level.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyhealth.medcode.ATC.get_ddi">
<span class="sig-name descname"><span class="pre">get_ddi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gamenet_ddi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refresh_cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyhealth.medcode.ATC.get_ddi" title="Permalink to this definition">#</a></dt>
<dd><p>Gets the drug-drug interactions (DDI).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gamenet_ddi</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) â€“ Whether to use the DDI from the GAMENet paper,
which is a subset of the DDI from the ATC.</p></li>
<li><p><strong>refresh_cache</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) â€“ Whether to refresh the cache. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<span id="document-api/calib"></span><section id="calibration-and-uncertainty-quantification">
<h3>Calibration and Uncertainty Quantification<a class="headerlink" href="#calibration-and-uncertainty-quantification" title="Permalink to this heading">#</a></h3>
<p>In this module, we implemented the following prediction
set constructors or model calibration methods, which can be
combined with any PyHealth models.</p>
<div class="toctree-wrapper compound">
<span id="document-api/calib/pyhealth.calib.calibration"></span><section id="pyhealth-calib-calibration">
<h4>pyhealth.calib.calibration<a class="headerlink" href="#pyhealth-calib-calibration" title="Permalink to this heading">#</a></h4>
</section>
<span id="document-api/calib/pyhealth.calib.predictionset"></span><section id="pyhealth-calib-predictionset">
<h4>pyhealth.calib.predictionset<a class="headerlink" href="#pyhealth-calib-predictionset" title="Permalink to this heading">#</a></h4>
</section>
</div>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-live"></span><section id="pyhealth-webinar-4-9-25">
<h3>PyHealth Webinar 4/9/25<a class="headerlink" href="#pyhealth-webinar-4-9-25" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p><strong>Start Time</strong>: 2 PM Central Time, Wednesday</p>
<p><strong>Recurrence</strong>: There are no repeat sessions for now.</p>
<p><strong>Zoom</strong>: <a class="reference external" href="https://illinois.zoom.us/j/88033880443?pwd=QzgyekNVVkswNkVKNEFjL3hHRXRIdz09">Join Link</a></p>
<p><strong>YouTube</strong>: <a class="reference external" href="https://www.youtube.com/playlist?list=PLR3CNIF8DDHJUl8RLhyOVpX_kT4bxulEV">Recorded Live Sessions</a></p>
<p><strong>User/Developer Discord</strong>: <a class="reference external" href="https://discord.gg/Fkj7Wn23">Click to join</a></p>
</div></blockquote>
<section id="past-scheduled-videos">
<h4>Past Scheduled Videos<a class="headerlink" href="#past-scheduled-videos" title="Permalink to this heading">#</a></h4>
<blockquote>
<div><p><strong>(Dec 21, 2022)</strong> Live 01 - What is PyHealth and How to Get Started? <a class="reference external" href="https://www.youtube.com/watch?v=1Ir6hzU4Nro&amp;list=PLR3CNIF8DDHJUl8RLhyOVpX_kT4bxulEV&amp;index=1">[Recap]</a></p>
<p><strong>(Dec 28, 2022)</strong> Live 02 - Data &amp; Datasets &amp; Tasks: store unstructured data in an structured way. <a class="reference external" href="https://www.youtube.com/watch?v=Nk1itBoLOX8&amp;list=PLR3CNIF8DDHJUl8RLhyOVpX_kT4bxulEV&amp;index=2">[Recap I]</a> <a class="reference external" href="https://www.youtube.com/watch?v=c1InKqFJbsI&amp;list=PLR3CNIF8DDHJUl8RLhyOVpX_kT4bxulEV&amp;index=3">[II]</a> <a class="reference external" href="https://www.youtube.com/watch?v=CxESe1gYWU4&amp;list=PLR3CNIF8DDHJUl8RLhyOVpX_kT4bxulEV&amp;index=4">[III]</a> <a class="reference external" href="https://www.youtube.com/watch?v=Gdmj0P5Yk-w&amp;list=PLR3CNIF8DDHJUl8RLhyOVpX_kT4bxulEV&amp;index=5">[IV]</a></p>
<p><strong>(Jan 4, 2023)</strong> Live 03 - Models &amp; Trainer &amp; Metrics: initialize and train a deep learning model. <a class="reference external" href="https://www.youtube.com/watch?v=fRc0ncbTgZA&amp;list=PLR3CNIF8DDHJUl8RLhyOVpX_kT4bxulEV&amp;index=6">[Recap I]</a> <a class="reference external" href="https://www.youtube.com/watch?v=5Hyw3of5pO4&amp;list=PLR3CNIF8DDHJUl8RLhyOVpX_kT4bxulEV&amp;index=7">[II]</a> <a class="reference external" href="https://www.youtube.com/watch?v=d-Kx_xCwre4&amp;list=PLR3CNIF8DDHJUl8RLhyOVpX_kT4bxulEV&amp;index=8">[III]</a></p>
<p><strong>(Jan 11, 2023)</strong> Live 04 - Tokenizer &amp; Medcode: master the medical code lookup and mapping <a class="reference external" href="https://www.youtube.com/watch?v=MmmfU6_xkYg&amp;list=PLR3CNIF8DDHJUl8RLhyOVpX_kT4bxulEV&amp;index=9">[Recap I]</a> <a class="reference external" href="https://www.youtube.com/watch?v=CeXJtf0lfs0&amp;list=PLR3CNIF8DDHJUl8RLhyOVpX_kT4bxulEV&amp;index=10">[II]</a></p>
<p><strong>(Jan 18, 2023)</strong> Live 05 - PyHealth can support a complete healthcare ML pipeline <a class="reference external" href="https://www.youtube.com/watch?v=GVLzc6E4og0&amp;list=PLR3CNIF8DDHJUl8RLhyOVpX_kT4bxulEV&amp;index=11">[Recap I]</a> <a class="reference external" href="https://www.youtube.com/watch?v=GGP3Dhfyisc&amp;list=PLR3CNIF8DDHJUl8RLhyOVpX_kT4bxulEV&amp;index=12">[II]</a></p>
<p><strong>(Jan 25, 2023)</strong> Live 06 - Fit your own dataset into pipeline and use our model <a class="reference external" href="https://www.youtube.com/watch?v=xw2hGLEQ4Y0">[Recap]</a></p>
<p><strong>(Feb 1, 2023)</strong> Live 07 - Adopt your customized model and quickly try it on our data <a class="reference external" href="https://www.youtube.com/watch?v=lADFlcmLtdE">[Recap]</a></p>
<p><strong>(Feb 8, 2023)</strong> Live 08 - New feature: support for biosignal data (EEG, ECG, etc.) classification <a class="reference external" href="https://www.youtube.com/watch?v=D1VbiJlDf98&amp;list=PLR3CNIF8DDHJUl8RLhyOVpX_kT4bxulEV&amp;index=15">[Recap I]</a> <a class="reference external" href="https://www.youtube.com/watch?v=ySAIU-rO6so&amp;list=PLR3CNIF8DDHJUl8RLhyOVpX_kT4bxulEV&amp;index=16">[II]</a></p>
<p><strong>(Feb 15, 2023)</strong> Live 09 - New feature: parallel and faster data loading architecture</p>
<p><strong>(Feb 22, 2023)</strong> Live 10 - Add a covid prediction benchmark (new datasets, new models)</p>
</div></blockquote>
</section>
</section>
<span id="document-log"></span><section id="development-logs">
<h3>Development logs<a class="headerlink" href="#development-logs" title="Permalink to this heading">#</a></h3>
<p>We track the new development here:</p>
<p><strong>Dec 29, 2023</strong></p>
<p>..code-blocks:: rst</p>
<blockquote>
<div><p>1. add GAN models and demos in pyhealth PR #256
2.</p>
</div></blockquote>
<p><strong>Dec 20, 2023</strong></p>
<p>..code-blocks:: rst</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>add graph neural network models for drug recommendation in PR #251</p></li>
<li><p>add regression_metrics_fn for some unsupervised learning tasks.</p></li>
<li><p>add VAE models in pyhealth PR #253</p></li>
</ol>
</div></blockquote>
<p><strong>Nov 28, 2023</strong></p>
<p>..code-blocks:: rst</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>fix ddi metric calculation error raised by issue #249.</p></li>
</ol>
</div></blockquote>
<p><strong>Nov 24, 2023</strong></p>
<p>..code-blocks:: rst</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>add ddi metrics to multilabel_metrics_fn per issue #247</p></li>
<li><p>add medlink as a new medical record link pipeline in PR #240</p></li>
<li><p>add chefer transformer in PR #239</p></li>
<li><p>add KG embedding in PR #234</p></li>
<li><p>add LLM for Pyhealth in PR #231</p></li>
</ol>
</div></blockquote>
<p><strong>Sep 01, 2023</strong></p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="m">1.</span> add Base fairness metrics and example <span class="nv">`#216`</span>.
</pre></div>
</div>
<p><strong>July 22, 2023</strong></p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="m">1.</span> add Temple University TUEV and TUAB two datasets in <span class="nv">`#194`</span>.
<span class="m">2.</span> add the EEG six event detection and abnormal EEG detection tasks.
</pre></div>
</div>
<p><strong>July 1, 2023</strong></p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="m">1.</span> add six ECG datasets: &quot;cpsc_2018&quot;, &quot;cpsc_2018_extra&quot;, &quot;georgia&quot;, &quot;ptb&quot;, &quot;ptb-xl&quot;, &quot;st_petersburg_incart&quot; (from
    PhysioNet Cardiology Challenge 2020 https://physionet.org/content/challenge-2020/1.0.2/ <span class="nv">`#176`</span>
<span class="m">2.</span> add ECG binary classification tasks (for five symptom categories: Arrhythmias symptom, Bundle branch blocks and fascicular blocks symptom,
    Axis deviations symptom, Conduction delays symptom, Wave abnormalities symptom) <span class="nv">`#176`</span>
</pre></div>
</div>
<p><strong>May 31, 2023</strong></p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="m">1.</span> add SHHS dataset and its sleep staging task.
</pre></div>
</div>
<p><strong>May 25, 2023</strong></p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="m">1.</span> add dirichlet calibration <span class="nv">`PR #159`</span>
</pre></div>
</div>
<p><strong>May 9, 2023</strong></p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="m">1.</span> add MIMIC-Extract dataset  <span class="nv">`#136`</span>
<span class="m">2.</span> add new maintainer members for pyhealth: Junyi Gao and Benjamin Danek
</pre></div>
</div>
<p><strong>May 6, 2023</strong></p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="m">1.</span> add new parser functions (admissionDx, diagnosisStrings) and prediction tasks for eICU dataset <span class="nv">`#148`</span>
</pre></div>
</div>
<p><strong>Apr 27, 2023</strong></p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="m">1.</span> add MoleRec model (WWW&#39;23) for drug recommendation <span class="nv">`#122`</span>
</pre></div>
</div>
<p><strong>Apr 26, 2023</strong></p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="m">1.</span> fix bugs in GRASP model <span class="nv">`#141`</span>
<span class="m">2.</span> add pandas install &lt;2 constraints <span class="nv">`#135`</span>
<span class="m">3.</span> add hcpcsevents table process in MIMIC4 dataset <span class="nv">`#134`</span>
</pre></div>
</div>
<p><strong>Apr 10, 2023</strong></p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="m">1.</span> fix Ambiguous datetime usage in eICU (https://github.com/sunlabuiuc/PyHealth/pull/132)
</pre></div>
</div>
<p><strong>Mar 26, 2023</strong></p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="m">1.</span> add the entire uncertainty quantification module (https://github.com/sunlabuiuc/PyHealth/pull/111)
</pre></div>
</div>
<p><strong>Feb 26, 2023</strong></p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="m">1.</span> add 6 EHR predictiom model: Adacare, Concare, Stagenet, TCN, Grasp, Agent
</pre></div>
</div>
<p><strong>Feb 24, 2023</strong></p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="m">1.</span> add unittest for omop dataset
<span class="m">2.</span> add github action triggered manually, check <span class="nv">`#104`</span>
</pre></div>
</div>
<p><strong>Feb 19, 2023</strong></p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="m">1.</span> add unittest for eicu dataset
<span class="m">2.</span> add ISRUC dataset (and task function) for signal learning
</pre></div>
</div>
<p><strong>Feb 12, 2023</strong></p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="m">1.</span> add unittest for mimiciii, mimiciv
<span class="m">2.</span> add SHHS datasets for sleep staging task
<span class="m">3.</span> add SparcNet model for signal classification task
</pre></div>
</div>
<p><strong>Feb 08, 2023</strong></p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="m">1.</span> complete the biosignal data support, add ContraWR [1] model for general purpose biosignal classification task ([1] Yang, Chaoqi, Danica Xiao, M. Brandon Westover, and Jimeng Sun.
    &quot;Self-supervised eeg representation learning for automatic sleep staging.&quot;
    arXiv preprint arXiv:2110.15278 (2021).)
</pre></div>
</div>
<p><strong>Feb 07, 2023</strong></p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="m">1.</span> Support signal dataset processing and split: add SampleSignalDataset, BaseSignalDataset. Use SleepEDFcassette dataset as the first signal dataset. Use example/sleep_staging_sleepEDF_contrawr.py
<span class="m">2.</span> rename the dataset/ parts: previous BaseDataset becomes BaseEHRDataset and SampleDatast becomes SampleEHRDataset. Right now, BaseDataset will be inherited by BaseEHRDataset and BaseSignalDataset. SampleBaseDataset will be inherited by SampleEHRDataset and SampleSignalDataset.
</pre></div>
</div>
<p><strong>Feb 06, 2023</strong></p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="m">1.</span> improve readme style
<span class="m">2.</span> add the pyhealth live 06 and 07 link to pyhealth live
</pre></div>
</div>
<p><strong>Feb 01, 2023</strong></p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="m">1.</span> add unittest of PyHealth MedCode and Tokenizer
</pre></div>
</div>
<p><strong>Jan 26, 2023</strong></p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="m">1.</span> accelerate MIMIC-IV, eICU and OMOP data loading by using multiprocessing (pandarallel)
</pre></div>
</div>
<p><strong>Jan 25, 2023</strong></p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="m">1.</span> accelerate the MIMIC-III data loading process by using multiprocessing (pandarallel)
</pre></div>
</div>
<p><strong>Jan 24, 2023</strong></p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="m">1.</span> Fix the code typo in pyhealth/tasks/drug_recommendation.py for issue <span class="nv">`#71`</span>.
<span class="m">2.</span> update the pyhealth live schedule
</pre></div>
</div>
<p><strong>Jan 22, 2023</strong></p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="m">1.</span> Fix the list of list of vector problem in RNN, Transformer, RETAIN, and CNN
<span class="m">2.</span> Add initialization examples for RNN, Transformer, RETAIN, CNN, and Deepr
<span class="m">3.</span> (minor) change the parameters from &quot;Type&quot; and &quot;level&quot; to &quot;type_&quot; and &quot;dim_&quot;
<span class="m">4.</span> BPDanek adds the &quot;__repr__&quot; function to medcode for better print understanding
<span class="m">5.</span> add unittest for pyhealth.data
</pre></div>
</div>
<p><strong>Jan 21, 2023</strong></p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="m">1.</span> Added a new model, Deepr (models.Deepr)
</pre></div>
</div>
<p><strong>Jan 20, 2023</strong></p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="m">1.</span> add the pyhealth live 05
<span class="m">2.</span> add slack channel invitation in pyhealth live page
</pre></div>
</div>
<p><strong>Jan 13, 2023</strong></p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="m">1.</span> add the pyhealth live 03 and 04 video link to the nagivation
<span class="m">2.</span> add future pyhealth live schedule
</pre></div>
</div>
<p><strong>Jan 8, 2023</strong></p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="m">1.</span> Changed BaseModel.add_feature_transform_layer in models/base_model.py so that it accepts special_tokens if necessary
<span class="m">2.</span> fix an int/float bug in dataset checking (transform int to float and then process them uniformly)
</pre></div>
</div>
<p><strong>Dec 26, 2022</strong></p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="m">1.</span> add examples to pyhealth.data, pyhealth.datasets
<span class="m">2.</span> improve jupyter notebook tutorials 0, 1, 2
</pre></div>
</div>
<p><strong>Dec 21, 2022</strong></p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="m">1.</span> add the development logs to the navigation
<span class="m">2.</span> add the pyhealth live schedule to the nagivation
</pre></div>
</div>
</section>
<span id="document-about"></span><section id="about-us">
<h3>About us<a class="headerlink" href="#about-us" title="Permalink to this heading">#</a></h3>
<p>We are the <a class="reference external" href="http://sunlab.org/">SunLab</a> healthcare research team at UIUC.</p>
<p><a class="reference external" href="https://zzachw.github.io/">*Zhenbang Wu</a> (Ph.D. Student &#64; University of Illinois Urbana-Champaign)</p>
<p><a class="reference external" href="https://ycq091044.github.io//">*Chaoqi Yang</a> (Ph.D. Student &#64; University of Illinois Urbana-Champaign)</p>
<p><a class="reference external" href="https://www.linkedin.com/in/patrick-j-3492b4235/">Patrick Jiang</a> (M.S. Student &#64; University of Illinois Urbana-Champaign)</p>
<p><a class="reference external" href="https://zlin7.github.io/">Zhen Lin</a> (Ph.D. Student &#64; University of Illinois Urbana-Champaign)</p>
<p><a class="reference external" href="http://aboutme.vixerunt.org/">Junyi Gao</a> (M.S. Student &#64; UIUC, Ph.D. Student &#64; University of Edinburgh)</p>
<p><a class="reference external" href="https://bpdanek.github.io/">Benjamin Danek</a> (M.S. Student &#64; University of Illinois Urbana-Champaign)</p>
<p><a class="reference external" href="http://sunlab.org/">Jimeng Sun</a> (Professor &#64; University of Illinois Urbana-Champaign)</p>
<p>(* indicates equal contribution)</p>
</section>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, PyHealth Team
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-install">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-tutorials">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-advance_tutorials">Advanced Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-api/data">Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/data/pyhealth.data.Event">pyhealth.data.Event</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.data.Event"><code class="docutils literal notranslate"><span class="pre">Event</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="index.html#pyhealth.data.Event.event_type"><code class="docutils literal notranslate"><span class="pre">Event.event_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#pyhealth.data.Event.timestamp"><code class="docutils literal notranslate"><span class="pre">Event.timestamp</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#pyhealth.data.Event.attr_dict"><code class="docutils literal notranslate"><span class="pre">Event.attr_dict</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#id0"><code class="docutils literal notranslate"><span class="pre">Event.event_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#id1"><code class="docutils literal notranslate"><span class="pre">Event.timestamp</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#id2"><code class="docutils literal notranslate"><span class="pre">Event.attr_dict</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#pyhealth.data.Event.from_dict"><code class="docutils literal notranslate"><span class="pre">Event.from_dict()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/data/pyhealth.data.Patient">pyhealth.data.Patient</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.data.Patient"><code class="docutils literal notranslate"><span class="pre">Patient</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="index.html#pyhealth.data.Patient.patient_id"><code class="docutils literal notranslate"><span class="pre">Patient.patient_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#pyhealth.data.Patient.data_source"><code class="docutils literal notranslate"><span class="pre">Patient.data_source</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#pyhealth.data.Patient.get_events"><code class="docutils literal notranslate"><span class="pre">Patient.get_events()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-api/datasets">Datasets</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/datasets/pyhealth.datasets.BaseDataset">pyhealth.datasets.BaseDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/datasets/pyhealth.datasets.SampleDataset">pyhealth.datasets.SampleDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/datasets/pyhealth.datasets.MIMIC3Dataset">pyhealth.datasets.MIMIC3Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/datasets/pyhealth.datasets.MIMIC4Dataset">pyhealth.datasets.MIMIC4Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/datasets/pyhealth.datasets.MedicalTranscriptionsDataset">pyhealth.datasets.MedicalTranscriptionsDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/datasets/pyhealth.datasets.CardiologyDataset">pyhealth.datasets.CardiologyDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/datasets/pyhealth.datasets.eICUDataset">pyhealth.datasets.eICUDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/datasets/pyhealth.datasets.ISRUCDataset">pyhealth.datasets.ISRUCDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/datasets/pyhealth.datasets.MIMICExtractDataset">pyhealth.datasets.MIMICExtractDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/datasets/pyhealth.datasets.OMOPDataset">pyhealth.datasets.OMOPDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/datasets/pyhealth.datasets.SHHSDataset">pyhealth.datasets.SHHSDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/datasets/pyhealth.datasets.SleepEDFDataset">pyhealth.datasets.SleepEDFDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/datasets/pyhealth.datasets.TUABDataset">pyhealth.datasets.TUABDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/datasets/pyhealth.datasets.TUEVDataset">pyhealth.datasets.TUEVDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/datasets/pyhealth.datasets.splitter">pyhealth.datasets.splitter</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/datasets/pyhealth.datasets.utils">pyhealth.datasets.utils</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-api/tasks">Tasks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.BaseTask">pyhealth.tasks.BaseTask</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.Readmission30DaysMIMIC4">pyhealth.tasks.Readmission30DaysMIMIC4</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.InHospitalMortalityMIMIC4">pyhealth.tasks.EEG_evInHospitalMortalityMIMIC4ents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.InHospitalMortalityMIMIC4.task_name"><code class="docutils literal notranslate"><span class="pre">task_name</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.InHospitalMortalityMIMIC4.input_schema"><code class="docutils literal notranslate"><span class="pre">input_schema</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.InHospitalMortalityMIMIC4.output_schema"><code class="docutils literal notranslate"><span class="pre">output_schema</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.MIMIC3ICD9Coding">pyhealth.tasks.MIMIC3ICD9Coding</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.cardiology_detect">pyhealth.tasks.cardiology_detect</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.cardiology_detect.cardiology_isAR_fn"><code class="docutils literal notranslate"><span class="pre">cardiology_isAR_fn()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.cardiology_detect.cardiology_isBBBFB_fn"><code class="docutils literal notranslate"><span class="pre">cardiology_isBBBFB_fn()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.cardiology_detect.cardiology_isAD_fn"><code class="docutils literal notranslate"><span class="pre">cardiology_isAD_fn()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.cardiology_detect.cardiology_isCD_fn"><code class="docutils literal notranslate"><span class="pre">cardiology_isCD_fn()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.cardiology_detect.cardiology_isWA_fn"><code class="docutils literal notranslate"><span class="pre">cardiology_isWA_fn()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.COVID19CXRClassification">pyhealth.tasks.COVID19CXRClassification</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.COVID19CXRClassification.task_name"><code class="docutils literal notranslate"><span class="pre">task_name</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.COVID19CXRClassification.input_schema"><code class="docutils literal notranslate"><span class="pre">input_schema</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.COVID19CXRClassification.output_schema"><code class="docutils literal notranslate"><span class="pre">output_schema</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.drug_recommendation">pyhealth.tasks.drug_recommendation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.drug_recommendation.drug_recommendation_mimic3_fn"><code class="docutils literal notranslate"><span class="pre">drug_recommendation_mimic3_fn()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.drug_recommendation.drug_recommendation_mimic4_fn"><code class="docutils literal notranslate"><span class="pre">drug_recommendation_mimic4_fn()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.drug_recommendation.drug_recommendation_eicu_fn"><code class="docutils literal notranslate"><span class="pre">drug_recommendation_eicu_fn()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.drug_recommendation.drug_recommendation_omop_fn"><code class="docutils literal notranslate"><span class="pre">drug_recommendation_omop_fn()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.EEG_abnormal">pyhealth.tasks.EEG_abnormal</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.EEG_abnormal.EEG_isAbnormal_fn"><code class="docutils literal notranslate"><span class="pre">EEG_isAbnormal_fn()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.EEG_events">pyhealth.tasks.EEG_events</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.EEG_events.EEG_events_fn"><code class="docutils literal notranslate"><span class="pre">EEG_events_fn()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.EEG_events.BuildEvents"><code class="docutils literal notranslate"><span class="pre">BuildEvents()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.EEG_events.convert_signals"><code class="docutils literal notranslate"><span class="pre">convert_signals()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.EEG_events.readEDF"><code class="docutils literal notranslate"><span class="pre">readEDF()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.length_of_stay_prediction">pyhealth.tasks.length_of_stay_prediction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.length_of_stay_prediction.categorize_los"><code class="docutils literal notranslate"><span class="pre">categorize_los()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.length_of_stay_prediction.length_of_stay_prediction_mimic3_fn"><code class="docutils literal notranslate"><span class="pre">length_of_stay_prediction_mimic3_fn()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.length_of_stay_prediction.length_of_stay_prediction_mimic4_fn"><code class="docutils literal notranslate"><span class="pre">length_of_stay_prediction_mimic4_fn()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.length_of_stay_prediction.length_of_stay_prediction_eicu_fn"><code class="docutils literal notranslate"><span class="pre">length_of_stay_prediction_eicu_fn()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.length_of_stay_prediction.length_of_stay_prediction_omop_fn"><code class="docutils literal notranslate"><span class="pre">length_of_stay_prediction_omop_fn()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.MedicalTranscriptionsClassification">pyhealth.tasks.MedicalTranscriptionsClassification</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.MedicalTranscriptionsClassification.task_name"><code class="docutils literal notranslate"><span class="pre">task_name</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.MedicalTranscriptionsClassification.input_schema"><code class="docutils literal notranslate"><span class="pre">input_schema</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.MedicalTranscriptionsClassification.output_schema"><code class="docutils literal notranslate"><span class="pre">output_schema</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.mortality_prediction">pyhealth.tasks.mortality_prediction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.mortality_prediction.mortality_prediction_mimic3_fn"><code class="docutils literal notranslate"><span class="pre">mortality_prediction_mimic3_fn()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.mortality_prediction.mortality_prediction_mimic4_fn"><code class="docutils literal notranslate"><span class="pre">mortality_prediction_mimic4_fn()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.mortality_prediction.mortality_prediction_eicu_fn"><code class="docutils literal notranslate"><span class="pre">mortality_prediction_eicu_fn()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.mortality_prediction.mortality_prediction_eicu_fn2"><code class="docutils literal notranslate"><span class="pre">mortality_prediction_eicu_fn2()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.mortality_prediction.mortality_prediction_omop_fn"><code class="docutils literal notranslate"><span class="pre">mortality_prediction_omop_fn()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.patient_linkage_mimic3_fn">pyhealth.tasks.patient_linkage_mimic3_fn</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.readmission_prediction">pyhealth.tasks.readmission_prediction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.readmission_prediction.readmission_prediction_mimic3_fn"><code class="docutils literal notranslate"><span class="pre">readmission_prediction_mimic3_fn()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.readmission_prediction.readmission_prediction_mimic4_fn"><code class="docutils literal notranslate"><span class="pre">readmission_prediction_mimic4_fn()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.readmission_prediction.readmission_prediction_eicu_fn"><code class="docutils literal notranslate"><span class="pre">readmission_prediction_eicu_fn()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.readmission_prediction.readmission_prediction_eicu_fn2"><code class="docutils literal notranslate"><span class="pre">readmission_prediction_eicu_fn2()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.readmission_prediction.readmission_prediction_omop_fn"><code class="docutils literal notranslate"><span class="pre">readmission_prediction_omop_fn()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.sleep_staging">pyhealth.tasks.sleep_staging</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.sleep_staging.sleep_staging_isruc_fn"><code class="docutils literal notranslate"><span class="pre">sleep_staging_isruc_fn()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.sleep_staging.sleep_staging_sleepedf_fn"><code class="docutils literal notranslate"><span class="pre">sleep_staging_sleepedf_fn()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.sleep_staging.sleep_staging_shhs_fn"><code class="docutils literal notranslate"><span class="pre">sleep_staging_shhs_fn()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.SleepStagingSleepEDF">pyhealth.tasks.SleepStagingSleepEDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/tasks/pyhealth.tasks.temple_university_EEG_tasks">pyhealth.tasks.temple_university_EEG_tasks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.temple_university_EEG_tasks.EEG_isAbnormal_fn"><code class="docutils literal notranslate"><span class="pre">EEG_isAbnormal_fn()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.temple_university_EEG_tasks.EEG_events_fn"><code class="docutils literal notranslate"><span class="pre">EEG_events_fn()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.temple_university_EEG_tasks.BuildEvents"><code class="docutils literal notranslate"><span class="pre">BuildEvents()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.temple_university_EEG_tasks.convert_signals"><code class="docutils literal notranslate"><span class="pre">convert_signals()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tasks.temple_university_EEG_tasks.readEDF"><code class="docutils literal notranslate"><span class="pre">readEDF()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-api/models">Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.BaseModel">pyhealth.models.BaseModel</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.MLP">pyhealth.models.MLP</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.CNN">pyhealth.models.CNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.RNN">pyhealth.models.RNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.GNN">pyhealth.models.GNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.Transformer">pyhealth.models.Transformer</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.TransformersModel">pyhealth.models.TransformersModel</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.RETAIN">pyhealth.models.RETAIN</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.GAMENet">pyhealth.models.GAMENet</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.MICRON">pyhealth.models.MICRON</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.SafeDrug">pyhealth.models.SafeDrug</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.MoleRec">pyhealth.models.MoleRec</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.Deepr">pyhealth.models.Deepr</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.ContraWR">pyhealth.models.ContraWR</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.SparcNet">pyhealth.models.SparcNet</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.StageNet">pyhealth.models.StageNet</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.AdaCare">pyhealth.models.AdaCare</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.ConCare">pyhealth.models.ConCare</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.Agent">pyhealth.models.Agent</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.GRASP">pyhealth.models.GRASP</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.MedLink">pyhealth.models.MedLink</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.TCN">pyhealth.models.TCN</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.GAN">pyhealth.models.GAN</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/models/pyhealth.models.VAE">pyhealth.models.VAE</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-api/trainer">Trainer</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#pyhealth.trainer.Trainer"><code class="docutils literal notranslate"><span class="pre">Trainer</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.trainer.Trainer.train"><code class="docutils literal notranslate"><span class="pre">Trainer.train()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.trainer.Trainer.inference"><code class="docutils literal notranslate"><span class="pre">Trainer.inference()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.trainer.Trainer.evaluate"><code class="docutils literal notranslate"><span class="pre">Trainer.evaluate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.trainer.Trainer.save_ckpt"><code class="docutils literal notranslate"><span class="pre">Trainer.save_ckpt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.trainer.Trainer.load_ckpt"><code class="docutils literal notranslate"><span class="pre">Trainer.load_ckpt()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-api/tokenizer">Tokenizer</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#pyhealth.tokenizer.Vocabulary"><code class="docutils literal notranslate"><span class="pre">Vocabulary</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tokenizer.Vocabulary.add_token"><code class="docutils literal notranslate"><span class="pre">Vocabulary.add_token()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#pyhealth.tokenizer.Tokenizer"><code class="docutils literal notranslate"><span class="pre">Tokenizer</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tokenizer.Tokenizer.get_padding_index"><code class="docutils literal notranslate"><span class="pre">Tokenizer.get_padding_index()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tokenizer.Tokenizer.get_vocabulary_size"><code class="docutils literal notranslate"><span class="pre">Tokenizer.get_vocabulary_size()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tokenizer.Tokenizer.convert_tokens_to_indices"><code class="docutils literal notranslate"><span class="pre">Tokenizer.convert_tokens_to_indices()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tokenizer.Tokenizer.convert_indices_to_tokens"><code class="docutils literal notranslate"><span class="pre">Tokenizer.convert_indices_to_tokens()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tokenizer.Tokenizer.batch_encode_2d"><code class="docutils literal notranslate"><span class="pre">Tokenizer.batch_encode_2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tokenizer.Tokenizer.batch_decode_2d"><code class="docutils literal notranslate"><span class="pre">Tokenizer.batch_decode_2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tokenizer.Tokenizer.batch_encode_3d"><code class="docutils literal notranslate"><span class="pre">Tokenizer.batch_encode_3d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.tokenizer.Tokenizer.batch_decode_3d"><code class="docutils literal notranslate"><span class="pre">Tokenizer.batch_decode_3d()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-api/metrics">Metrics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/metrics/pyhealth.metrics.multiclass">pyhealth.metrics.multiclass</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.metrics.multiclass.multiclass_metrics_fn"><code class="docutils literal notranslate"><span class="pre">multiclass_metrics_fn()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/metrics/pyhealth.metrics.multilabel">pyhealth.metrics.multilabel</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.metrics.multilabel.multilabel_metrics_fn"><code class="docutils literal notranslate"><span class="pre">multilabel_metrics_fn()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/metrics/pyhealth.metrics.binary">pyhealth.metrics.binary</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.metrics.binary.binary_metrics_fn"><code class="docutils literal notranslate"><span class="pre">binary_metrics_fn()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/metrics/pyhealth.metrics.calibration">[core] calibration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.metrics.calibration.ece_confidence_multiclass"><code class="docutils literal notranslate"><span class="pre">ece_confidence_multiclass()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.metrics.calibration.ece_confidence_binary"><code class="docutils literal notranslate"><span class="pre">ece_confidence_binary()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.metrics.calibration.ece_classwise"><code class="docutils literal notranslate"><span class="pre">ece_classwise()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.metrics.calibration.brier_top1"><code class="docutils literal notranslate"><span class="pre">brier_top1()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/metrics/pyhealth.metrics.prediction_set">[core] prediction_set</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.metrics.prediction_set.size"><code class="docutils literal notranslate"><span class="pre">size()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.metrics.prediction_set.rejection_rate"><code class="docutils literal notranslate"><span class="pre">rejection_rate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.metrics.prediction_set.miscoverage_ps"><code class="docutils literal notranslate"><span class="pre">miscoverage_ps()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.metrics.prediction_set.error_ps"><code class="docutils literal notranslate"><span class="pre">error_ps()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.metrics.prediction_set.miscoverage_overall_ps"><code class="docutils literal notranslate"><span class="pre">miscoverage_overall_ps()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.metrics.prediction_set.error_overall_ps"><code class="docutils literal notranslate"><span class="pre">error_overall_ps()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/metrics/pyhealth.metrics.fairness">pyhealth.metrics.fairness</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-api/medcode">MedCode</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#pyhealth.medcode.InnerMap"><code class="docutils literal notranslate"><span class="pre">InnerMap</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.medcode.InnerMap.load"><code class="docutils literal notranslate"><span class="pre">InnerMap.load()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.medcode.InnerMap.available_attributes"><code class="docutils literal notranslate"><span class="pre">InnerMap.available_attributes</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.medcode.InnerMap.stat"><code class="docutils literal notranslate"><span class="pre">InnerMap.stat()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.medcode.InnerMap.standardize"><code class="docutils literal notranslate"><span class="pre">InnerMap.standardize()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.medcode.InnerMap.convert"><code class="docutils literal notranslate"><span class="pre">InnerMap.convert()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.medcode.InnerMap.lookup"><code class="docutils literal notranslate"><span class="pre">InnerMap.lookup()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.medcode.InnerMap.get_ancestors"><code class="docutils literal notranslate"><span class="pre">InnerMap.get_ancestors()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.medcode.InnerMap.get_descendants"><code class="docutils literal notranslate"><span class="pre">InnerMap.get_descendants()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#pyhealth.medcode.CrossMap"><code class="docutils literal notranslate"><span class="pre">CrossMap</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.medcode.CrossMap.load"><code class="docutils literal notranslate"><span class="pre">CrossMap.load()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.medcode.CrossMap.map"><code class="docutils literal notranslate"><span class="pre">CrossMap.map()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#diagnosis-codes">Diagnosis codes:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.medcode.ICD9CM"><code class="docutils literal notranslate"><span class="pre">ICD9CM</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="index.html#pyhealth.medcode.ICD9CM.standardize"><code class="docutils literal notranslate"><span class="pre">ICD9CM.standardize()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.medcode.ICD10CM"><code class="docutils literal notranslate"><span class="pre">ICD10CM</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="index.html#pyhealth.medcode.ICD10CM.standardize"><code class="docutils literal notranslate"><span class="pre">ICD10CM.standardize()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.medcode.CCSCM"><code class="docutils literal notranslate"><span class="pre">CCSCM</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#procedure-codes">Procedure codes:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.medcode.ICD9PROC"><code class="docutils literal notranslate"><span class="pre">ICD9PROC</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="index.html#pyhealth.medcode.ICD9PROC.standardize"><code class="docutils literal notranslate"><span class="pre">ICD9PROC.standardize()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.medcode.ICD10PROC"><code class="docutils literal notranslate"><span class="pre">ICD10PROC</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.medcode.CCSPROC"><code class="docutils literal notranslate"><span class="pre">CCSPROC</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#medication-codes">Medication codes:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.medcode.NDC"><code class="docutils literal notranslate"><span class="pre">NDC</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.medcode.RxNorm"><code class="docutils literal notranslate"><span class="pre">RxNorm</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pyhealth.medcode.ATC"><code class="docutils literal notranslate"><span class="pre">ATC</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="index.html#pyhealth.medcode.ATC.convert"><code class="docutils literal notranslate"><span class="pre">ATC.convert()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#pyhealth.medcode.ATC.get_ddi"><code class="docutils literal notranslate"><span class="pre">ATC.get_ddi()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-api/calib">Calibration and Uncertainty Quantification</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/calib/pyhealth.calib.calibration">pyhealth.calib.calibration</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-api/calib/pyhealth.calib.predictionset">pyhealth.calib.predictionset</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Additional Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-live">PyHealth Webinar 4/9/25</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#past-scheduled-videos">Past Scheduled Videos</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-log">Development logs</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-about">About us</a></li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/toggleprompt.js"></script>
    <script src="_static/design-tabs.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    </body>
</html>